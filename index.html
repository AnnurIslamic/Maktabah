<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Annur Islamic</title>
  <link rel="icon" href="logo-annur.jpg" type="image/jpg">
  <link rel="manifest" href="manifest.json">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    /* [TAMBAHKAN KODE INI] Aturan Global untuk Mencegah Scroll Horizontal */
    html, body {
        width: 100%;
        overflow-x: hidden;
    }
    
    /* [BARU] CSS Tambahan untuk Score Board Duet */
    #duet-score-board h4 {
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
    }
    body.dark-mode #duet-score-board h4 {
        color: var(--accent-color);
    }
    #duet-turn-indicator {
        font-weight: 600;
        color: var(--header-bg);
    }
    body.dark-mode #duet-turn-indicator {
        color: var(--accent-color);
    }
      
        :root {
          --primary-bg: #f0f4f8;
          --header-bg: #0d264a;
          --header-text: #ffffff;
          --accent-color: #f9d788;
          --text-color: #333333;
          --text-light: #888;
          --card-bg: #ffffff;
          --card-shadow: rgba(0, 0, 0, 0.08);
          --radius: 12px;
          --transition: 0.3s ease;
          --active-tab: #0d264a;
          --bookmark-active: #ffc107;
          --tap-area-bg: #e9eef2;
          --button-bg: #0d264a;
          --button-text: #ffffff;
        }
    
        .ayah-item.ayah-playing {
            background-color: var(--tap-area-bg);
            border-radius: var(--radius);
        }
        body.dark-mode .ayah-item.ayah-playing {
            background-color: #2c2c3a;
        }
    
        .app-footer {
          text-align: center;
          margin-top: 2rem;
          font-size: 0.9rem;
          color: var(--text-light);
          font-weight: 500;
        }
    
        body.dark-mode {
          --primary-bg: #121212;
          --header-bg: #1a1a2e;
          --header-text: #e0e0e0;
          --text-color: #e0e0e0;
          --text-light: #aaa;
          --card-bg: #1e1e1e;
          --card-shadow: rgba(255, 255, 255, 0.05);
          --active-tab: #f9d788;
          --tap-area-bg: #2c2c3a;
          --button-bg: #f9d788;
          --button-text: #1a1a2e;
        }
    
        * { margin: 0; padding: 0; box-sizing: border-box; }
    
        body {
          font-family: 'Poppins', sans-serif;
          color: var(--text-color);
          background-color: var(--primary-bg);
          -webkit-user-select: none; user-select: none;
          transition: background-color var(--transition), color var(--transition);
        }
        .app-container { width: 100%; max-width: 420px; margin: 0 auto; overflow-x: hidden; }
        .loading-indicator { text-align: center; padding: 2rem; color: var(--text-light); }
    
        /* --- COMMON VIEW STYLES --- */
        .view-header { display: flex; align-items: center; margin-bottom: 1.5rem; position: relative; justify-content: space-between; padding: 0 1rem; }
        .back-button { position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); font-size: 1.5rem; cursor: pointer; color: var(--text-color); padding: 0.5rem; z-index: 5; }
        .view-header h2 { font-size: 1.2rem; font-weight: 600; text-align: center; flex-grow: 1; }
        .view-header .action-icon { font-size: 1.5rem; cursor: pointer; color: var(--text-light); padding: 0.5rem; }
        .view-header .action-icon.bookmarked { color: var(--bookmark-active); }
        
    
        /* --- LAYAR UTAMA (JADWAL SHOLAT) --- */
        #prayer-times-view { padding-bottom: 2rem; }
        #prayer-times-view .main-header {
          background: var(--header-bg); color: var(--header-text); padding: 1.5rem 1.5rem 2.5rem 1.5rem;
          border-bottom-left-radius: 40px; border-bottom-right-radius: 40px; text-align: center;
          box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); position: relative; transition: background-color var(--transition);
        }
        #prayer-times-view .main-header h1 { font-size: 1.5rem; font-weight: 700; color: var(--accent-color); margin-bottom: 0.25rem; }
        #prayer-times-view .main-header p { font-size: 0.9rem; color: var(--header-text); opacity: 0.9; margin-bottom: 0.5rem; }
        #prayer-times-view #countdown-timer { font-size: 2.25rem; font-weight: 700; color: var(--header-text); letter-spacing: 2px; }
        
        #prayer-times-view .main-header #location-display {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            padding-top: 1.5rem;
            text-align: left;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--header-text);
            opacity: 0.9;
        }
        
        #prayer-times-view .calendar-section {
            background-color: var(--card-bg);
            border-radius: var(--radius);
            margin: -2.5rem 1rem 1.5rem 1rem;
            padding: 1rem;
            box-shadow: 0 4px 10px var(--card-shadow);
            position: relative;
            z-index: 10;
            transition: background-color var(--transition);
        }
    
        #prayer-times-view #location-display .icon { margin-right: 0.4rem; }
        #prayer-times-view .date-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; font-size: 0.9rem; font-weight: 600; }
        #prayer-times-view .date-header .hijri-date { color: var(--header-bg); }
        #prayer-times-view .date-header .gregorian-date { color: var(--text-light); font-weight: 400; }
        #prayer-times-view .calendar-view { display: flex; justify-content: space-around; text-align: center; }
        #prayer-times-view .day { display: flex; flex-direction: column; align-items: center; }
        #prayer-times-view .day .day-name { font-size: 0.75rem; color: #999; margin-bottom: 0.5rem; }
        #prayer-times-view .day .day-number { font-size: 1rem; font-weight: 600; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 50%; }
        #prayer-times-view .day.today .day-number { background-color: var(--header-bg); color: var(--header-text); }
        #prayer-times-view .prayer-list-section { padding: 0 1rem; }
        #prayer-times-view .prayer-item { display: flex; align-items: center; justify-content: space-between; background-color: var(--card-bg); padding: 1rem; border-radius: var(--radius); margin-bottom: 0.75rem; box-shadow: 0 2px 5px var(--card-shadow); transition: transform var(--transition), background-color var(--transition); }
        #prayer-times-view .prayer-details { flex-grow: 1; min-width: 0; }
        #prayer-times-view .prayer-details .prayer-name { font-weight: 600; font-size: 1rem; }
        #prayer-times-view .prayer-time-value { font-size: 1.1rem; font-weight: 600; }
        
    
    
        /* --- GENERIC LIST VIEW STYLES (DOA, QURAN, DZIKIR) --- */
        .generic-list-view { padding-top: 1.5rem; padding-bottom: 2rem; }
        .last-read-card { background-color: var(--card-bg); border-radius: var(--radius); padding: 1rem; margin: 0 1rem 1.5rem 1rem; box-shadow: 0 2px 5px var(--card-shadow); cursor: pointer;}
        .last-read-card h3 { font-size: 0.8rem; text-transform: uppercase; color: var(--text-light); margin-bottom: 0.5rem; font-weight: 500; }
        .last-read-card p { font-weight: 600; font-size: 1rem; }
        .tabs-container { display: flex; border-bottom: 2px solid #e0e0e0; margin: 0 1rem 1rem 1rem; }
        body.dark-mode .tabs-container { border-bottom-color: #333; }
        .tab-item { flex: 1; text-align: center; padding: 0.8rem 0; font-weight: 600; font-size: 0.9rem; color: var(--text-light); cursor: pointer; position: relative; }
        .tab-item.active { color: var(--active-tab); }
        .tab-item.active::after { content: ''; position: absolute; bottom: -2px; left: 0; width: 100%; height: 2px; background-color: var(--active-tab); }
        .list-container { padding: 0 0.5rem; }
        .list-item { display: flex; align-items: center; padding: 0.8rem 0.5rem; border-bottom: 1px solid #eee; cursor: pointer; }
        body.dark-mode .list-item { border-bottom-color: #333; }
        .list-item .num { font-weight: 500; color: var(--text-light); width: 2.5rem; flex-shrink: 0; text-align: center; }
        .list-item .details { flex-grow: 1; min-width: 0; margin-right: 0.5rem; }
        .list-item .details .title { font-weight: 600; }
        .list-item .details .subtitle { font-size: 0.8rem; color: var(--text-light); }
        .list-item .arabic { font-size: 1.2rem; font-weight: 500; color: var(--text-color); white-space: nowrap; }
        
        /* --- TAMPILAN DZIKIR (List view is now generic) --- */
        #dzikir-view { padding-top: 1.5rem; padding-bottom: 2rem; }
    
        /* --- TAMPILAN TASBIH --- */
        #tasbih-view { display: none; flex-direction: column; height: 100vh; padding-top: 1.5rem; }
        #tasbih-view .view-header { flex-shrink: 0; margin-bottom: 0; }
        #tasbih-view .tasbih-main { flex-grow: 1; display: flex; flex-direction: column; justify-content: space-evenly; align-items: center; padding: 1rem; }
        #tasbih-counter-display { text-align: center; }
        #tasbih-counter-display .count { font-size: 4rem; font-weight: 700; line-height: 1; }
        #tasbih-counter-display .target { font-size: 1.2rem; color: var(--text-light); }
        #tasbih-text-display { text-align: center; padding: 0 1rem; }
        #tasbih-text-display .tasbih-arabic { font-size: 1.8rem; font-weight: 500; margin-bottom: 0.5rem; }
        #tasbih-text-display .tasbih-latin { font-size: 1rem; font-style: italic; color: var(--text-light); margin-bottom: 0.25rem; }
        #tasbih-text-display .tasbih-arti { font-size: 0.9rem; color: var(--text-light); }
        #tasbih-tap-area { width: 180px; height: 180px; background-color: var(--tap-area-bg); border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; box-shadow: 0 5px 15px var(--card-shadow); transition: transform 0.1s ease; }
        #tasbih-tap-area:active { transform: scale(0.95); }
        #tasbih-tap-area .tap-icon { font-size: 4rem; color: var(--text-light); }
        #tasbih-reset-btn { background: none; border: 2px solid var(--text-light); color: var(--text-light); font-size: 1rem; padding: 0.6rem 1.5rem; border-radius: 2rem; cursor: pointer; transition: background-color var(--transition); }
        #tasbih-reset-btn:active { background-color: rgba(136, 136, 136, 0.2); }
    
        /* --- SIDEBAR & MODAL (CSS UMUM) --- */
        #menu-toggle { position: absolute; top: 1.2rem; left: 1.2rem; width: 40px; height: 40px; background: rgba(255, 255, 255, 0.15); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: var(--radius); cursor: pointer; z-index: 2000; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 8px; transition: all var(--transition); }
        #menu-toggle .bar { display: block; width: 100%; height: 2px; background: var(--header-text); margin: 3px 0; transition: all var(--transition); border-radius: 2px; }
        #sidebar { position: fixed; top: 0; left: -300px; width: 280px; height: 100%; background: var(--card-bg); box-shadow: 4px 0 15px rgba(0, 0, 0, 0.1); padding: 1.5rem; transition: left var(--transition), background-color var(--transition); z-index: 1500; overflow-y: auto; }
        #sidebar.open { left: 0; }
        #sidebar h3 { font-size: 1.2rem; font-weight: 600; color: var(--header-bg); margin-top: 3rem; margin-bottom: 1.5rem; }
        #sidebar ul { list-style: none; padding: 0; }
        #sidebar ul li a { display: block; padding: 0.8rem 1rem; text-decoration: none; color: var(--text-color); font-weight: 500; border-radius: var(--radius); transition: background-color var(--transition), color var(--transition); }
        #sidebar ul li a:hover, #sidebar ul li a.active { background-color: var(--header-bg); color: var(--header-text); }
        
        .full-modal { position: fixed; z-index: 3000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; }
        .full-modal .modal-content { background-color: var(--primary-bg); color: var(--text-color); padding: 0; border-radius: var(--radius); width: 90%; max-width: 400px; max-height: 85%; box-shadow: 0 5px 20px rgba(0,0,0,0.2); animation: modal-appear 0.4s ease; display: flex; flex-direction: column; }
        @keyframes modal-appear { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .full-modal .modal-header { display: flex; justify-content: space-between; align-items: center; padding: 1rem 1.5rem; border-bottom: 1px solid #ddd; }
        body.dark-mode .full-modal .modal-header { border-bottom-color: #444; }
        .full-modal .modal-header h3 { color: var(--header-bg); font-size: 1.1rem; flex-grow: 1; text-align: center; margin: 0 1rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .full-modal .close-button { font-size: 2rem; color: #aaa; cursor: pointer; font-weight: 300; }
        .full-modal .modal-header .action-icon { font-size: 1.5rem; cursor: pointer; color: var(--text-light); }
        .full-modal .modal-header .action-icon.bookmarked { color: var(--bookmark-active); }
        .full-modal .modal-body { padding: 1.5rem; overflow-y: auto; flex-grow: 1; }
    
        /* --- CSS untuk Modal Izin Kustom --- */
        .permission-modal-content {
            padding: 1.5rem;
            text-align: center;
        }
        .permission-modal-content h3 {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            color: var(--header-bg);
        }
        body.dark-mode .permission-modal-content h3 {
            color: var(--accent-color);
        }
        .permission-modal-content p {
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
            color: var(--text-color);
            opacity: 0.9;
        }
        .permission-modal-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }
        .permission-modal-actions .modal-action-btn {
            flex-grow: 1;
        }
        .permission-modal-actions .deny-btn {
            background-color: var(--tap-area-bg);
            color: var(--text-color);
        }
    
        /* STYLE KONTEN MODAL & SURAH VIEW */
        .settings-item { display: flex; justify-content: space-between; align-items: center; padding: 1rem 0; border-bottom: 1px solid #eee; }
        body.dark-mode .settings-item { border-bottom-color: #333; }
        .settings-item:last-child { border-bottom: none; }
        .settings-item label { font-weight: 500; flex-shrink: 0; margin-right: 1rem; }
        .switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; border-radius: 28px; transition: var(--transition); }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; border-radius: 50%; transition: var(--transition); }
        input:checked + .slider { background-color: var(--header-bg); }
        input:checked + .slider:before { transform: translateX(22px); }
        .custom-select, #enable-notifications-btn {
            padding: 0.5rem; border-radius: 8px; border: 1px solid #ccc; background-color: var(--card-bg); color: var(--text-color);
            font-family: 'Poppins', sans-serif;
        }
        
        #enable-notifications-btn { cursor: pointer; }
        #enable-notifications-btn:disabled { cursor: not-allowed; opacity: 0.6; }
        body.dark-mode .custom-select, body.dark-mode #enable-notifications-btn { border-color: #555; }
        .single-item-arabic { font-size: 2rem; line-height: 3rem; text-align: right; direction: rtl; margin-bottom: 1.5rem; }
        .single-item-latin { font-size: 1rem; font-style: italic; color: #666; line-height: 1.6rem; margin-bottom: 1rem; }
        .single-item-arti { font-size: 0.9rem; color: #666; line-height: 1.5rem; }
        body.dark-mode .single-item-latin { color: #ccc; }
        body.dark-mode .single-item-arti { color: #ccc; }
        .modal-action-btn {
            display: block; width: 100%; padding: 0.8rem; margin-top: 1.5rem;
            background-color: var(--button-bg); color: var(--button-text);
            border: none; border-radius: var(--radius); font-size: 1rem; font-weight: 600;
            cursor: pointer; text-align: center; transition: transform 0.2s ease;
        }
        .modal-action-btn:active { transform: scale(0.98); }
    
        /* STYLE UNTUK GRUP PENGATURAN */
        .settings-group {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background-color: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: 0 2px 5px var(--card-shadow);
        }
        .settings-group:last-child {
            margin-bottom: 0;
        }
        body.dark-mode .settings-group { border-top-color: #444; }
        .settings-group h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--header-bg);
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid #eee;
        }
        body.dark-mode .settings-group h4 { color: var(--accent-color); border-bottom-color: #444;}
    
    
        /* STYLE UNTUK MENU DETAIL APLIKASI & PENGATURAN ADZAN BARU */
        .settings-menu-item {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 0.9rem 0;
          border-bottom: 1px solid #eee;
          cursor: pointer;
          transition: background-color 0.2s ease;
        }
        .settings-menu-item:last-child {
          border-bottom: none;
        }
        body.dark-mode .settings-menu-item { border-bottom-color: #333; }
        .settings-menu-item:hover { background-color: rgba(0, 0, 0, 0.03); }
        body.dark-mode .settings-menu-item:hover { background-color: rgba(255, 255, 255, 0.05); }
        .settings-menu-item span:first-child { font-weight: 500; }
        .settings-menu-item .arrow { font-size: 1.5rem; font-weight: 400; color: var(--text-light); }
        
        /* --- Style Pengaturan Suara Adzan --- */
        .selection-item-wrapper {
            padding: 0.2rem 0.5rem;
            border-bottom: 1px solid #eee;
            transition: background-color 0.2s ease;
        }
        .selection-item-wrapper:last-child {
            border-bottom: none;
        }
        body.dark-mode .selection-item-wrapper {
            border-bottom-color: #333;
        }
        .selection-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.7rem 0;
            cursor: pointer;
        }
        .selection-item:hover {
            background-color: rgba(0, 0, 0, 0.03);
        }
        body.dark-mode .selection-item:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        .selection-item span:first-child { font-weight: 500; }
        .selection-item .checkmark {
            font-size: 1.2rem;
            color: var(--header-bg);
            font-weight: bold;
            visibility: hidden;
        }
        body.dark-mode .selection-item .checkmark { color: var(--accent-color); }
        .selection-item.selected .checkmark { visibility: visible; }
    
        /* --- Style untuk Volume Control & Tombol Test --- */
        .volume-control-container {
            display: none;
            align-items: center;
            gap: 0.8rem;
            padding: 0.5rem 0 0.8rem 0;
            animation: fadeIn 0.3s ease;
        }
        .volume-control-container.active {
            display: flex;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .volume-control-container .volume-icon {
            font-size: 1.2rem;
            color: var(--text-light);
        }
        .volume-slider {
            -webkit-appearance: none; appearance: none;
            flex-grow: 1; height: 6px;
            background: #ddd; outline: none;
            border-radius: 3px; opacity: 0.9;
            transition: opacity .2s;
        }
        .volume-slider:hover { opacity: 1; }
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none;
            width: 18px; height: 18px;
            background: var(--header-bg); cursor: pointer;
            border-radius: 50%;
        }
        .volume-slider::-moz-range-thumb {
            width: 18px; height: 18px;
            background: var(--header-bg); cursor: pointer;
            border-radius: 50%; border: none;
        }
        .test-sound-btn {
            background: none; border: none;
            font-size: 1.5rem; color: var(--header-bg);
            cursor: pointer; padding: 0.2rem;
            line-height: 1;
        }
        body.dark-mode .volume-slider { background: #444; }
        body.dark-mode .volume-slider::-webkit-slider-thumb { background: var(--accent-color); }
        body.dark-mode .volume-slider::-moz-range-thumb { background: var(--accent-color); }
        body.dark-mode .test-sound-btn { color: var(--accent-color); }
        
        /* CSS UNTUK TOMBOL PLAY STORE */
        .playstore-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 0.8rem 1rem;
            margin-top: 1.5rem;
            background-color: #000000;
            color: #ffffff;
            border-radius: var(--radius);
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            transition: transform 0.2s ease, background-color 0.2s ease;
        }
        .playstore-btn:active {
            transform: scale(0.97);
        }
        .playstore-btn .playstore-icon {
            width: 24px;
            height: 24px;
        }
        body.dark-mode .playstore-btn {
            background-color: #ffffff;
            color: #000000;
        }
    
    
        /* STYLE UNTUK TOMBOL DETAIL APLIKASI */
        .detail-app-container {
          text-align: center;
          padding: 1.5rem 0 0.5rem 0;
        }
    
        #detail-app-btn {
          background-color: var(--header-bg);
          color: var(--header-text);
          border: none;
          border-radius: var(--radius);
          padding: 0.7rem 1.5rem;
          font-size: 0.9rem;
          font-weight: 600;
          cursor: pointer;
          transition: transform 0.2s ease, background-color var(--transition);
          box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
    
        #detail-app-btn:active {
          transform: scale(0.96);
        }
        
        body.dark-mode #detail-app-btn {
            background-color: var(--tap-area-bg);
            color: var(--text-color);
        }
    
        /* STYLE UNTUK KONTEN HALAMAN DETAIL */
        .content-body {
            padding: 0 1rem 1.5rem 1rem; 
        }
    
        .content-card {
            background-color: var(--card-bg);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px var(--card-shadow);
            transition: background-color var(--transition);
        }
    
        .content-card p, .content-card li {
            line-height: 1.7; 
            color: var(--text-color);
            opacity: 0.9;
            margin-bottom: 1rem;
        }
    
        .content-card p:last-child, .content-card li:last-child {
            margin-bottom: 0;
        }
    
        .content-card strong {
            color: var(--header-bg);
            font-weight: 600;
        }
    
        body.dark-mode .content-card strong {
            color: var(--accent-color);
        }
    
        .content-title-icon {
            font-size: 1.5rem;
            margin-right: 0.75rem;
            color: var(--header-bg);
            vertical-align: middle;
        }
    
        body.dark-mode .content-title-icon {
            color: var(--accent-color);
        }
    
        h3.content-title {
            display: flex;
            align-items: center;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-color);
        }
        
    .surah-audio-player {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1rem;
        padding: 1rem 0.5rem;
        margin-bottom: 1rem;
        background-color: var(--tap-area-bg);
        border-radius: var(--radius);
    }
    #surah-play-btn {
        background-color: var(--card-bg);
        border: 1px solid #ddd;
        width: 44px;
        height: 44px;
        border-radius: 50%;
        font-size: 1.5rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--text-color);
        box-shadow: 0 2px 4px var(--card-shadow);
    }
    body.dark-mode #surah-play-btn {
        border-color: #444;
    }
    
        ul.styled-list {
            list-style: none;
            padding-left: 0;
        }
    
        ul.styled-list li {
            position: relative;
            padding-left: 1.8rem;
            margin-bottom: 1rem;
        }
    
        ul.styled-list li::before {
            content: '✓'; 
            position: absolute;
            left: 0;
            top: 2px;
            color: var(--header-bg);
            font-weight: 700;
            font-size: 1.1rem;
        }
    
        body.dark-mode ul.styled-list li::before {
            color: var(--accent-color);
        }
    
        .email-link-wrapper {
            text-align: center;
            margin-top: 1.5rem;
        }
    
        /* --- SURAH VIEW STYLES --- */
        #surah-view, #juz-detail-view { padding-top: 1.5rem; padding-bottom: 2rem; }
        #surah-view .view-header { position: sticky; top: 0; background-color: var(--primary-bg); padding-top: 1.5rem; padding-bottom: 1rem; z-index: 100; transition: background-color var(--transition); }
        #surah-view-body { padding: 0 1rem; }
        .surah-detail-header { text-align: center; margin-bottom: 1.5rem; padding: 1.5rem; background-color: var(--card-bg); border-radius: var(--radius); box-shadow: 0 2px 5px var(--card-shadow); }
        .surah-detail-header h2 { font-size: 1.8rem; font-weight: 600; color: var(--header-bg); margin-bottom: 0.25rem; }
        .surah-detail-header p { font-size: 1rem; color: var(--text-color); margin-bottom: 0.5rem; }
        .surah-detail-header .meta { font-size: 0.8rem; color: var(--text-light); text-transform: uppercase; }
        
        .basmala { text-align: center; padding-bottom: 1.5rem; margin-bottom: 1rem; border-bottom: 1px solid #eee; }
        body.dark-mode .basmala { border-bottom-color: #444; }
        .basmala .basmala-arabic { font-size: 1.8rem; direction: rtl; margin: 0; padding: 0; }
        .basmala .basmala-translation { font-size: 0.9rem; font-style: italic; color: var(--text-light); margin-top: 0.5rem; }
        
        .ayah-item { padding: 1.2rem 0; border-bottom: 1px solid #eee; }
        body.dark-mode .ayah-item { border-bottom-color: #333; }
        .ayah-item:last-child { border-bottom: none; }
        .ayah-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .ayah-number { font-weight: 600; background: var(--tap-area-bg); color: var(--text-light); padding: 0.2rem 0.6rem; border-radius: 8px; font-size: 0.9rem; }
        .ayah-arabic { font-size: 1.8rem; text-align: right; direction: rtl; line-height: 2.8rem; margin-bottom: 1rem; }
        .ayah-latin { font-size: 0.95rem; font-style: italic; color: #555; line-height: 1.6rem; margin-bottom: 1rem; }
        .ayah-translation { font-size: 0.9rem; line-height: 1.5rem; }
        body.dark-mode .ayah-latin { color: #ddd; }
        body.dark-mode .ayah-translation { color: #ccc; }
        
        /* --- TAMPILAN KIBLAT --- */
        #qibla-view {
          display: none;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          height: 100vh;
          box-sizing: border-box;
          background-color: #000000;
          color: #ffffff;
          padding: 1rem;
        }
        #qibla-view .view-header {
          position: absolute;
          top: 0;
          width: 100%;
          color: white;
        }
         #qibla-view .view-header h2, #qibla-view .back-button {
            color: #ffffff;
           }
    
        #qibla-compass-container {
            position: relative;
            width: 300px;
            height: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #qibla-compass-circle {
            width: 100%;
            height: 100%;
            background-color: #F0E68C; /* Khaki - pale yellow */
            border: 5px solid #5C4033; /* Dark brown border */
            border-radius: 50%;
            transition: background-color 0.4s ease;
            position: relative;
        }
        #qibla-compass-circle.aligned {
            background-color: #FFD700; /* Gold */
        }
        
        #qibla-lubber-line {
          position: absolute;
          top: 10px;
          left: 50%;
          transform: translateX(-50%);
          width: 4px;
          height: 30px;
          background-color: #FF4500; /* OrangeRed */
          border-radius: 2px;
          z-index: 3;
        }
    
        #qibla-needle {
            position: absolute;
            width: 4px;
            height: 120px;
            background-color: #333333;
            top: 30px;
            left: 50%;
            transform-origin: bottom center;
            transform: translateX(-50%) rotate(0deg);
            transition: transform 0.2s linear;
            border-radius: 2px;
            z-index: 2;
        }
        
        #qibla-info-box {
          margin-top: 2rem;
          text-align: center;
          max-width: 320px;
        }
        #qibla-info-box .direction-degree {
          font-size: 1.2rem;
          font-weight: 500;
          margin-bottom: 1rem;
        }
        #qibla-info-box .calibration-info {
          font-size: 0.8rem;
          color: #ccc;
          line-height: 1.4;
          margin-bottom: 1rem;
        }
        #qibla-recalibrate-btn {
          background: none;
          border: 1px solid #f9d788;
          color: #f9d788;
          padding: 0.5rem 1rem;
          border-radius: 20px;
          cursor: pointer;
        }
        
        /* --- CSS untuk Fitur Kuis Sambung Ayat --- */
        .quiz-points-display {
            font-size: 1rem;
            font-weight: 600;
            background-color: var(--tap-area-bg);
            padding: 0.4rem 0.8rem;
            border-radius: var(--radius);
            color: var(--header-bg);
        }
        body.dark-mode .quiz-points-display {
            color: var(--accent-color);
        }
    
        .quiz-intro {
            text-align: center;
            margin: 1.5rem 0;
            padding: 1rem;
            background-color: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: 0 2px 5px var(--card-shadow);
        }
        .quiz-intro h3 {
            font-size: 1.2rem;
            color: var(--header-bg);
            margin-bottom: 0.5rem;
        }
        body.dark-mode .quiz-intro h3 {
            color: var(--accent-color);
        }
        .quiz-intro p {
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--text-light);
        }
    
        .quiz-mode-selection {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
    
        .quiz-mode-card {
            background-color: var(--card-bg);
            padding: 1.2rem;
            border-radius: var(--radius);
            box-shadow: 0 4px 10px var(--card-shadow);
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            border-left: 5px solid var(--header-bg);
        }
        body.dark-mode .quiz-mode-card {
            border-left-color: var(--accent-color);
        }
        .quiz-mode-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px var(--card-shadow);
        }
        .quiz-mode-card h4 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.4rem;
        }
        .quiz-mode-card p {
            font-size: 0.85rem;
            color: var(--text-light);
        }
        .quiz-mode-card[data-disabled="true"], #theme-store-btn[data-disabled="true"] {
            opacity: 0.6;
            cursor: not-allowed;
            border-left-color: #ccc;
        }
        .quiz-mode-card[data-disabled="true"]:hover, #theme-store-btn[data-disabled="true"]:hover {
            transform: none;
            box-shadow: 0 4px 10px var(--card-shadow);
        }
    
        /* Tampilan Permainan Kuis */
        .quiz-game-area {
            margin-top: 1.5rem;
        }
        .quiz-question-card {
            background-color: var(--card-bg);
            border-radius: var(--radius);
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 5px var(--card-shadow);
        }
        .quiz-question-card p {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 0.75rem;
        }
        .quiz-question-card h3 {
            font-size: 1.5rem;
            direction: rtl; /* Teks Arab dari kanan ke kiri */
            font-weight: 500;
        }
        .quiz-options-container {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .quiz-option {
            background-color: var(--card-bg);
            border: 2px solid var(--tap-area-bg);
            padding: 1rem;
            border-radius: var(--radius);
            cursor: pointer;
            text-align: right;
            direction: rtl;
            font-size: 1.2rem;
            transition: all 0.2s ease;
        }
        .quiz-option:hover {
            background-color: var(--tap-area-bg);
        }
        .quiz-option.correct {
            background-color: #d4edda; /* Hijau */
            border-color: #28a745;
            color: #155724;
        }
        .quiz-option.incorrect {
            background-color: #f8d7da; /* Merah */
            border-color: #dc3545;
            color: #721c24;
        }
        .quiz-option.disabled {
            pointer-events: none;
            opacity: 0.7;
        }
    
        .quiz-feedback {
            text-align: center;
            margin-top: 1.5rem;
            font-size: 1.2rem;
            font-weight: 600;
            height: 30px;
        }
        .quiz-feedback.correct {
            color: #28a745;
        }
        .quiz-feedback.incorrect {
            color: #dc3545;
        }
        
    /* --- [FUNGSI DUET] Styling Tambahan untuk Mode Duet --- */
    #duet-score-board .player-container {
        padding: 0.5rem;
        border-radius: var(--radius);
        transition: all 0.4s ease;
        border-bottom: 4px solid transparent;
    }
    #duet-score-board .player-container.active {
        transform: scale(1.05);
        background-color: var(--tap-area-bg);
        border-bottom-color: var(--header-bg);
    }
    body.dark-mode #duet-score-board .player-container.active {
        border-bottom-color: var(--accent-color);
    }
    #duet-score-board .player-container.active h4 {
        color: var(--header-bg);
    }
    body.dark-mode #duet-score-board .player-container.active h4 {
        color: var(--accent-color);
    }

/* --- [MODIFIKASI] CSS UNTUK FITUR SAHABAT ANNUR ALA AI --- */
#sahabat-annur-view {
    display: flex;
    flex-direction: column;
    /* [DIUBAH] Gunakan 100vh agar mengisi seluruh tinggi layar perangkat */
    height: 100vh; 
    /* [DIHAPUS] Padding dipindahkan ke elemen anak agar lebih konsisten */
    width: 100%; /* [DITAMBAHKAN] Memastikan view menggunakan lebar penuh */
}

/* [DITAMBAHKAN] Atur header agar ukurannya tetap dan tidak terpengaruh oleh chat */
#sahabat-annur-view .view-header {
    flex-shrink: 0;
    padding: 0 1rem;
    margin-bottom: 1rem;
    box-sizing: border-box; /* Pastikan padding tidak menambah lebar */
}

#chat-window {
    flex-grow: 1; /* Biarkan area chat mengisi semua sisa ruang vertikal */
    overflow-y: auto;
    padding: 0 1rem 1rem 1rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.chat-message {
    display: flex;
    align-items: flex-end;
    gap: 0.75rem;
    max-width: 85%;
    /* [DITAMBAHKAN] Mencegah flex item menyebabkan overflow */
    min-width: 0; 
}

.chat-bubble {
    padding: 0.8rem 1rem;
    border-radius: 18px;
    line-height: 1.6;
    font-size: 0.95rem;
    opacity: 0;
    transform: translateY(15px);
    animation: fadeInBubble 0.4s forwards;
    /* [SANGAT PENTING] Mencegah teks panjang (misal: link) merusak layout */
    word-break: break-word;
    overflow-wrap: break-word;
}

@keyframes fadeInBubble { to { opacity: 1; transform: translateY(0); } }

.ai-message { align-self: flex-start; }
.ai-message .chat-bubble {
    background-color: var(--card-bg);
    border-top-left-radius: 4px;
    color: var(--text-color);
}

.ai-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background-color: var(--header-bg);
    color: var(--accent-color);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 0.9rem;
    flex-shrink: 0;
}

.user-message { align-self: flex-end; }
.user-message .chat-bubble {
    background-color: var(--header-bg);
    color: var(--header-text);
    border-top-right-radius: 4px;
}

.typing-indicator { display: flex; align-items: center; gap: 5px; }
.typing-indicator .dot {
    width: 8px; height: 8px; background-color: #ccc; border-radius: 50%;
    animation: typing-blink 1.4s infinite both;
}
.typing-indicator .dot:nth-child(2) { animation-delay: 0.2s; }
.typing-indicator .dot:nth-child(3) { animation-delay: 0.4s; }

@keyframes typing-blink { 0% { opacity: 0.2; } 20% { opacity: 1; } 100% { opacity: 0.2; } }

.sahabat-annur-input-area {
    /* [DITAMBAHKAN] Pastikan area input tidak mengecil */
    flex-shrink: 0; 
    padding: 1rem;
    background-color: var(--primary-bg);
    border-top: 1px solid var(--tap-area-bg);
    display: flex;
    gap: 0.75rem;
    align-items: center;
    box-sizing: border-box; /* Pastikan padding tidak menambah lebar */
}

#sahabat-annur-input {
    /* flex-grow: 1; <-- Dihapus atau diberi komentar */
    padding: 0.8rem 0.1rem; 
    border-radius: 1rem;
    border: 1px solid var(--tap-area-bg); 
    background-color: var(--card-bg);
    color: var(--text-color); 
    font-family: 'Poppins', sans-serif; 
    font-size: 0.9rem;
}
#sahabat-annur-input:focus { outline: none; border-color: var(--header-bg); }
body.dark-mode #sahabat-annur-input:focus { border-color: var(--accent-color); }

#sahabat-annur-send-btn {
    width: 48px; height: 48px; border: none;
    background-color: var(--button-bg); color: var(--button-text);
    border-radius: 50%; font-weight: 600; cursor: pointer;
    transition: transform 0.2s ease; font-size: 1.5rem;
    display: flex; align-items: center; justify-content: center; flex-shrink: 0;
}
#sahabat-annur-send-btn:active { transform: scale(0.9); }
    
    
    /* --- [FUNGSI TOKO] Styling untuk Halaman Toko Tema --- */
    #theme-store-btn:not([data-disabled="true"]) {
        background-color: var(--accent-color);
        color: var(--header-bg);
        font-weight: 700;
        box-shadow: 0 4px 10px rgba(249, 215, 136, 0.4);
    }
    body.dark-mode #theme-store-btn:not([data-disabled="true"]) {
        background-color: var(--button-bg);
        color: var(--button-text);
        box-shadow: 0 4px 10px rgba(249, 215, 136, 0.2);
    }
    #theme-store-modal .modal-header {
        flex-wrap: wrap; 
        padding-bottom: 0.5rem;
    }
    #store-user-points {
        width: 100%;
        text-align: center;
        font-size: 1rem;
        font-weight: 600;
        margin-top: 0.5rem;
        padding: 0.4rem;
        background-color: var(--tap-area-bg);
        border-radius: 8px;
        color: var(--header-bg);
    }
    body.dark-mode #store-user-points {
        color: var(--accent-color);
    }
    #theme-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 1rem;
        padding-top: 1rem;
    }
    .theme-card {
        background-color: var(--card-bg);
        border-radius: var(--radius);
        box-shadow: 0 2px 5px var(--card-shadow);
        padding: 1rem;
        text-align: center;
        border: 3px solid transparent;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    .theme-card.applied {
        border-color: var(--header-bg);
        transform: translateY(-5px);
    }
    body.dark-mode .theme-card.applied {
        border-color: var(--accent-color);
    }
    .theme-card.applied::before {
        content: '✓ Digunakan';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        background-color: var(--header-bg);
        color: var(--header-text);
        font-size: 0.7rem;
        font-weight: 600;
        padding: 0.2rem 0;
    }
    body.dark-mode .theme-card.applied::before {
        background-color: var(--accent-color);
        color: var(--header-bg);
    }
    .theme-preview {
        display: flex;
        justify-content: center;
        height: 60px;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 0.75rem;
        border: 1px solid var(--tap-area-bg);
    }
    .theme-preview .color-swatch {
        width: 25%;
        height: 100%;
    }
    .theme-name {
        font-weight: 600;
        font-size: 0.9rem;
        margin-bottom: 0.25rem;
    }
    .theme-price {
        font-size: 0.85rem;
        font-weight: 500;
        color: var(--text-light);
        margin-bottom: 0.75rem;
        height: 20px;
    }
    .theme-price .price-icon {
        color: #ffc107;
    }
    .theme-action-btn {
        width: 100%;
        padding: 0.6rem;
        border: none;
        border-radius: 8px;
        font-size: 0.8rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.2s ease;
        text-transform: uppercase;
    }
    .theme-action-btn.buy {
        background-color: var(--button-bg);
        color: var(--button-text);
    }
    .theme-action-btn.apply {
        background-color: var(--tap-area-bg);
        color: var(--text-color);
    }
    .theme-action-btn.insufficient {
        background-color: #aaa;
        color: #fff;
        cursor: not-allowed;
    }
    body.dark-mode .theme-action-btn.insufficient {
        background-color: #444;
        color: #888;
    }
    .theme-card.locked .theme-preview {
        filter: grayscale(80%);
    }
    .theme-card.locked::after {
        content: '🔒';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.4);
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 2.5rem;
        color: white;
        border-radius: var(--radius);
        backdrop-filter: blur(2px);
        -webkit-backdrop-filter: blur(2px);
    }
    
    /* --- CSS UNTUK FITUR MOTIVASI ISLAMI --- */
    .motivation-carousel-container {
        position: relative;
        overflow: hidden;
        padding: 0;
        margin-bottom: 1.5rem;
        height: 180px;
    }
    .motivation-carousel-track {
        display: flex;
        height: 100%;
        transition: transform 0.5s ease-in-out;
    }
    .motivation-slide {
        flex: 0 0 100%;
        width: 100%;
        padding: 1.5rem;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        background: linear-gradient(135deg, var(--header-bg), #1a3a5f);
        color: var(--header-text);
        box-sizing: border-box;
    }
    .motivation-slide p {
        font-size: 1.1rem;
        font-weight: 500;
        margin-bottom: 0.5rem;
    }
    .motivation-slide .quote-author {
        font-size: 0.9rem;
        font-style: italic;
        opacity: 0.8;
    }
    .carousel-control {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background-color: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        font-size: 1.8rem;
        font-weight: bold;
        cursor: pointer;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        z-index: 10;
        line-height: 40px;
        text-align: center;
    }
    .carousel-control.prev { left: 10px; }
    .carousel-control.next { right: 10px; }
    .carousel-indicators {
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 8px;
    }
    .indicator-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background-color: rgba(255, 255, 255, 0.5);
        cursor: pointer;
        transition: background-color 0.3s ease;
    }
    .indicator-dot.active {
        background-color: white;
    }
    .motivation-quote-card {
        background-color: var(--card-bg);
        border-radius: var(--radius);
        padding: 1.2rem;
        margin-bottom: 1rem;
        box-shadow: 0 2px 8px var(--card-shadow);
        border-left: 4px solid var(--header-bg);
        opacity: 0;
        transform: translateY(20px);
        animation: fadeInQuote 0.5s forwards;
    }
    @keyframes fadeInQuote {
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    body.dark-mode .motivation-quote-card {
        border-left-color: var(--accent-color);
    }
    .motivation-quote-card .quote-text {
        font-size: 1rem;
        line-height: 1.6;
        margin-bottom: 1rem;
        font-style: italic;
        color: var(--text-color);
    }
    .motivation-quote-card .quote-author {
        font-weight: 600;
        text-align: right;
        color: var(--header-bg);
        margin-bottom: 1.2rem;
    }
    body.dark-mode .motivation-quote-card .quote-author {
        color: var(--accent-color);
    }
    .quote-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-top: 1px solid var(--tap-area-bg);
        padding-top: 1rem;
    }
    body.dark-mode .quote-footer {
        border-top-color: #333;
    }
    .quote-tags {
        display: flex;
        gap: 0.5rem;
    }
    .quote-tag-badge {
        background-color: var(--tap-area-bg);
        color: var(--text-light);
        font-size: 0.75rem;
        font-weight: 500;
        padding: 0.3rem 0.6rem;
        border-radius: 1rem;
    }
    .quote-actions {
        display: flex;
        gap: 1rem;
    }
    .quote-actions .action-icon {
        font-size: 1.4rem;
        cursor: pointer;
        color: var(--text-light);
        transition: color 0.2s, transform 0.2s;
    }
    .quote-actions .action-icon:hover {
        transform: scale(1.1);
    }
    .quote-actions .action-icon.favorited {
        color: #e91e63;
    }
    .motivation-toast {
        position: fixed;
        bottom: -100px;
        left: 50%;
        transform: translateX(-50%);
        background-color: var(--header-bg);
        color: var(--header-text);
        padding: 1rem 1.5rem;
        border-radius: var(--radius);
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        font-weight: 500;
        z-index: 5000;
        transition: bottom 0.5s ease-in-out;
    }
    .motivation-toast.show {
        bottom: 80px;
    }

    
    </style>
    <body>
      <nav id="sidebar">
        <h3 data-key="nav_title">Menu</h3>
        <ul>
          <li><a href="#" id="prayer-times-btn">🕒 Jadwal Sholat</a></li>
          <li><a href="#" id="doa-harian-btn" data-key="nav_doa">🤲 Doa Harian</a></li>
          <li><a href="#" id="quran-btn" data-key="nav_quran">📖 Al-Qur'an</a></li>
          <li><a href="#" id="dzikir-btn" data-key="nav_dzikir">📿 Dzikir & Tasbih</a></li>
          <li><a href="#" id="qibla-btn" data-key="nav_kiblat">🕋 Kiblat</a></li>
          <li><a href="#" id="quiz-btn">🧠 Kuis Ayat</a></li>
          <li><a href="#" id="motivasi-btn">🌟 Motivasi Islami</a></li> 
          <li><a href="#" id="sahabat-annur-btn">🤖 Sahabat Annur</a></li>
          <li><a href="#" id="settings-btn" data-key="nav_settings">⚙️ Pengaturan</a></li>
        </ul>
      </nav>
    
      <div class="app-container">
        <div id="prayer-times-view" class="main-view">
          <header class="main-header">
            <button id="menu-toggle"><span class="bar"></span><span class="bar"></span><span class="bar"></span></button>
            <h1 id="next-prayer-name">Imsak</h1>
            <p data-key="remaining_time">Waktu Tersisa</p>
            <div id="countdown-timer">00:00:00</div>
            <div id="location-display"><span class="icon">📍</span><span id="city-name">Memuat...</span>
            </div>
          </header>
          <section class="calendar-section">
            <div class="date-header">
              <span class="hijri-date" id="hijri-date-display">...</span>
              <span class="gregorian-date" id="gregorian-date-display">...</span>
            </div>
            <div class="calendar-view" id="calendar-view-container"></div>
          </section>
          <main class="prayer-list-section" id="prayer-list-container"></main>
          <footer class="app-footer">Annur Islamic</footer>
        </div>
    
        <div id="doa-view" class="main-view generic-list-view" style="display: none;">
          <div class="view-header">
            <span class="back-button" data-target-view="prayer-times-view">‹</span>
            <h2>Doa Harian</h2>
          </div>
          <div class="last-read-card" id="last-read-doa-card">
            <h3 data-key="last_read">TERAKHIR DIBACA</h3>
            <p data-key="no_last_read">Belum ada doa yang dibaca</p>
          </div>
          <div class="tabs-container">
            <div class="tab-item active" data-tab="all" data-key="all_doa">Semua Doa</div>
            <div class="tab-item" data-tab="bookmarked" data-key="bookmarked">Ditandai</div>
          </div>
          <div class="list-container" id="doa-list-container-view"></div>
        </div>
    
        <div id="quran-view" class="main-view generic-list-view" style="display: none;">
          <div class="view-header">
            <span class="back-button" data-target-view="prayer-times-view">‹</span>
            <h2>Al-Qur'an</h2>
          </div>
          <div class="last-read-card" id="last-read-surah-card">
            <h3>TERAKHIR DIBACA</h3>
            <p>Belum ada surah yang dibaca</p>
          </div>
          <div class="tabs-container" id="quran-tabs">
            <div class="tab-item active" data-tab="surah">Surah</div>
            <div class="tab-item" data-tab="juz">Juz</div>
            <div class="tab-item" data-tab="bookmarked">Ditandai</div>
          </div>
          <div class="list-container" id="quran-list-container"></div>
        </div>
    
        <div id="juz-detail-view" class="main-view" style="display: none;">
          <div class="view-header">
            <span class="back-button" data-target-view="quran-view">‹</span>
            <h2 id="juz-detail-title">Daftar Surah</h2>
          </div>
          <div class="list-container" id="juz-surah-list-container"></div>
        </div>
    
        <div id="surah-view" class="main-view" style="display: none;">
          <div class="view-header">
            <span class="back-button" id="surah-view-back-btn">‹</span>
            <h2 id="surah-view-title">Nama Surah</h2>
            <span class="action-icon" id="surah-view-bookmark-btn">⭐</span>
          </div>
          <div id="surah-view-body">
          </div>
        </div>
    
        <div id="dzikir-view" class="main-view generic-list-view" style="display: none;">
          <div class="view-header">
            <span class="back-button" data-target-view="prayer-times-view">‹</span>
            <h2>Dzikir & Tasbih</h2>
          </div>
          <div class="list-container" id="dzikir-list-container"></div>
        </div>
    
        <div id="quiz-view" class="main-view" style="display: none; padding: 1.5rem 1rem;">
          <div class="view-header">
            <span class="back-button" data-target-view="prayer-times-view">‹</span>
            <h2>Kuis Sambung Ayat</h2>
            <div class="quiz-points-display">
              <span id="user-points">0</span> 💎
            </div>
          </div>
    
          <div class="quiz-intro">
            <h3>Asah Hafalan Al-Qur'an Anda!</h3>
            <p>Pilih mode permainan untuk memulai. Dapatkan poin untuk setiap jawaban yang benar dan tukarkan dengan tema menarik.</p>
          </div>
    
          <div class="quiz-mode-selection">
            <div class="quiz-mode-card" data-mode="individu">
              <h4>👤 Mode Individu</h4>
              <p>Bermain sendiri dan kumpulkan poin sebanyak-banyaknya.</p>
            </div>
            <div class="quiz-mode-card" data-mode="duet">
              <h4>👥 Mode Duet</h4>
              <p>Tantang teman dalam satu perangkat.</p>
            </div>
          </div>
    
          <button id="theme-store-btn" class="modal-action-btn">
            🛍️ Toko Tema
          </button>
        </div>
    
        <div id="quiz-level-selection-view" class="main-view" style="display: none; padding: 1.5rem 1rem;">
          <div class="view-header">
            <span class="back-button" data-target-view="quiz-view">‹</span>
            <h2 id="quiz-level-title">Pilih Level</h2>
          </div>
          <div class="quiz-intro">
            <h3>Tingkat Kesulitan</h3>
            <p>Pilih tingkat kesulitan soal yang akan dimainkan.</p>
          </div>
          <div class="quiz-mode-selection" id="level-selection-container">
            <div class="quiz-mode-card" data-level="mudah">
              <h4>🟢 Mudah</h4>
              <p>Soal dari surah-surah pendek dan ayat populer.</p>
            </div>
            <div class="quiz-mode-card" data-level="sedang">
              <h4>🟡 Sedang</h4>
              <p>Soal dari Juz 'Amma dan sekitarnya.</p>
            </div>
            <div class="quiz-mode-card" data-level="sulit">
              <h4>🔴 Sulit</h4>
              <p>Soal acak dari berbagai surah di Al-Qur'an.</p>
            </div>
          </div>
        </div>
    
        <div id="quiz-game-view" class="main-view" style="display: none; padding: 1.5rem 1rem;">
          <div class="view-header">
            <span class="back-button" data-target-view="quiz-level-selection-view">‹</span>
            <h2 id="quiz-game-title">Mode Individu</h2>
            <div class="quiz-points-display">
              Skor: <span id="quiz-score">0</span>
            </div>
          </div>
          <div class="quiz-game-area">
            <div class="quiz-question-card">
              <p>Lanjutkan potongan ayat berikut:</p>
              <h3 id="quiz-question-text">...</h3>
            </div>
            <div class="quiz-options-container" id="quiz-options">
            </div>
            <div id="quiz-feedback" class="quiz-feedback"></div>
          </div>
        </div>
        
        <div id="quiz-duet-game-view" class="main-view" style="display: none; padding: 1.5rem 1rem;">
          <div class="view-header">
            <span class="back-button" data-target-view="quiz-level-selection-view">‹</span>
            <h2>Mode Duet</h2>
          </div>
          
          <div id="duet-score-board" style="display: flex; justify-content: space-around; text-align: center; margin-bottom: 1.5rem; background-color: var(--card-bg); padding: 1rem; border-radius: var(--radius); box-shadow: 0 2px 5px var(--card-shadow);">
            <div class="player-container" id="player1-container">
              <h4 style="color: var(--header-bg);">Pemain 1</h4>
              <div class="quiz-points-display" id="player1-score">Skor: 0</div>
            </div>
            <div class="player-container" id="player2-container">
              <h4 style="color: var(--header-bg);">Pemain 2</h4>
              <div class="quiz-points-display" id="player2-score">Skor: 0</div>
            </div>
          </div>
    
          <div class="quiz-game-area">
            <div class="quiz-question-card">
              <p id="duet-turn-indicator">Giliran Pemain 1</p>
              <p>Lanjutkan potongan ayat berikut:</p>
              <h3 id="duet-question-text">...</h3>
            </div>
            <div class="quiz-options-container" id="duet-options">
            </div>
            <div id="duet-feedback" class="quiz-feedback"></div>
          </div>
        </div>
        
        <div id="motivation-view" class="main-view" style="display: none; padding: 1.5rem 1rem;">
            <div class="view-header">
                <span class="back-button" data-target-view="prayer-times-view">‹</span>
                <h2>Motivasi Islami</h2>
                <span class="action-icon" id="motivation-bookmark-list-btn" title="Lihat Favorit">❤️</span>
            </div>
            <div id="featured-motivation-carousel" class="motivation-carousel-container content-card">
                <div class="motivation-carousel-track">
                </div>
                <button class="carousel-control prev" aria-label="Sebelumnya">‹</button>
                <button class="carousel-control next" aria-label="Selanjutnya">›</button>
                <div class="carousel-indicators"></div>
            </div>
            <div class="tabs-container" id="motivation-tabs">
                <div class="tab-item active" data-category="all">Semua</div>
                <div class="tab-item" data-category="Sabar">Sabar</div>
                <div class="tab-item" data-category="Syukur">Syukur</div>
                <div class="tab-item" data-category="Semangat">Semangat</div>
            </div>
            <div id="motivation-list-container">
            </div>
            <button id="random-quote-btn" class="modal-action-btn" style="margin-top: 1.5rem;">
                🔄 Tampilkan Kutipan Acak
            </button>
            <div id="motivation-toast" class="motivation-toast">
                Teks berhasil disalin!
            </div>
        </div>
    
      </div>
            <div id="sahabat-annur-view" class="main-view" style="display: none;">
        <div class="view-header" style="padding: 0 1rem; margin-bottom: 1rem;">
            <span class="back-button" data-target-view="prayer-times-view">‹</span>
            <h2>Sahabat Annur</h2>
        </div>
        <div id="chat-window">
            <div class="chat-message ai-message">
                <div class="ai-avatar">AI</div>
                <div class="chat-bubble">
                    <p>Assalamu'alaikum Wr.Wb! Saya Sahabat Annur, asisten AI Anda.</p>
                    <p>Ada yang bisa saya bantu terkait pertanyaan seputar Islam? Silakan ketik pertanyaan Anda di bawah.</p>
                </div>
            </div>
            
            <div class="chat-message ai-message" id="typing-container" style="display: none;">
                 <div class="ai-avatar">AI</div>
                 <div class="chat-bubble">
                    <div class="typing-indicator">
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sahabat-annur-input-area">
            <input type="text" id="sahabat-annur-input" placeholder="Tanya tentang Islam...">
            <button id="sahabat-annur-send-btn" aria-label="Kirim">➢</button>
        </div>
      </div>
    </div>
    
      <div id="qibla-view" class="main-view">
        <div class="view-header">
          <span class="back-button" data-target-view="prayer-times-view">‹</span>
          <h2>Arah Kiblat</h2>
        </div>
    
        <div id="qibla-compass-container">
          <div id="qibla-compass-circle">
            <div id="qibla-lubber-line"></div>
            <div id="qibla-needle"></div>
          </div>
        </div>
    
        <div id="qibla-info-box">
          <p class="direction-degree">Arahkan jarum ke garis merah</p>
          <p class="calibration-info">Jika arah tidak akurat, gerakkan HP membentuk angka 8 & jauhkan dari logam/magnet.</p>
          <button id="qibla-recalibrate-btn">Kalibrasi Ulang</button>
        </div>
    
        <div id="qibla-permission-prompt" style="display: none; text-align:center; padding: 2rem; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
          <p style="color:white; margin-bottom: 1rem;">Fitur ini memerlukan izin lokasi dan sensor gerak.</p>
          <button id="qibla-permission-btn" class="modal-action-btn" style="max-width: 200px; margin:auto; background-color: #f9d788; color: #1a3a32;">Mulai</button>
        </div>
      </div>
    
      <div id="tasbih-view" class="main-view">
        <div class="view-header">
          <span class="back-button" data-target-view="dzikir-view">‹</span>
          <h2 id="tasbih-title">Penghitung Tasbih</h2>
        </div>
        <div class="tasbih-main">
          <div id="tasbih-counter-display">
            <div class="count" id="tasbih-current-count">0</div>
            <div class="target" id="tasbih-target-count">/ 33</div>
          </div>
          <div id="tasbih-text-display">
            <p class="tasbih-arabic"></p>
            <p class="tasbih-latin"></p>
            <p class="tasbih-arti"></p>
          </div>
          <div id="tasbih-tap-area">
            <span class="tap-icon">🖐️</span>
          </div>
          <button id="tasbih-reset-btn">Reset</button>
        </div>
      </div>
    
      <div id="settings-modal" class="full-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3 data-key="settings_title">Pengaturan</h3>
            <span class="close-button">&times;</span>
          </div>
          <div class="modal-body">
            <div class="settings-item">
              <label for="dark-mode-toggle" data-key="settings_dark_mode">Mode Malam</label>
              <label class="switch"><input type="checkbox" id="dark-mode-toggle"><span class="slider"></span></label>
            </div>
            <div class="settings-item">
              <label for="enable-notifications-btn" data-key="settings_notifications">Notifikasi Adzan</label>
              <button id="enable-notifications-btn">Aktifkan</button>
            </div>
            <div class="settings-item">
              <label for="language-select" data-key="settings_language">Bahasa</label>
              <select name="language" id="language-select" class="custom-select">
                <option value="id">Bahasa Indonesia</option>
                <option value="en">English</option>
                <option value="ar">العربية (Arabic)</option>
                <option value="tr">Türkçe (Turkish)</option>
                <option value="fr">Français (French)</option>
                <option value="es">Español (Spanish)</option>
                <option value="de">Deutsch (German)</option>
                <option value="ru">Русский (Russian)</option>
                <option value="ur">اردو (Urdu)</option>
                <option value="bn">বাংলা (Bengali)</option>
              </select>
            </div>

            <div class="settings-group" style="margin-top: 1.5rem; padding: 0; background-color: transparent; box-shadow: none;">
              <div id="adhan-settings-trigger-container">
              </div>
            </div>
    
            <div style="padding: 1rem;">
                <button id="test-alarm-btn" class="modal-action-btn" style="background-color: #dc3545;">
                    Tes Alarm 5 Detik
                </button>
 
            </div>    

            <div style="padding: 1rem; padding-top: 0;">
                <button id="test-sound-btn" class="modal-action-btn" style="background-color: #28a745;">
                    Tes Suara Langsung
                </button>
            </div>

            <div class="settings-group" style="padding: 1rem; margin-top: 1rem;">
              <h4 style="font-size: 1rem; color: var(--header-bg); margin-bottom: 0.75rem; padding-bottom: 0; border: none;">Notifikasi Terlambat?</h4>
              <p style="font-size: 0.85rem; color: var(--text-light); line-height: 1.5; margin-bottom: 1rem;">
                Beberapa merk HP membatasi aplikasi di latar belakang. Jika notifikasi tidak tepat waktu, coba optimalkan.
              </p>
              <button onclick="Android.requestBatteryOptimization()" class="modal-action-btn" style="width: 100%; margin-top: 0;">
                Optimalkan Notifikasi
              </button>
            </div>
<div class="settings-group">
    <h4>Tampilan Alarm</h4>
    <div class="settings-item">
        <label for="popup-alarm-btn">Izinkan Pop-up Alarm</label>
        <button id="popup-alarm-btn" class="custom-select">Buka Pengaturan</button>
    </div>
    <p style="font-size: 0.8rem; color: var(--text-light); margin-top: 0.5rem;">
        Agar layar alarm bisa langsung muncul di atas aplikasi lain saat adzan berkumandang.
    </p>
</div>
            <div class="settings-group" style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid #ddd;">
              <div class="settings-item">
                <label data-key="settings_about">Tentang Aplikasi</label>
                <span>v18.02.2022 (25)</span>
              </div>
              <div class="detail-app-container">
                <button id="detail-app-btn">Detail Aplikasi</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    
      <div id="single-doa-modal" class="full-modal">
        <div class="modal-content">
          <div class="modal-header">
            <span class="close-button">&times;</span>
            <h3 id="single-doa-modal-title">Detail Doa</h3>
            <span class="action-icon" id="bookmark-doa-btn">⭐</span>
          </div>
          <div class="modal-body" id="single-doa-modal-body"></div>
        </div>
      </div>
    
      <div id="dzikir-detail-modal" class="full-modal">
        <div class="modal-content">
          <div class="modal-header">
            <span class="close-button">&times;</span>
            <h3 id="dzikir-detail-modal-title">Detail Dzikir</h3>
          </div>
          <div class="modal-body" id="dzikir-detail-modal-body"></div>
        </div>
      </div>
    
      <div id="adhan-settings-view" class="main-view" style="display: none; padding-top: 1.5rem;">
        <div class="view-header">
          <span class="back-button" id="adhan-settings-back-btn">‹</span>
          <h2>Pengaturan Suara Adzan</h2>
        </div>
        <div class="content-body" id="adhan-settings-body">
        </div>
      </div>
    
      <div id="app-detail-view" class="main-view" style="display: none; padding-top: 1.5rem;">
        <div class="view-header">
          <span class="back-button" id="detail-view-back-btn">‹</span>
          <h2>Detail Aplikasi</h2>
        </div>
        <div class="content-body" style="padding: 0 1.5rem;">
          <div class="settings-menu-item" data-target-view="privacy-policy-view">
            <span>Kebijakan Privasi</span>
            <span class="arrow">&rsaquo;</span>
          </div>
          <div class="settings-menu-item" data-target-view="terms-of-use-view">
            <span>Ketentuan Penggunaan</span>
            <span class="arrow">&rsaquo;</span>
          </div>
          <div class="settings-menu-item" data-target-view="additional-info-view">
            <span>Informasi Tambahan</span>
            <span class="arrow">&rsaquo;</span>
          </div>
          <div class="settings-menu-item" data-target-view="feedback-view">
            <span>Saran & Masukan</span>
            <span class="arrow">&rsaquo;</span>
          </div>
          <div class="settings-item">
            <label>Versi Aplikasi</label>
            <span>v18.02.2022 (25)</span>
          </div>
    
          <a href="https://play.google.com/store/apps/details?id=com.nama.paket.anda" target="_blank" class="playstore-btn">
            <svg class="playstore-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M2.57 2.15C2.37 2.27 2.25 2.5 2.25 2.75v18.5c0 .25.12.48.32.6l10.06-10.05L2.57 2.15z" fill="#00c0f3"></path>
              <path d="M14.2 11.25L3.92 21.43c.19.07.4.12.63.12h.02c.26 0 .5-.09.7-.25l3.8-2.61 5.13-5.44z" fill="#4ffab9"></path>
              <path d="M14.2 12.75l-5.13-5.44-3.8-2.61a1.24 1.24 0 0 1-.7-.25h-.02c-.23 0-.44.05-.63.12L14.2 12.75z" fill="#ffda44"></path>
              <path d="M19.7 15.02c.7-.72.7-1.89 0-2.6l-3.32-3.32-2.18 2.31 5.5 3.61z" fill="#ff5555"></path>
              <path d="M14.2 12l-10.1 9.98c.2.12.43.2.68.2a1.2 1.2 0 0 0 .99-.5l12.5-7.18-4.07-4.1z" fill="#ff7043" opacity=".6"></path>
            </svg>
            <span>Unduh di Google PlayStore</span>
          </a>
    
        </div>
      </div>
    
      <div id="privacy-policy-view" class="main-view" style="display: none; padding-top: 1.5rem;">
        <div class="view-header">
          <span class="back-button" data-target-view="app-detail-view">‹</span>
          <h2>Kebijakan Privasi</h2>
        </div>
        <div class="content-body">
          <div class="content-card">
            <p><strong>Pembaruan Terakhir: 20 Juli 2025</strong></p>
            <p>Aplikasi <strong>Annur Islamic</strong> ("kami") berkomitmen untuk melindungi privasi Anda. Kebijakan ini menjelaskan bagaimana kami mengumpulkan, menggunakan, dan melindungi informasi Anda.</p>
          </div>
    
          <div class="content-card">
            <h3 class="content-title"><span class="content-title-icon">📍</span>Pengumpulan Informasi Lokasi</h3>
            <p>Aplikasi ini mengumpulkan data lokasi geografis Anda (latitude dan longitude) hanya untuk tujuan menghitung waktu sholat yang akurat dan menentukan arah Kiblat. Data ini <strong>tidak pernah disimpan</strong> di server kami atau dibagikan dengan pihak ketiga. Semua perhitungan dilakukan secara lokal di perangkat Anda.</p>
          </div>
    
          <div class="content-card">
            <h3 class="content-title"><span class="content-title-icon">💾</span>Penyimpanan Lokal</h3>
            <p>Kami menggunakan penyimpanan lokal (localStorage) di browser Anda untuk menyimpan preferensi seperti tema (mode malam), bahasa, pengaturan suara azan, dan data cache jadwal sholat untuk penggunaan offline. Data ini sepenuhnya tetap berada di perangkat Anda dan tidak dikirim ke mana pun.</p>
          </div>
        </div>
      </div>
    
      <div id="terms-of-use-view" class="main-view" style="display: none; padding-top: 1.5rem;">
        <div class="view-header">
          <span class="back-button" data-target-view="app-detail-view">‹</span>
          <h2>Ketentuan Penggunaan</h2>
        </div>
        <div class="content-body">
          <div class="content-card">
            <p>Dengan mengunduh atau menggunakan aplikasi Annur Islamic, Anda secara otomatis menyetujui ketentuan berikut:</p>
            <ul class="styled-list">
              <li>Anda tidak diizinkan untuk menyalin, memodifikasi aplikasi, atau merek dagang kami dengan cara apa pun.</li>
              <li>Aplikasi ini disediakan "sebagaimana adanya". Kami berusaha memastikan keakuratan data, namun tidak memberikan jaminan mutlak. Pengguna disarankan untuk verifikasi silang dengan sumber tepercaya.</li>
              <li>Kami berhak untuk mengubah ketentuan ini kapan saja. Penggunaan aplikasi secara berkelanjutan dianggap sebagai penerimaan Anda terhadap ketentuan baru.</li>
            </ul>
          </div>
        </div>
      </div>
    
      <div id="additional-info-view" class="main-view" style="display: none; padding-top: 1.5rem;">
        <div class="view-header">
          <span class="back-button" data-target-view="app-detail-view">‹</span>
          <h2>Informasi Tambahan</h2>
        </div>
        <div class="content-body">
          <div class="content-card">
            <h3 class="content-title"><span class="content-title-icon">📊</span>Sumber Data</h3>
            <ul class="styled-list">
              <li><strong>Waktu Sholat:</strong> Menggunakan API dari Aladhan.com dengan metode kalkulasi ISNA.</li>
              <li><strong>Al-Qur'an:</strong> Teks, terjemahan, dan data surah diambil dari API publik Quran.gading.dev.</li>
              <li><strong>Arah Kiblat:</strong> Dihitung menggunakan koordinat geografis dan data sensor perangkat.</li>
              <li><strong>Lokasi:</strong> Nama kota didapatkan melalui layanan Nominatim (OpenStreetMap).</li>
            </ul>
          </div>
          <div class="content-card">
            <h3 class="content-title"><span class="content-title-icon">🤝</span>Dukungan</h3>
            <p>Pengembangan aplikasi ini didukung oleh <strong>PT. Medan Mediaga Group</strong>, sebagai bentuk <strong>dukungan aktif</strong> dalam menghadirkan solusi digital Islami yang bermanfaat dan mudah diakses oleh semua kalangan umat islam.</p>
          </div>
            <div class="content-card">
              <h3 class="content-title"><span class="content-title-icon">❤️</span>Proyek Non-Komersial</h3>
              <p>Aplikasi ini adalah proyek non-komersial, dibuat untuk membantu umat Muslim dalam ibadah sehari-hari. Aplikasi ini sepenuhnya <strong>gratis dan tidak mengandung iklan</strong>.</p>
            </div>
        </div>
      </div>
    
      <div id="feedback-view" class="main-view" style="display: none; padding-top: 1.5rem;">
        <div class="view-header">
          <span class="back-button" data-target-view="app-detail-view">‹</span>
          <h2>Saran & Masukan</h2>
        </div>
        <div class="content-body">
          <div class="content-card">
            <h3 class="content-title"><span class="content-title-icon">💌</span>Hubungi Kami</h3>
            <p>Kami sangat menghargai saran dan masukan dari Anda untuk membuat aplikasi ini menjadi lebih baik. Silakan kirimkan ide, laporan bug, atau masukan lainnya melalui email kepada pengembang.</p>
            <div class="email-link-wrapper">
              <a href="mailto:annurislamic60@gmail.com?subject=Masukan untuk Aplikasi Annur Islamic" class="modal-action-btn" style="text-decoration: none; display: inline-block; width: auto; padding: 0.8rem 1.5rem;">Kirim Email</a>
            </div>
          </div>
        </div>
      </div>
    
      <div id="custom-location-modal" class="full-modal">
        <div class="modal-content permission-modal-content">
          <h3>Butuh Izin Lokasi Anda</h3>
          <p>Aplikasi ini memerlukan akses ke lokasi Anda untuk menampilkan jadwal sholat dan arah kiblat yang akurat. Data lokasi Anda tidak disimpan atau dibagikan.</p>
          <div class="permission-modal-actions">
            <button id="deny-location-btn" class="modal-action-btn deny-btn" style="margin-top: 0;">Nanti Saja</button>
            <button id="allow-location-btn" class="modal-action-btn" style="margin-top: 0;">Izinkan</button>
          </div>
        </div>
      </div>
    
      <div id="custom-notification-modal" class="full-modal">
        <div class="modal-content permission-modal-content">
          <h3>Aktifkan Notifikasi Adzan?</h3>
          <p>Izinkan aplikasi mengirimkan notifikasi agar Anda tidak ketinggalan waktu sholat. Anda dapat mengatur suara dan jadwal notifikasi di menu Pengaturan.</p>
          <div class="permission-modal-actions">
            <button id="deny-notification-btn" class="modal-action-btn deny-btn" style="margin-top: 0;">Lain Kali</button>
            <button id="allow-notification-btn" class="modal-action-btn" style="margin-top: 0;">Aktifkan</button>
          </div>
        </div>
      </div>
    
      <div id="theme-store-modal" class="full-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Toko Tema</h3>
            <span class="close-button">&times;</span>
            <span id="store-user-points">Poin Anda: 0 💎</span>
          </div>
          <div class="modal-body">
            <p style="font-size: 0.9rem; text-align: center; color: var(--text-light);">Tukarkan poin yang didapat dari kuis dengan tema-tema menarik!</p>
            <div id="theme-grid">
              </div>
          </div>
        </div>
      </div>
      
      <div id="duet-result-modal" class="full-modal">
          <div class="modal-content permission-modal-content">
            <h3 id="duet-winner-text">Hasil Pertandingan!</h3>
            <p id="duet-final-scores" style="margin-bottom: 1.5rem;"></p>
            <div class="permission-modal-actions">
              <button id="duet-play-again-btn" class="modal-action-btn" style="margin-top: 0;">Main Lagi</button>
              <button id="duet-back-to-menu-btn" class="modal-action-btn deny-btn" style="margin-top: 0;">Kembali ke Menu</button>
            </div>
          </div>
      </div>
      
  <div id="individual-result-modal" class="full-modal">
    <div class="modal-content permission-modal-content">
        <h3>🎉 Permainan Selesai! 🎉</h3>
        <p id="individual-final-score" style="font-size: 1.2rem; font-weight: 600; margin: 1rem 0;"></p>
        <p id="individual-points-earned" style="margin-bottom: 1.5rem;"></p>
        <div class="permission-modal-actions">
            <button id="individual-back-to-menu-btn" class="modal-action-btn" style="margin-top: 0;">Kembali ke Menu</button>
        </div>
    </div>
</div>

<div id="theme-purchase-modal" class="full-modal">
    <div class="modal-content permission-modal-content">
        <h3>Konfirmasi Pembelian</h3>
        <p id="theme-purchase-info" style="margin-bottom: 1.5rem;"></p>
        <div class="permission-modal-actions">
            <button id="cancel-purchase-btn" class="modal-action-btn deny-btn" style="margin-top: 0;">Batal</button>
            <button id="confirm-purchase-btn" class="modal-action-btn" style="margin-top: 0;">Beli</button>
        </div>
    </div>
</div>    
<div id="theme-success-modal" class="full-modal">
    <div class="modal-content permission-modal-content">
        <h3>✅ Pembelian Berhasil!</h3>
        <p id="theme-success-info" style="margin-bottom: 1.5rem;"></p>
        <div class="permission-modal-actions">
            <button id="theme-success-ok-btn" class="modal-action-btn" style="margin-top: 0;">Mantap!</button>
        </div>
    </div>
</div>
    
    
      <audio id="audio-notification" src="https://raw.githubusercontent.com/AnnurIslamic/Mp3/main/notifikasi.mp3" preload="auto"></audio>
      <audio id="audio-adhan-fajr" src="https://raw.githubusercontent.com/AnnurIslamic/Mp3/main/adzansubuh.mp3" preload="auto"></audio>
      <audio id="audio-adhan-mishary" src="https://raw.githubusercontent.com/AnnurIslamic/Mp3/main/mishary.mp3" preload="auto"></audio>
      <audio id="audio-adhan-madinah" src="https://raw.githubusercontent.com/AnnurIslamic/Mp3/main/adzankota.mp3" preload="auto"></audio>
      <audio id="murottal-player" preload="auto"></audio>
      
      
    
    </body>
    

<script>
    // [BARU] Variabel untuk state kuis
    let userPoints = 0;
    let quizScore = 0;
    let currentQuestionIndex = 0;
    let availableQuestions = [];
    
    // [BARU] Variabel untuk state Kuis Duet
    let duetGameState = {
        active: false,
        currentPlayer: 1,
        player1Score: 0,
        player2Score: 0,
        currentRound: 1,
        questionsPerPlayer: 5, // Main 5 ronde per pemain
        questionPool: []
    };
    
    
    // --- DATA ---
    const dzikirData = [
        { id: 'dzikir_1', title: 'Tasbih', subtitle: 'Menyucikan Allah', arabic: 'سُبْحَانَ اللَّهِ', latin: 'Subhanallah', arti: 'Maha Suci Allah', target: 33 },
        { id: 'dzikir_2', title: 'Tahmid', subtitle: 'Memuji Allah', arabic: 'الْحَمْدُ لِلَّهِ', latin: 'Alhamdulillah', arti: 'Segala Puji Bagi Allah', target: 33 },
        { id: 'dzikir_3', title: 'Takbir', subtitle: 'Mengagungkan Allah', arabic: 'اللَّهُ أَكْبَرُ', latin: 'Allahu Akbar', arti: 'Allah Maha Besar', target: 33 },
        { id: 'dzikir_4', title: 'Tahlil', subtitle: 'Kalimat Tauhid', arabic: 'لَا إِلَهَ إِلَّا اللَّهُ', latin: 'La ilaha illallah', arti: 'Tiada Tuhan selain Allah', target: 33 },
        { id: 'dzikir_5', title: 'Istighfar', subtitle: 'Memohon Ampunan', arabic: 'أَسْتَغْفِرُ اللَّهَ', latin: 'Astaghfirullah', arti: 'Aku memohon ampun kepada Allah', target: 33 },
        { id: 'dzikir_6', title: 'Salawat Nabi', subtitle: 'Untuk Nabi Muhammad SAW', arabic: 'اللَّهُمَّ صَلِّ عَلَى مُحَمَّدٍ وَعَلَى آلِ مُحَمَّدٍ', latin: 'Allahumma salli \'ala Muhammad wa \'ala ali Muhammad', arti: 'Ya Allah, berikanlah rahmat kepada Nabi Muhammad dan keluarga Nabi Muhammad.', target: 33 },
        { id: 'dzikir_7', title: 'Hauqalah', subtitle: 'Pengakuan Kekuatan Allah', arabic: 'لَا حَوْلَ وَلَا قُوَّةَ إِلَّا بِاللهِ', latin: 'La hawla wa la quwwata illa billah', arti: 'Tiada daya dan upaya kecuali dengan kekuatan Allah.', target: 33 }
    ];
    const doaHarianData = [
        { id: 1, title: "Doa Bangun Tidur", subtitle: "Adab memulai hari", arabic: "الْحَمْدُ لِلَّهِ الَّذِي أَحْيَانَا بَعْدَ مَا أَمَاتَنَا وَإِلَيْهِ النُّشُورُ", latin: "Alhamdulillahilladzi ahyaanaa ba'da maa amaatanaa wa ilaihin nusyuur", arti: "Segala puji bagi Allah yang telah menghidupkan kami setelah mematikan kami, dan kepada-Nya lah kami akan dibangkitkan." },
        { id: 2, title: "Doa Masuk Toilet", subtitle: "Memohon perlindungan", arabic: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْخُبُثِ وَالْخَبَائِثِ", latin: "Allahumma innii a'uudzubika minal khubutsi wal khabaaitsi", arti: "Ya Allah, sesungguhnya aku berlindung kepada-Mu dari setan laki-laki dan setan perempuan." },
        { id: 3, title: "Doa Keluar Toilet", subtitle: "Memohon ampunan", arabic: "غُفْرَانَكَ", latin: "Ghufraanaka", arti: "Aku memohon ampunan-Mu." },
        { id: 4, title: "Doa Sebelum Wudhu", subtitle: "Niat bersuci", arabic: "بِسْمِ اللَّهِ", latin: "Bismillah", arti: "Dengan menyebut nama Allah." },
        { id: 5, title: "Doa Setelah Wudhu", subtitle: "Menyempurnakan wudhu", arabic: "أَشْهَدُ أَنْ لاَ إِلَهَ إِلاَّ اللَّهُ وَحْدَهُ لاَ شَرِيكَ لَهُ وَأَشْهَدُ أَنَّ مُحَمَّدًا عَبْدُهُ وَرَسُولُهُ", latin: "Asyhadu an laa ilaaha illallaah wahdahu laa syariika lah, wa asyhadu anna muhammadan 'abduhu wa rasuuluh", arti: "Aku bersaksi bahwa tiada Tuhan selain Allah semata, tiada sekutu bagi-Nya, dan aku bersaksi bahwa Muhammad adalah hamba dan utusan-Nya." },
        { id: 6, title: "Doa Mengenakan Pakaian", subtitle: "Mensyukuri nikmat", arabic: "الْحَمْدُ لِلَّهِ الَّذِي كَسَانِي هَذَا وَرَزَقَنِيهِ مِنْ غَيْرِ حَوْلٍ مِنِّي وَلاَ قُوَّةٍ", latin: "Alhamdulillahilladzi kasaanii hadzaa wa razaqaniihi min ghairi haulin minnii wa laa quwwatin", arti: "Segala puji bagi Allah yang telah memberiku pakaian ini dan menganugerahkannya kepadaku tanpa daya dan kekuatan dariku." },
        { id: 7, title: "Doa Melepas Pakaian", subtitle: "Adab melepas pakaian", arabic: "بِسْمِ اللَّهِ", latin: "Bismillah", arti: "Dengan menyebut nama Allah." },
        { id: 8, title: "Doa Keluar Rumah", subtitle: "Memohon perlindungan", arabic: "بِسْمِ اللَّهِ تَوَكَّلْتُ عَلَى اللَّهِ لاَ حَوْلَ وَلاَ قُوَّةَ إِلاَّ بِاللَّهِ", latin: "Bismillahi tawakkaltu 'alallah, laa haula wa laa quwwata illaa billaah", arti: "Dengan nama Allah, aku bertawakal kepada Allah, tiada daya dan kekuatan kecuali dengan pertolongan Allah." },
        { id: 9, title: "Doa Masuk Rumah", subtitle: "Memohon kebaikan", arabic: "بِسْمِ اللَّهِ وَلَجْنَا وَبِسْمِ اللَّهِ خَرَجْنَا وَعَلَى رَبِّنَا تَوَكَّلْنَا", latin: "Bismillahi walajnaa wa bismillahi kharajnaa wa 'alaa rabbinaa tawakkalnaa", arti: "Dengan nama Allah kami masuk, dan dengan nama Allah kami keluar, dan kepada Tuhan kami, kami bertawakal." },
        { id: 10, title: "Doa Pergi ke Masjid", subtitle: "Langkah menuju kebaikan", arabic: "اللَّهُمَّ اجْعَلْ فِي قَلْبِي نُورًا وَفِي لِسَانِي نُورًا...", latin: "Allahummaj 'al fii qalbii nuuran wa fii lisaanii nuuran...", arti: "Ya Allah, jadikanlah cahaya di hatiku, cahaya di lidahku..." },
        { id: 11, title: "Doa Masuk Masjid", subtitle: "Memohon rahmat", arabic: "اللَّهُمَّ افْتَحْ لِي أَبْوَابَ رَحْمَتِكَ", latin: "Allahummaftah lii abwaaba rahmatika", arti: "Ya Allah, bukakanlah untukku pintu-pintu rahmat-Mu." },
        { id: 12, title: "Doa Keluar Masjid", subtitle: "Memohon karunia", arabic: "اللَّهُمَّ إِنِّي أَsْأَلُكَ مِنْ فَضْلِكَ", latin: "Allahumma innii as'aluka min fadhlik", arti: "Ya Allah, sesungguhnya aku memohon kepada-Mu dari karunia-Mu." },
        { id: 13, title: "Doa Sebelum Makan", subtitle: "Agar makanan berkah", arabic: "بِسْمِ اللَّهِ", latin: "Bismillah", arti: "Dengan menyebut nama Allah." },
        { id: 14, title: "Doa Sesudah Makan", subtitle: "Tanda bersyukur", arabic: "الْحَمْدُ لِلَّهِ الَّذِي أَطْعَمَنِي هَذَا وَرَZَقَنِيهِ مِنْ غَيْرِ حَوْلٍ مِنِّي وَلاَ قُوَّةٍ", latin: "Alhamdulillahilladzi ath'amanii hadzaa wa razaqaniihi min ghairi haulin minnii wa laa quwwatin", arti: "Segala puji bagi Allah yang telah memberiku makanan ini dan menganugerahkannya kepadaku tanpa daya dan kekuatan dariku." },
        { id: 15, title: "Doa Ketika Lupa Basmalah", subtitle: "Jika lupa di awal", arabic: "بِسْمِ اللَّهِ أَوَّلَهُ وَآخِرَهُ", latin: "Bismillahi awwalahu wa aakhirahu", arti: "Dengan nama Allah di awal dan di akhirnya." },
        { id: 16, title: "Doa Minum Air Zamzam", subtitle: "Memohon kebaikan", arabic: "اللَّهُمَّ إِنِّي أَسْأَلُكَ عِلْمًا نَافِعًا وَرِزْقًا وَاسِعًا وَشِفَاءً مِنْ كُلِّ دَاءٍ", latin: "Allahumma innii as'aluka 'ilman naafi'an, wa rizqan waasi'an, wasyifaa'an min kulli daa'in", arti: "Ya Allah, aku memohon kepada-Mu ilmu yang bermanfaat, rezeki yang luas, dan kesembuhan dari segala penyakit." },
        { id: 17, title: "Doa Berbuka Puasa", subtitle: "Saat berbuka puasa", arabic: "ذَهَبَ الظَّمَأُ وَابْتَلَّتِ الْعُرُوقُ وَثَبَتَ الأَجْرُ إِنْ شَاءَ اللَّهُ", latin: "Dzahabazh zhoma'u wabtallatil 'uruuqu wa tsabatal ajru insyaallah", arti: "Telah hilang dahaga, telah basah urat-urat, dan telah tetap pahala, insya Allah." },
        { id: 18, title: "Doa Sebelum Tidur", subtitle: "Adab mengakhiri hari", arabic: "بِاسْمِكَ اللَّهُمَّ أَمُوتُ وَأَحْيَا", latin: "Bismikallahumma amuutu wa ahyaa", arti: "Dengan nama-Mu ya Allah aku mati dan aku hidup." },
        { id: 19, title: "Doa Ketika Mimpi Buruk", subtitle: "Memohon perlindungan", arabic: "أَعُوذُ بِكَلِمَاتِ اللَّهِ التَّامَّاتِ مِنْ غَضَبِهِ وَعِقَابِهِ وَشَرِّ عِبَادِهِ...", latin: "A'uudzu bikalimaatillaahit taammaati min ghadhabihi wa 'iqaabihi wa syarri 'ibaadihi...", arti: "Aku berlindung dengan kalimat-kalimat Allah yang sempurna dari kemurkaan-Nya, siksa-Nya, dan kejahatan hamba-hamba-Nya..." },
        { id: 20, title: "Doa Naik Kendaraan", subtitle: "Memohon keselamatan", arabic: "سُبْحَانَ الَّذِي سَخَّرَ لَنَا هَذَا وَمَا كُنَّا لَهُ مُقْرِنِينَ", latin: "Subhaanalladzii sakhkhara lanaa hadzaa wa maa kunnaa lahu muqriniin", arti: "Maha Suci Dzat yang telah menundukkan semua ini bagi kami padahal kami sebelumnya tidak mampu menguasainya." },
        { id: 21, title: "Doa Safar (Bepergian)", subtitle: "Memohon kemudahan", arabic: "اللَّهُمَّ هَوِّنْ عَلَيْنَا سَفَرَنَا هَذَا وَاطْوِ عَنَّا بُعْدَهُ", latin: "Allahumma hawwin 'alainaa safaranaa hadzaa waathwi 'annaa bu'dahu", arti: "Ya Allah, mudahkanlah perjalanan kami ini, dan dekatkanlah jaraknya bagi kami." },
        { id: 22, title: "Doa Tiba di Tujuan", subtitle: "Rasa syukur", arabic: "الْحَمْدُ لِلَّهِ الَّذِي سَلَّمَنِي", latin: "Alhamdulillahilladzi sallamanii", arti: "Segala puji bagi Allah yang telah menyelamatkanku." },
        { id: 23, title: "Doa Menjenguk Orang Sakit", subtitle: "Mendoakan kesembuhan", arabic: "لاَ بَأْسَ طَهُورٌ إِنْ شَاءَ اللَّهُ", latin: "Laa ba'sa thahuurun insyaallah", arti: "Tidak mengapa, semoga menjadi pembersih (dosa), insya Allah." },
        { id: 24, title: "Doa Ketika Hujan Turun", subtitle: "Memohon hujan bermanfaat", arabic: "اللَّهُمَّ صَيِّبًا نَافِعًا", latin: "Allahumma shayyiban naafi'an", arti: "Ya Allah, (jadikanlah hujan ini) hujan yang bermanfaat." },
        { id: 25, title: "Doa Setelah Hujan", subtitle: "Rahmat dari Allah", arabic: "مُطِرْنَا بِفَضْلِ اللَّهِ وَرَحْمَتِهِ", latin: "Muthirnaa bifadhlillahi wa rahmatihi", arti: "Kita diberi hujan karena karunia dan rahmat Allah." },
        { id: 26, title: "Doa Melihat Petir", subtitle: "Tanda kebesaran Allah", arabic: "سُبْحَانَ الَّذِي يُسَبِّحُ الرَّعْدُ بِحَمْدِهِ وَالْمَلاَئِكَةُ مِنْ خِيفَتِهِ", latin: "Subhaanalladzii yusabbihur ra'du bihamdihi wal malaa-ikatu min khiifatihi", arti: "Maha Suci Dzat yang petir bertasbih dengan memuji-Nya, dan para malaikat pun (bertasbih) karena takut kepada-Nya." },
        { id: 27, title: "Doa Ketika Angin Kencang", subtitle: "Memohon kebaikan", arabic: "اللَّهُمَّ إِنِّي أَسْأَلُكَ خَيْرَهَا وَأَعُوذُ بِكَ مِنْ شَرِّهَا", latin: "Allahumma innii as'aluka khairahaa wa a'uudzu bika min syarrihaa", arti: "Ya Allah, aku memohon kepada-Mu kebaikannya dan aku berlindung kepada-Mu dari keburukannya." },
        { id: 28, title: "Doa Bercermin", subtitle: "Agar akhlak baik", arabic: "اللَّهُمَّ كَمَا حَسَّنْتَ خَلْقِي فَحَسِّنْ خُلُقِي", latin: "Allahumma kamaa hassanta khalqii fahassin khuluqii", arti: "Ya Allah, sebagaimana Engkau telah memperindah rupaku, maka perindahlah akhlakku." },
        { id: 29, title: "Doa untuk Kedua Orang Tua", subtitle: "Tanda bakti", arabic: "رَبِّ اغْفِرْ لِي وَلِوَالِدَيَّ وَارْحَمْهُمَا كَمَا رَبَّيَانِي صَغِيرًا", latin: "Rabbighfirlii wa liwaalidayya warhamhumaa kamaa rabbayaanii shaghiiran", arti: "Wahai Tuhanku, ampunilah aku dan kedua orang tuaku, dan sayangilah mereka sebagaimana mereka telah menyayangiku di waktu kecil." },
        { id: 30, title: "Doa Kebaikan Dunia Akhirat", subtitle: "Doa sapu jagat", arabic: "رَبَّنَا آتِنَا فِي الدُّنْيَا حَسَنَةً وَفِي الآخِرَةِ حَسَنَةً وَقِنَا عَذَابَ النَّارِ", latin: "Rabbanaa aatinaa fiddunyaa hasanatan wa fil aakhirati hasanatan wa qinaa 'adzaabannaar", arti: "Ya Tuhan kami, berilah kami kebaikan di dunia dan kebaikan di akhirat, dan peliharalah kami dari siksa neraka." },
        { id: 31, title: "Doa Sebelum Belajar", subtitle: "Memohon ilmu", arabic: "رَبِّ زِدْنِي عِلْمًا", latin: "Rabbi zidnii 'ilman", arti: "Wahai Tuhanku, tambahkanlah ilmu kepadaku." },
        { id: 32, title: "Doa Sesudah Belajar", subtitle: "Agar ilmu bermanfaat", arabic: "اللَّهُمَّ انْفَعْنِي بِمَا عَلَّمْتَنِي وَعَلِّمْنِي مَا يَنْفَعُنِي وَزِدْنِي عِلْمًا", latin: "Allahummanfa'nii bimaa 'allamtanii wa 'allimnii maa yanfa'unii wa zidnii 'ilman", arti: "Ya Allah, berilah manfaat atas apa yang telah Engkau ajarkan kepadaku, ajarilah aku apa yang bermanfaat bagiku, dan tambahkanlah ilmu kepadaku." },
        { id: 33, title: "Doa Penutup Majelis", subtitle: "Kaffaratul Majlis", arabic: "سُبْحَانَكَ اللَّهُمَّ وَبِحَمْدِكَ أَشْهَدُ أَنْ لاَ إِلَهَ إِلاَّ أَنْتَ أَسْتَغْفِرُكَ وَأَتُوبُ إِلَيْكَ", latin: "Subhaanakallahumma wa bihamdika, asyhadu an laa ilaaha illaa anta, astaghfiruka wa atuubu ilaika", arti: "Maha Suci Engkau ya Allah, dan dengan memuji-Mu, aku bersaksi bahwa tiada Tuhan selain Engkau, aku memohon ampun dan bertaubat kepada-Mu." },
        { id: 34, title: "Doa Ketika Bersin", subtitle: "Mengucap syukur", arabic: "الْحَمْدُ لِلَّهِ", latin: "Alhamdulillah", arti: "Segala puji bagi Allah." },
        { id: 35, title: "Jawaban Ketika Orang Bersin", subtitle: "Mendoakan saudara", arabic: "يَرْحَمُكَ اللَّهُ", latin: "Yarhamukallah", arti: "Semoga Allah merahmatimu." },
        { id: 36, title: "Doa Ketika Marah", subtitle: "Meredam amarah", arabic: "أَعُوذُ بِاللَّهِ مِنَ الشَّيْطَانِ الرَّجِيمِ", latin: "A'uudzubillaahi minasy syaithaanir rajiim", arti: "Aku berlindung kepada Allah dari setan yang terkutuk." },
        { id: 37, title: "Doa Masuk Pasar", subtitle: "Memohon kebaikan pasar", arabic: "لاَ إِلَهَ إِلاَّ اللَّهُ وَحْدَهُ لاَ شَرِيكَ لَهُ...", latin: "Laa ilaaha illallaah wahdahu laa syariika lah...", arti: "Tiada Tuhan selain Allah semata, tiada sekutu bagi-Nya..." },
        { id: 38, title: "Doa Ketika Tertimpa Musibah", subtitle: "Kalimat istirja'", arabic: "إِنَّا لِلَّهِ وَإِنَّا إِلَيْهِ رَاجِعُونَ", latin: "Innaa lillaahi wa innaa ilaihi raaji'uun", arti: "Sesungguhnya kami milik Allah dan kepada-Nya lah kami akan kembali." },
        { id: 39, title: "Doa untuk Pengantin Baru", subtitle: "Mendoakan keberkahan", arabic: "بَارَكَ اللَّهُ لَكَ وَبَارَكَ عَلَيْكَ وَجَمَعَ بَيْنَكُمَا فِي خَيْرٍ", latin: "Baarakallahu laka wa baaraka 'alaika wa jama'a bainakumaa fii khairin", arti: "Semoga Allah memberkahimu, dan memberkahi atasmu, dan mengumpulkan kalian berdua dalam kebaikan." },
        { id: 40, title: "Doa Ziarah Kubur", subtitle: "Salam kepada ahli kubur", arabic: "السَّلاَمُ عَلَى أَهْلِ الدِّيَارِ مِنَ الْمُؤْمِنِينَ وَالْمُSْلِمِينَ...", latin: "Assalaamu 'ala ahlid diyaari minal mu'miniina wal muslimiin...", arti: "Keselamatan atas penghuni kubur dari kaum mukminin dan muslimin..." },
        { id: 41, title: "Doa Melihat Hilal", subtitle: "Menyambut bulan baru", arabic: "اللَّهُ أَكْبَرُ، اللَّهُمَّ أَهِلَّهُ عَلَيْنَا بِالْYُمْنِ وَالإِيمَانِ وَالسَّلاَمَةِ وَالإِسْلاَمِ", latin: "Allahu Akbar, Allahumma ahillahu 'alainaa bil yumni wal iimaani wassalaamati wal islaam", arti: "Allah Maha Besar, ya Allah, tampakkanlah bulan itu kepada kami dengan membawa keberkahan dan keimanan, keselamatan dan Islam." },
        { id: 42, title: "Doa Agar Diberi Kesabaran", subtitle: "Memohon keteguhan", arabic: "رَبَّنَا أَفْرِغْ عَلَيْنَا صَبْرًا وَثَبِّتْ أَقْدَامَنَا", latin: "Rabbanaa afrigh 'alainaa shabran wa tsabbit aqdaamanaa", arti: "Ya Tuhan kami, limpahkanlah kesabaran kepada kami dan kukuhkanlah pendirian kami." },
        { id: 43, title: "Doa Mohon Petunjuk", subtitle: "Meminta bimbingan", arabic: "اللَّهُمَّ إِنِّي أَسْأَلُكَ الْهُدَى وَالتُّقَى وَالْعَفَافَ وَالْGِنَى", latin: "Allahumma innii as'alukal hudaa wattuqaa wal 'afaafa wal ghinaa", arti: "Ya Allah, aku memohon kepada-Mu petunjuk, ketakwaan, kesucian diri, dan kecukupan." },
        { id: 44, title: "Doa Terhindar dari Sifat Malas", subtitle: "Memohon semangat", arabic: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْعَجْزِ وَالْكَسَلِ", latin: "Allahumma innii a'uudzubika minal 'ajzi wal kasali", arti: "Ya Allah, aku berlindung kepada-Mu dari kelemahan dan kemalasan." },
        { id: 45, title: "Doa Agar Diteguhkan Hati", subtitle: "Istiqamah dalam iman", arabic: "يَا مُقَلِّبَ الْقُلُوبِ ثَبِّتْ قَلْبِي عَلَى dِينِكَ", latin: "Yaa muqallibal quluub, tsabbit qalbii 'alaa diinik", arti: "Wahai Dzat yang membolak-balikkan hati, teguhkanlah hatiku di atas agama-Mu." },
        { id: 46, title: "Doa Memohon Ampunan & Rahmat", subtitle: "Permohonan ampunan", arabic: "رَبَّنَا ظَلَمْنَا أَنْفُSَنَا وَإِنْ لَمْ تَغْفِرْ لَنَا وَتَرْحَمْنَا لَنَكُونَنَّ مِنَ الْخَاسِرِينَ", latin: "Rabbanaa zhalamnaa anfusanaa wa illam taghfirlanaa wa tarhamnaa lanakuunanna minal khaasiriin", arti: "Ya Tuhan kami, kami telah menzalimi diri kami sendiri, dan jika Engkau tidak mengampuni kami dan memberi rahmat kepada kami, niscaya kami termasuk orang-orang yang rugi." },
        { id: 47, title: "Doa Saat Sulit Tidur", subtitle: "Agar tidur nyenyak", arabic: "اللَّهُمَّ غَارَتِ النُّجُومُ وَهَدَأَتِ الْعُيُونُ...", latin: "Allahumma ghaaratinnujuumu wa hada'atil 'uyuun...", arti: "Ya Allah, bintang-bintang telah terbenam, mata-mata telah terpejam..." },
        { id: 48, title: "Doa Ketika Memulai Pekerjaan", subtitle: "Memohon kelancaran", arabic: "اللَّهُمَّ إِنِّي أَSْأَلُكَ مِنْ خَيْرِ هَذَا الْعَمَلِ وَخَيْرِ مَا فِيهِ", latin: "Allahumma innii as'aluka min khairi hadzal 'amali wa khairi maa fiihi", arti: "Ya Allah, aku memohon kepada-Mu kebaikan pekerjaan ini dan kebaikan yang ada di dalamnya." },
        { id: 49, title: "Doa Setelah Selesai Bekerja", subtitle: "Rasa syukur", arabic: "الْحَمْدُ لِلَّهِ الَّذِي بِنِعْمَتِهِ تَتِمُّ الصَّالِحَاتُ", latin: "Alhamdulillahilladzi bini'matihi tatimmush shaalihaat", arti: "Segala puji bagi Allah yang dengan nikmat-Nya sempurnalah segala kebaikan." },
        { id: 50, title: "Doa Ketika Mendengar Kabar Baik", subtitle: "Ekspresi kebahagiaan", arabic: "الْحَمْدُ لِلَّهِ الَّذِي بِنِعْمَتِهِ تَتِمُّ الصَّالِحَاتُ", latin: "Alhamdulillahilladzi bini'matihi tatimmush shaalihaat", arti: "Segala puji bagi Allah yang dengan nikmat-Nya sempurnalah segala kebaikan." },
        { id: 51, title: "Doa Ketika Mendengar Kabar Buruk", subtitle: "Menjaga kesabaran", arabic: "الْحَمْدُ لِلَّهِ عَلَى كُلِّ حَالٍ", latin: "Alhamdulillahi 'alaa kulli haal", arti: "Segala puji bagi Allah atas segala keadaan." },
        { id: 52, "title": "Doa Memohon Jodoh Terbaik", "subtitle": "Bagi yang belum menikah", "arabic": "رَبِّ لاَ تَذَرْنِي فَرْدًا وَأَنْتَ خَيْرُ الْوَارِثِينَ", "latin": "Rabbi laa tadzarnii fardan wa anta khairul waaritsiin", "arti": "Ya Tuhanku, janganlah Engkau biarkan aku hidup seorang diri, dan Engkaulah pewaris yang paling baik." },
        { id: 53, "title": "Doa Mohon Keturunan yang Baik", "subtitle": "Doa Nabi Zakaria", "arabic": "رَبِّ هَبْ لِي مِنْ لَدُنْكَ ذُرِّيَّةً طَيِّبَةً إِنَّكَ سَمِيعُ الدُّعَاءِ", "latin": "Rabbi hablii min ladunka dzurriyyatan thayyibatan innaka samii'ud du'aa", "arti": "Ya Tuhanku, berilah aku dari sisi-Mu seorang anak yang baik. Sesungguhnya Engkau Maha Pendengar doa." },
        { id: 54, "title": "Doa Agar Terhindar dari Utang", "subtitle": "Memohon kecukupan", "arabic": "اللَّهُمَّ اكْفِنِي بِحَلاَلِكَ عَنْ حَرَامِكَ وَأَغْنِنِي بِفَضْلِكَ عَمَّنْ سِوَاكَ", "latin": "Allahummak finii bihalaalika 'an haraamika wa aghninii bifadhlika 'amman siwaak", "arti": "Ya Allah, cukupkanlah aku dengan yang halal dan jauhkanlah aku dari yang haram, dan cukupkanlah aku dengan karunia-Mu dari bergantung pada selain-Mu." }
    ];
    const translations = {
        'id': { 'nav_title': 'Menu Navigasi', 'nav_doa': '🤲 Doa Harian', 'nav_quran': '📖 Al-Qur\'an', 'nav_dzikir': '📿 Dzikir & Tasbih', 'nav_kiblat': '🕋 Kiblat', 'nav_settings': '⚙️ Pengaturan', 'remaining_time': 'Waktu Tersisa', 'settings_title': 'Pengaturan', 'settings_dark_mode': 'Mode Malam', 'settings_notifications': 'Notifikasi Adzan', 'settings_language': 'Bahasa', 'settings_about': 'Tentang Aplikasi', 'settings_adhan_sound': 'Pengaturan Suara Adzan', 'last_read': 'TERAKHIR DIBACA', 'no_last_read': 'Belum ada doa yang dibaca', 'all_doa': 'Semua Doa', 'bookmarked': 'Ditandai', 'Imsak': 'Imsak', 'Fajr': 'Subuh', 'Sunrise': 'Terbit', 'Dhuhr': 'Dzuhur', 'Asr': 'Ashar', 'Maghrib': 'Maghrib', 'Isha': 'Isya' },
        'en': { 'nav_title': 'Navigation Menu', 'nav_doa': '🤲 Daily Prayers', 'nav_quran': '📖 Al-Qur\'an', 'nav_dzikir': '📿 Dhikr & Tasbih', 'nav_kiblat': '🧭 Qibla', 'nav_settings': '⚙️ Settings', 'remaining_time': 'Time Remaining', 'settings_title': 'Settings', 'settings_dark_mode': 'Dark Mode', 'settings_notifications': 'Adhan Notifications', 'settings_language': 'Language', 'settings_about': 'About App', 'settings_adhan_sound': 'Adhan Sound Settings', 'last_read': 'LAST READ', 'no_last_read': 'No prayers have been read yet', 'all_doa': 'All Prayers', 'bookmarked': 'Bookmarked', 'Imsak': 'Imsak', 'Fajr': 'Fajr', 'Sunrise': 'Sunrise', 'Dhuhr': 'Dhuhr', 'Asr': 'Asr', 'Maghrib': 'Maghrib', 'Isha': 'Isha' },
        'ar': { 'nav_title': 'قائمة التنقل', 'nav_doa': '🤲 أدعية يومية', 'nav_quran': '📖 القرآن الكريم', 'nav_dzikir': '📿 ذكر وتسبيح', 'nav_kiblat': '🧭 القبلة', 'nav_settings': '⚙️ الإعدادات', 'remaining_time': 'الوقت المتبقي', 'settings_title': 'الإعدادات', 'settings_dark_mode': 'الوضع الداكن', 'settings_notifications': 'إشعارات الأذان', 'settings_language': 'اللغة', 'settings_about': 'حول التطبيق', 'settings_adhan_sound': 'إعدادات صوت الأذان', 'last_read': 'آخر ما قرئ', 'no_last_read': 'لم يتم قراءة أي دعاء بعد', 'all_doa': 'كل الأدعية', 'bookmarked': 'المحفوظة', 'Imsak': 'إمساك', 'Fajr': 'الفجر', 'Sunrise': 'الشروق', 'Dhuhr': 'الظهر', 'Asr': 'العصر', 'Maghrib': 'المغرب', 'Isha': 'العشاء' },
        'tr': { 'nav_title': 'Navigasyon Menüsü', 'nav_doa': '🤲 Günlük Dualar', 'nav_quran': '📖 Kur\'an-ı Kerim', 'nav_dzikir': '📿 Zikir & Tesbih', 'nav_kiblat': '🧭 Kıble', 'nav_settings': '⚙️ Ayarlar', 'remaining_time': 'Kalan Süre', 'settings_title': 'Ayarlar', 'settings_dark_mode': 'Karanlık Mod', 'settings_notifications': 'Ezan Bildirimleri', 'settings_language': 'Dil', 'settings_about': 'Uygulama Hakkında', 'settings_adhan_sound': 'Ezan Sesi Ayarları', 'last_read': 'SON OKUNAN', 'no_last_read': 'Henüz okunmuş dua yok', 'all_doa': 'Tüm Dualar', 'bookmarked': 'İşaretli', 'Imsak': 'İmsak', 'Fajr': 'Sabah', 'Sunrise': 'Güneş', 'Dhuhr': 'Öğle', 'Asr': 'İkindi', 'Maghrib': 'Akşam', 'Isha': 'Yatsı' },
        'fr': { 'nav_title': 'Menu de navigation', 'nav_doa': '🤲 Prières quotidiennes', 'nav_quran': '📖 Al-Coran', 'nav_dzikir': '📿 Dhikr & Tasbih', 'nav_kiblat': '🧭 Qibla', 'nav_settings': '⚙️ Paramètres', 'remaining_time': 'Temps restant', 'settings_title': 'Paramètres', 'settings_dark_mode': 'Mode sombre', 'settings_notifications': 'Notifications d\'Adhan', 'settings_language': 'Langue', 'settings_about': 'À propos de l\'application', 'settings_adhan_sound': 'Paramètres Sonores de l\'Adhan', 'last_read': 'DERNIÈRE LECTURE', 'no_last_read': 'Aucune prière n\'a encore été lue', 'all_doa': 'Toutes les prières', 'bookmarked': 'Marqué', 'Imsak': 'Imsak', 'Fajr': 'Fajr', 'Sunrise': 'Lever du soleil', 'Dhuhr': 'Dhuhr', 'Asr': 'Asr', 'Maghrib': 'Maghrib', 'Isha': 'Isha' },
        'es': { 'nav_title': 'Menú de Navegación', 'nav_doa': '🤲 Oraciones Diarias', 'nav_quran': '📖 Al-Corán', 'nav_dzikir': '📿 Dhikr y Tasbih', 'nav_kiblat': '🧭 Quibla', 'nav_settings': '⚙️ Ajustes', 'remaining_time': 'Tiempo restante', 'settings_title': 'Ajustes', 'settings_dark_mode': 'Modo Oscuro', 'settings_notifications': 'Notificaciones de Adhan', 'settings_language': 'Idioma', 'settings_about': 'Acerca de la App', 'settings_adhan_sound': 'Ajustes de Sonido del Adhan', 'last_read': 'ÚLTIMA LECTURA', 'no_last_read': 'Aún no se han leído oraciones', 'all_doa': 'Todas las Oraciones', 'bookmarked': 'Marcado', 'Imsak': 'Imsak', 'Fajr': 'Fajr', 'Sunrise': 'Amanecer', 'Dhuhr': 'Dhuhr', 'Asr': 'Asr', 'Maghrib': 'Maghrib', 'Isha': 'Isha' },
        'de': { 'nav_title': 'Navigationsmenü', 'nav_doa': '🤲 Tägliche Gebete', 'nav_quran': '📖 Al-Quran', 'nav_dzikir': '📿 Dhikr & Tasbih', 'nav_kiblat': '🧭 Qibla', 'nav_settings': '⚙️ Einstellungen', 'remaining_time': 'Verbleibende Zeit', 'settings_title': 'Einstellungen', 'settings_dark_mode': 'Dunkelmodus', 'settings_notifications': 'Adhan-Benachrichtigungen', 'settings_language': 'Sprache', 'settings_about': 'Über die App', 'settings_adhan_sound': 'Adhan-Toneinstellungen', 'last_read': 'ZULETZT GELESEN', 'no_last_read': 'Noch keine Gebete gelesen', 'all_doa': 'Alle Gebete', 'bookmarked': 'Gemerkt', 'Imsak': 'Imsak', 'Fajr': 'Fajr', 'Sunrise': 'Sonnenaufgang', 'Dhuhr': 'Dhuhr', 'Asr': 'Asr', 'Maghrib': 'Maghrib', 'Isha': 'Isha' },
        'ru': { 'nav_title': 'Навигационное меню', 'nav_doa': '🤲 Ежедневные молитвы', 'nav_quran': '📖 Аль-Коран', 'nav_dzikir': '📿 Зикр и Тасбих', 'nav_kiblat': '🧭 Кибла', 'nav_settings': '⚙️ Настройки', 'remaining_time': 'Оставшееся время', 'settings_title': 'Настройки', 'settings_dark_mode': 'Темный режим', 'settings_notifications': 'Уведомления о Азане', 'settings_language': 'Язык', 'settings_about': 'О приложении', 'settings_adhan_sound': 'Настройки звука Азана', 'last_read': 'ПОСЛЕДНЕЕ ПРОЧТЕНИЕ', 'no_last_read': 'Молитвы еще не читались', 'all_doa': 'Все молитвы', 'bookmarked': 'В закладках', 'Imsak': 'Имсак', 'Фаджр': 'Fajr', 'Восход': 'Sunrise', 'Зухр': 'Dhuhr', 'Аср': 'Asr', 'Магриб': 'Maghrib', 'Иша': 'Isha' },
        'ur': { 'nav_title': 'نیویگیشن مینو', 'nav_doa': '🤲 روزانہ کی دعائیں', 'nav_quran': '📖 القرآن', 'nav_dzikir': '📿 ذکر و تسبیح', 'nav_kiblat': '🧭 قبلہ', 'nav_settings': '⚙️ ترتیبات', 'remaining_time': 'باقی وقت', 'settings_title': 'ترتیبات', 'settings_dark_mode': 'ڈارک موڈ', 'settings_notifications': 'اذان کی اطلاعات', 'settings_language': 'زبان', 'settings_about': 'ایپ کے بارے میں', 'settings_adhan_sound': 'اذان کی آواز کی ترتیبات', 'last_read': 'آخری بار پڑھا گیا', 'no_last_read': 'ابھی تک کوئی دعا نہیں پڑھی گئی', 'all_doa': 'تمام دعائیں', 'bookmarked': 'نشان زد', 'Imsak': 'امساک', 'Fajr': 'فجر', 'Sunrise': 'طلوع آفتاب', 'Dhuhr': 'ظہر', 'Asr': 'عصر', 'Maghrib': 'مغرب', 'Isha': 'عشاء' },
        'bn': { 'nav_title': 'নেভিগেশন মেনু', 'nav_doa': '🤲 দৈনিক দোয়া', 'nav_quran': '📖 আল-কুরআন', 'nav_dzikir': '📿 যিকির ও তাসবীহ', 'nav_kiblat': '🧭 কিবলা', 'nav_settings': '⚙️ সেটিংস', 'remaining_time': 'অবশিষ্ট সময়', 'settings_title': 'সেটিংস', 'dark_mode': 'ডার্ক মোড', 'notifications': 'আযানের নোটিফিকেশন', 'language': 'ভাষা', 'about_app': 'অ্যাপ সম্পর্কে', 'adhan_sound': 'আযানের শব্দ সেটিংস', 'last_read': 'শেষ পঠিত', 'no_last_read': 'এখনও কোন দোয়া পড়া হয়নি', 'all_doa': 'সব দোয়া', 'bookmarked': 'বুকমার্ক করা', 'Imsak': 'ইمسাক', 'Fajr': 'ফজর', 'Sunrise': 'সূর্যোদয়', 'Dhuhr': 'যোহর', 'Asr': 'আসর', 'Maghrib': 'মাগরিব', 'Isha': 'ঈশা' }
    };
    const juzToSurahMap = { 1: [1, 2], 2: [2], 3: [2, 3], 4: [3, 4], 5: [4], 6: [4, 5], 7: [5, 6], 8: [6, 7], 9: [7, 8], 10: [8, 9], 11: [9, 10, 11], 12: [11, 12], 13: [12, 13, 14, 15], 14: [16, 17], 15: [17, 18], 16: [18, 19, 20], 17: [21, 22], 18: [23, 24, 25], 19: [25, 26, 27], 20: [27, 28, 29], 21: [29, 30, 31, 32, 33], 22: [33, 34, 35, 36], 23: [36, 37, 38, 39], 24: [39, 40, 41], 25: [41, 42, 43, 44, 45], 26: [46, 47, 48, 49, 50, 51], 27: [51, 52, 53, 54, 55, 56, 57], 28: [58, 59, 60, 61, 62, 63, 64, 65, 66], 29: [67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77], 30: [78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114] };
    
    const quizData = [
        // Level Mudah
        { level: "mudah", question: "قُلْ هُوَ اللّٰهُ اَحَدٌۚ", options: ["اَللّٰهُ الصَّمَدُۚ", "لَمْ يَلِدْ وَلَمْ يُوْلَدْۙ", "وَلَمْ يَكُنْ لَّهٗ كُفُوًا اَحَدٌ", "مِنْ شَرِّ مَا خَلَقَۙ"], correctAnswer: 0, surahInfo: "QS. Al-Ikhlas: 2" },
        { level: "mudah", question: "فَصَلِّ لِرَبِّكَ وَانْحَرْۗ", options: ["اِنَّآ اَعْطَيْنٰكَ الْكَوْثَرَۗ", "اِنَّ شَانِئَكَ هُوَ الْاَبْتَرُ ࣖ", "الَّذِيْ يُكَذِّبُ بِالدِّيْنِۗ", "وَلَا يَحُضُّ عَلٰى طَعَامِ الْمِسْكِيْنِۗ"], correctAnswer: 1, surahInfo: "QS. Al-Kausar: 3" },
        { level: "mudah", question: "مٰلِكِ يَوْمِ الدِّيْنِۗ", options: ["اِيَّاكَ نَعْبُدُ وَاِيَّاكَ نَسْتَعِيْنُۗ", "الرَّحْمٰنِ الرَّحِيْمِۙ", "اَلْحَمْدُ لِلّٰهِ رَبِّ الْعٰلَمِيْنَۙ", "اهْدِنَا الصِّرَاطَ الْمُسْتَقِيْمَۙ"], correctAnswer: 0, surahInfo: "QS. Al-Fatihah: 5" },
        { level: "mudah", question: "قُلْ اَعُوْذُ بِرَبِّ النَّاسِۙ", options: ["مَلِكِ النَّاسِۙ", "اِلٰهِ النَّاسِۙ", "مِنْ شَرِّ الْوَسْوَاسِ ەۙ الْخَنَّاسِۖ", "مِنَ الْجِنَّةِ وَالنَّاسِ"], correctAnswer: 0, surahInfo: "QS. An-Nas: 2" },
        { level: "mudah", question: "وَمِنْ شَرِّ غَاسِقٍ اِذَا وَقَبَۙ", options: ["وَمِنْ شَرِّ النَّفّٰثٰتِ فِى الْعُقَدِۙ", "وَمِنْ شَرِّ حَاسِدٍ اِذَا حَسَدَ", "مِنْ شَرِّ مَا خَلَقَۙ", "قُلْ اَعُوْذُ بِرَبِّ الْفَلَقِۙ"], correctAnswer: 0, surahInfo: "QS. Al-Falaq: 4" },
        { level: "mudah", question: "اِذَا جَاۤءَ نَصْرُ اللّٰهِ وَالْفَتْحُۙ", options: ["وَرَاَيْتَ النَّاسَ يَدْخُلُوْنَ فِيْ دِيْنِ اللّٰهِ اَفْوَاجًاۙ", "فَسَبِّحْ بِحَمْدِ رَبِّكَ وَاسْتَغْفِرْهُۗ اِنَّهٗ كَانَ تَوَّابًا", "لَكُمْ دِيْنُكُمْ وَلِيَ دِيْنِ", "قُلْ يٰٓاَيُّهَا الْكٰفِرُوْنَۙ"], correctAnswer: 0, surahInfo: "QS. An-Nasr: 2" },
        { level: "mudah", question: "لَكُمْ دِيْنُكُمْ وَلِيَ دِيْنِ", options: ["وَلَآ اَنَا۠ عَابِدٌ مَّا عَبَدْتُّمْۙ", "وَلَآ اَنْتُمْ عٰبِدُوْنَ مَآ اَعْبُدُۚ", "لَا يَعْبُدُ الَّذِيْنَ تَعْبُدُوْنَ", "قُلْ يَا أَيُّهَا الْكَافِرُونَ"], correctAnswer: 1, surahInfo: "QS. Al-Kafirun: 6 (Ini adalah ayat terakhir, pilihan yang paling logis adalah ayat sebelumnya)" },
        { level: "mudah", question: "اَرَءَيْتَ الَّذِيْ يُكَذِّبُ بِالدِّيْنِۗ", options: ["فَذٰلِكَ الَّذِيْ يَدُعُّ الْيَتِيْمَۙ", "وَلَا يَحُضُّ عَلٰى طَعَامِ الْمِسْكِيْنِۗ", "فَوَيْلٌ لِّلْمُصَلِّيْنَۙ", "الَّذِيْنَ هُمْ عَنْ صَلَاتِهِمْ سَاهُوْنَۙ"], correctAnswer: 0, surahInfo: "QS. Al-Ma'un: 2" },
        { level: "mudah", question: "اِنَّ الْاِنْسَانَ لَفِيْ خُسْرٍۙ", options: ["اِلَّا الَّذِيْنَ اٰمَنُوْا وَعَمِلُوا الصّٰلِحٰتِ", "وَالْعَصْرِۙ", "وَتَوَاصَوْا بِالْحَقِّ", "وَتَوَاصَوْا بِالصَّبْرِ"], correctAnswer: 0, surahInfo: "QS. Al-'Asr: 3" },
        { level: "mudah", question: "اَلْهَاكُمُ التَّكَاثُرُۙ", options: ["حَتّٰى زُرْتُمُ الْمَقَابِرَۗ", "كَلَّا سَوْفَ تَعْلَمُوْنَۙ", "ثُمَّ كَلَّا سَوْفَ تَعْلَمُوْنَ", "لَتَرَوُنَّ الْجَحِيْمَۙ"], correctAnswer: 0, surahInfo: "QS. At-Takasur: 2" },
    
        // Level Sedang
        { level: "sedang", question: "اَلَمْ تَرَ كَيْفَ فَعَلَ رَبُّكَ بِاَصْحٰبِ الْفِيْلِۗ", options: ["اَلَمْ يَجْعَلْ كَيْدَهُمْ فِيْ تَضْلِيْلٍۙ", "وَّاَرْسَلَ عَلَيْهِمْ طَيْرًا اَبَابِيْلَۙ", "تَرْمِيْهِمْ بِحِجَارَةٍ مِّنْ سِجِّيْلٍۙ", "فَجَعَلَهُمْ كَعَصْفٍ مَّأْكُوْلٍ"], correctAnswer: 0, surahInfo: "QS. Al-Fil: 2" },
        { level: "sedang", question: "وَالسَّمَاۤءِ ذَاتِ الْبُرُوْجِۙ", options: ["وَالْيَوْمِ الْمَوْعُوْدِۙ", "وَشَاهِدٍ وَّمَشْهُوْدٍۗ", "قُتِلَ اَصْحٰبُ الْاُخْدُوْدِۙ", "النَّارِ ذَاتِ الْوَقُوْدِۙ"], correctAnswer: 0, surahInfo: "QS. Al-Buruj: 2" },
        { level: "sedang", question: "اِذَا السَّمَاۤءُ انْشَقَّتْۙ", options: ["وَاَذِنَتْ لِرَبِّهَا وَحُقَّتْۙ", "وَاِذَا الْاَرْضُ مُدَّتْۙ", "وَاَلْقَتْ مَا فِيْهَا وَتَخَلَّتْۙ", "يٰٓاَيُّهَا الْاِنْسَانُ اِنَّكَ كَادِحٌ"], correctAnswer: 0, surahInfo: "QS. Al-Insyiqaq: 2" },
        { level: "sedang", question: "وَيْلٌ لِّلْمُطَفِّفِيْنَۙ", options: ["الَّذِيْنَ اِذَا اكْتَالُوْا عَلَى النَّاسِ يَسْتَوْفُوْنَۙ", "وَاِذَا كَالُوْهُمْ اَوْ وَّزَنُوْهُمْ يُخْسِرُوْنَۗ", "اَلَا يَظُنُّ اُولٰۤىِٕكَ اَنَّهُمْ مَّبْعُوْثُوْنَۙ", "لِيَوْمٍ عَظِيْمٍۙ"], correctAnswer: 0, surahInfo: "QS. Al-Mutaffifin: 2" },
        { level: "sedang", question: "اِذَا الشَّمْسُ كُوِّرَتْۖ", options: ["وَاِذَا النُّجُوْمُ انْكَدَرَتْۖ", "وَاِذَا الْجِبَالُ سُيِّرَتْۖ", "وَاِذَا الْعِشَارُ عُطِّلَتْۖ", "وَاِذَا الْوُحُوْشُ حُشِرَتْۖ"], correctAnswer: 0, surahInfo: "QS. At-Takwir: 2" },
        { level: "sedang", question: "عَبَسَ وَتَوَلّٰىٓۙ", options: ["اَنْ جَاۤءَهُ الْاَعْمٰىۗ", "وَمَا يُدْرِيْكَ لَعَلَّهٗ يَزَّكّٰىٓۙ", "اَوْ يَذَّكَّرُ فَتَنْفَعَهُ الذِّكْرٰىۗ", "اَمَّا مَنِ اسْتَغْنٰىۙ"], correctAnswer: 0, surahInfo: "QS. 'Abasa: 2" },
        { level: "sedang", question: "يَوْمَ يَقُوْمُ النَّاسُ لِرَبِّ الْعٰلَمِيْنَۗ", options: ["كَلَّآ اِنَّ كِتٰبَ الْفُجَّارِ لَفِيْ سِجِّيْنٍۗ", "لِيَوْمٍ عَظِيْمٍۙ", "وَمَا يُكَذِّبُ بِهٖٓ اِلَّا كُلُّ مُعْتَدٍ اَثِيْمٍۙ", "وَمَآ اَدْرٰىكَ مَا سِجِّيْنٌۗ"], correctAnswer: 0, surahInfo: "QS. Al-Mutaffifin: 7" },
        { level: "sedang", question: "فَاَمَّا مَنْ طَغٰىۙ", options: ["وَاٰثَرَ الْحَيٰوةَ الدُّنْيَاۙ", "فَاِنَّ الْجَحِيْمَ هِيَ الْمَأْوٰىۗ", "وَاَمَّا مَنْ خَافَ مَقَامَ رَبِّهٖ", "وَنَهَى النَّفْسَ عَنِ الْهَوٰىۙ"], correctAnswer: 0, surahInfo: "QS. An-Nazi'at: 38" },
        { level: "sedang", question: "وَالَّيْلِ اِذَا عَسْعَسَۙ", options: ["وَالصُّبْحِ اِذَا تَنَفَّسَۙ", "اِنَّهٗ لَقَوْلُ رَسُوْلٍ kَرِيْمٍۙ", "ذِيْ قُوَّةٍ عِنْدَ ذِى الْعَرْشِ مَكِيْنٍۙ", "مُّطَاعٍ ثَمَّ اَمِيْنٍۗ"], correctAnswer: 0, surahInfo: "QS. At-Takwir: 18" },
        { level: "sedang", question: "فَاِذَا جَاۤءَتِ الصَّاۤخَّةُ ۖ", options: ["يَوْمَ يَفِرُّ الْمَرْءُ مِنْ اَخِيْهِۙ", "وَاُمِّهٖ وَاَبِيْهِۙ", "وَصَاحِبَتِهٖ وَبَنِيْهِۗ", "لِكُلِّ امْرِئٍ مِّنْهُمْ يَوْمَىِٕذٍ شَأْنٌ يُّغْنِيْهِۗ"], correctAnswer: 0, surahInfo: "QS. 'Abasa: 34" },
    
        // Level Sulit (20 soal)
        { level: "sulit", question: "وَلِكُلِّ اُمَّةٍ جَعَلْنَا مَنْسَكًا لِّيَذْكُرُوا اسْمَ اللّٰهِ عَلٰى مَا رَزَقَهُمْ مِّنْۢ بَهِيْمَةِ الْاَنْعَامِۗ", options: ["فَاِلٰهُكُمْ اِلٰهٌ وَّاحِدٌ فَلَهٗٓ اَسْلِمُوْاۗ وَبَشِّرِ الْمُخْبِتِيْنَۙ", "الَّذِيْنَ اِذَا ذُكِرَ اللّٰهُ وَجِلَتْ قُلُوْبُهُمْ", "وَالصَّابِرِيْنَ عَلٰى مَآ اَصَابَهُمْ", "وَالْمُقِيْمِى الصَّلٰوةِ وَمِمَّا رَزَقْنٰهُمْ يُنْفِقُوْنَ"], correctAnswer: 0, surahInfo: "QS. Al-Hajj: 34" },
        { level: "sulit", question: "اِنَّ اللّٰهَ يُدْخِلُ الَّذِيْنَ اٰمَنُوْا وَعَمِلُوا الصّٰلِحٰتِ جَنّٰتٍ تَجْرِيْ مِنْ تَحْتِهَا الْاَنْهٰرُ", options: ["يُحَلَّوْنَ فِيْهَا مِنْ اَسَاوِرَ مِنْ ذَهَبٍ وَّلُؤْلُؤًاۗ وَلِبَاسُهُمْ فِيْهَا حَرِيْرٌ", "وَهُدُوٓا اِلَى الطَّيِّبِ مِنَ الْقَوْلِۙ", "وَهُدُوٓا اِلٰى صِرَاطِ الْحَمِيْدِ", "اِنَّ الَّذِيْنَ كَفَرُوْا وَيَصُدُّوْنَ عَنْ sَبِيْلِ اللّٰهِ"], correctAnswer: 0, surahInfo: "QS. Al-Hajj: 23" },
        { level: "sulit", question: "يٰٓاَيُّهَا الَّذِيْنَ اٰمَنُوْا لَا تَتَّخِذُوا الْيَهُوْدَ وَالنَّصٰرٰٓى اَوْلِيَاۤءَۘ", options: ["بَعْضُهُمْ اَوْلِيَاۤءُ بَعْضٍۗ", "وَمَنْ يَّتَوَلَّهُمْ مِّنْكُمْ فَاِنَّهٗ مِنْهُمْۗ", "اِنَّ اللّٰهَ لَا يَهْدِى الْقَوْمَ الظّٰلِمِيْنَ", "فَتَرَى الَّذِيْنَ فِيْ قُلُوْبِهِمْ مَّرَضٌ"], correctAnswer: 0, surahInfo: "QS. Al-Ma'idah: 51" },
        { level: "sulit", question: "وَمَا كَانَ لِمُؤْمِنٍ اَنْ يَّقْتُلَ مُؤْمِنًا اِلَّا خَطَـًٔاۚ", options: ["وَمَنْ قَتَلَ مُؤْمِنًا خَطَـًٔا فَتَحْرِيْرُ رَقَبَةٍ مُّؤْمِنَةٍ", "وَدِيَةٌ مُّسَلَّمَةٌ اِلٰٓى اَهْلِهٖٓ", "اِلَّآ اَنْ يَّصَّدَّقُوْاۗ", "فَاِنْ كَانَ مِنْ قَوْمٍ عَدُوٍّ لَّكُمْ"], correctAnswer: 0, surahInfo: "QS. An-Nisa: 92" },
        { level: "sulit", question: "فَاِذَا قَضَيْتُمُ الصَّلٰوةَ فَاذْكُرُوا اللّٰهَ قِيَامًا وَّقُعُوْدًا وَّعَلٰى جُنُوْبِكُمْۚ", options: ["فَاِذَا اطْمَأْنَنْتُمْ فَاَقِيْمُوا الصَّلٰوةَۚ", "اِنَّ الصَّلٰوةَ كَانَتْ عَلَى الْمُؤْمِنِيْنَ كِتٰبًا مَّوْقُوْتًا", "وَلَا تَهِنُوْا فِى ابْتِغَاۤءِ الْقَوْمِۗ", "اِنْ تَكُوْنُوْا تَأْلَمُوْنَ فَاِنَّهُمْ يَأْلَمُوْنَ"], correctAnswer: 0, surahInfo: "QS. An-Nisa: 103" },
        { level: "sulit", question: "وَلَا تَسُبُّوا الَّذِيْنَ يَدْعُوْنَ مِنْ دُوْنِ اللّٰهِ فَيَسُبُّوا اللّٰهَ عَدْوًاۢ بِغَيْرِ عِلْمٍۗ", options: ["كَذٰلِكَ زَيَّنَّا لِكُلِّ اُمَّةٍ عَمَلَهُمْ", "ثُمَّ اِلٰى رَبِّهِمْ مَّرْجِعُهُمْ", "فَيُنَبِّئُهُمْ بِمَا كَانُوْا يَعْمَلُوْنَ", "وَاَقْسَمُوْا بِاللّٰهِ جَهْدَ اَيْمَانِهِمْ"], correctAnswer: 0, surahInfo: "QS. Al-An'am: 108" },
        { level: "sulit", question: "يَسْـَٔلُوْنَكَ عَنِ الْاَنْفَالِۗ قُلِ الْاَنْفَالُ لِلّٰهِ وَالرَّسُوْلِۚ", options: ["فَاتَّقُوا اللّٰهَ وَاَصْلِحُوْا ذَاتَ بَيْنِكُمْۚ", "وَاَطِيْعُوا اللّٰهَ وَرَسُوْلَهٗٓ اِنْ كُنْتُمْ مُّؤْمِنِيْنَ", "اِنَّمَا الْمُؤْمِنُوْنَ الَّذِيْنَ اِذَا ذُكِرَ اللّٰهُ وَجِلَتْ قُلُوْبُهُمْ", "وَاِذَا تُلِيَتْ عَلَيْهِمْ اٰيٰتُهٗ زَادَتْهُمْ اِيْمَانًا"], correctAnswer: 0, surahInfo: "QS. Al-Anfal: 1" },
        { level: "sulit", question: "يٰٓاَيُّهَا الَّذِيْنَ اٰمَنُوا اسْتَجِيْبُوْا لِلّٰهِ وَلِلرَّسُوْلِ اِذَا دَعَاكُمْ لِمَا يُحْيِيْكُمْۚ", options: ["وَاعْلَمُوْٓا اَنَّ اللّٰهَ يَحُوْلُ بَيْنَ الْمَرْءِ وَقَلْبِهٖ", "وَاَنَّهٗٓ اِلَيْهِ تُحْشَرُوْنَ", "وَاتَّقُوْا فِتْنَةً لَّا تُصِيْبَنَّ الَّذِيْنَ ظَلَمُوْا مِنْكُمْ خَاۤصَّةًۚ", "وَاعْلَمُوْٓا اَنَّ اللّٰهَ شَدِيْدُ الْعِقَابِ"], correctAnswer: 0, surahInfo: "QS. Al-Anfal: 24" },
        { level: "sulit", question: "وَقَاتِلُوْهُمْ حَتّٰى لَا تَكُوْنَ فِتْنَةٌ وَّيَكُوْنَ الدِّيْنُ كُلُّهٗ لِلّٰهِۚ", options: ["فَاِنِ انْتَهَوْا فَاِنَّ اللّٰهَ بِمَا يَعْمَلُوْنَ بَصِيْرٌ", "وَاِنْ تَوَلَّوْا فَاعْلَمُوْٓا اَنَّ اللّٰهَ مَوْلٰىكُمْۗ", "نِعْمَ الْمَوْلٰى وَنِعْمَ النَّصِيْرُ", "وَاعْلَمُوْٓا اَنَّمَا غَنِمْتُمْ مِّنْ شَيْءٍ"], correctAnswer: 0, surahInfo: "QS. Al-Anfal: 39" },
        { level: "sulit", question: "اِنَّ عِدَّةَ الشُّهُوْرِ عِنْدَ اللّٰهِ اثْنَا عَشَرَ شَهْرًا فِيْ كِتٰبِ اللّٰهِ", options: ["يَوْمَ خَلَقَ السَّمٰوٰتِ وَالْاَرْضَ مِنْهَآ اَرْبَعَةٌ حُرُمٌۗ", "ذٰلِكَ الدِّيْنُ الْقَيِّمُ ەۙ", "فَلَا تَظْلِمُوْا فِيْهِنَّ اَنْفُسَكُمْ", "وَقَاتِلُوا الْمُشْرِكِيْنَ كَاۤفَّةً"], correctAnswer: 0, surahInfo: "QS. At-Taubah: 36" },
        { level: "sulit", question: "خُذْ مِنْ اَمْوَالِهِمْ صَدَقَةً تُطَهِّرُهُمْ وَتُزَكِّيْهِمْ بِهَا", options: ["وَصَلِّ عَلَيْهِمْۗ اِنَّ صَلٰوتَكَ سَكَنٌ لَّهُمْۗ", "وَاللّٰهُ سَمِيْعٌ عَلِيْمٌ", "اَلَمْ يَعْلَمُوْٓا اَنَّ اللّٰهَ هُوَ يَقْبَلُ التَّوْبَةَ عَنْ عِبَادِهٖ", "وَيَأْخُذُ الصَّدَقٰتِ"], correctAnswer: 0, surahInfo: "QS. At-Taubah: 103" },
        { level: "sulit", question: "لَقَدْ جَاۤءَكُمْ رَسُوْلٌ مِّنْ اَنْفُسِكُمْ عَزِيْزٌ عَلَيْهِ مَا عَنِتُّمْ", options: ["حَرِيْصٌ عَلَيْكُمْ بِالْمُؤْمِنِيْنَ رَءُوْفٌ رَّحِيْمٌ", "فَاِنْ تَوَلَّوْا فَقُلْ حَسْبِيَ اللّٰهُ", "لَآ اِلٰهَ اِلَّا هُوَۗ عَلَيْهِ تَوَكَّلْتُ", "وَهُوَ رَبُّ الْعَرْشِ الْعَظِيْمِ"], correctAnswer: 0, surahInfo: "QS. At-Taubah: 128" },
        { level: "sulit", question: "وَلَوْ اَنَّ اَهْلَ الْقُرٰٓى اٰمَنُوْا وَاتَّقَوْا لَفَتَحْنَا عَلَيْهِمْ بَرَكٰتٍ مِّنَ السَّمَاۤءِ وَالْاَرْضِ", options: ["وَلٰكِنْ كَذَّبُوْا فَاَخَذْنٰهُمْ بِمَا كَانُوْا يَكْسِبُوْنَ", "اَفَاَمِنَ اَهْلُ الْقُرٰٓى اَنْ يَّأْتِيَهُمْ بَأْسُنَا بَيَاتًا وَّهُمْ نَاۤىِٕمُوْنَۗ", "اَوَاَمِنَ اَهْلُ الْقُرٰٓى اَنْ يَّأْتِيَهُمْ بَأْسُنَا ضُحًى وَّهُمْ يَلْعَبُوْنَ", "اَفَاَمِنُوْا مَكْرَ اللّٰهِۚ"], correctAnswer: 0, surahInfo: "QS. Al-A'raf: 96" },
        { level: "sulit", question: "وَاِذْ تَاَذَّنَ رَبُّكَ لَيَبْعَثَنَّ عَلَيْهِمْ اِلٰى يَوْمِ الْقِيٰمَةِ", options: ["مَنْ يَّسُوْمُهُمْ سُوْۤءَ الْعَذَابِۗ", "اِنَّ رَبَّكَ لَسَرِيْعُ الْعِقَابِۖ", "وَاِنَّهٗ لَغَفُوْرٌ رَّحِيْمٌ", "وَقَطَّعْنٰهُمْ فِى الْاَرْضِ اُمَمًاۚ"], correctAnswer: 0, surahInfo: "QS. Al-A'raf: 167" },
        { level: "sulit", question: "فَلَمَّا نَسُوْا مَا ذُكِّرُوْا بِهٖٓ اَنْجَيْنَا الَّذِيْنَ يَنْهَوْنَ عَنِ السُّوْۤءِ", options: ["وَاَخَذْنَا الَّذِيْنَ ظَلَمُوْا بِعَذَابٍۢ بَـِٔيْسٍۢ بِمَا كَانُوْا يَفْسُقُوْنَ", "فَلَمَّا عَتَوْا عَنْ مَّا نُهُوْا عَنْهُ", "قُلْنَا لَهُمْ كُوْنُوْا قِرَدَةً خَاسِـِٕيْنَ", "وَإِذْ تَأَذَّنَ رَبُّكَ"], correctAnswer: 0, surahInfo: "QS. Al-A'raf: 165" },
        { level: "sulit", question: "وَمَنْ اَظْلَمُ مِمَّنِ افْتَرٰى عَلَى اللّٰهِ كَذِبًا اَوْ كَذَّبَ بِاٰيٰتِهٖۗ", options: ["اِنَّهٗ لَا يُفْلِحُ الظّٰلِمُوْنَ", "وَيَوْمَ نَحْشُرُهُمْ جَمِيْعًا", "ثُمَّ نَقُوْلُ لِلَّذِيْنَ اَشْرَكُوْٓا اَيْنَ شُرَكَاۤؤُكُمُ", "الَّذِيْنَ كُنْتُمْ تَزْعُمُوْنَ"], correctAnswer: 0, surahInfo: "QS. Al-An'am: 21" },
        { level: "sulit", question: "اَللّٰهُ نُوْرُ السَّمٰوٰتِ وَالْاَرْضِۗ مَثَلُ نُوْرِهٖ كَمِشْكٰوةٍ فِيْهَا مِصْبَاحٌۗ", options: ["اَلْمِصْبَاحُ فِيْ زُجَاجَةٍۗ", "اَلزُّجَاجَةُ كَاَنَّهَا كَوْكَبٌ دُرِّيٌّ", "يُّوْقَدُ مِنْ شَجَرَةٍ مُّبٰرَكَةٍ زَيْتُوْنَةٍ", "لَّا شَرْقِيَّةٍ وَّلَا غَرْبِيَّةٍۙ"], correctAnswer: 0, surahInfo: "QS. An-Nur: 35" },
        { level: "sulit", question: "فِيْ بُيُوْتٍ اَذِنَ اللّٰهُ اَنْ تُرْفَعَ وَيُذْكَرَ فِيْهَا اسْمُهٗۙ", options: ["يُسَبِّحُ لَهٗ فِيْهَا بِالْغُدُوِّ وَالْاٰصَالِۙ", "رِجَالٌ لَّا تُلْهِيْهِمْ تِجَارَةٌ وَّلَا بَيْعٌ عَنْ ذِكْرِ اللّٰهِ", "وَاِقَامِ الصَّلٰوةِ وَاِيْتَاۤءِ الزَكٰوةِۙ", "يَخَافُوْنَ يَوْمًا تَتَقَلَّبُ فِيْهِ الْقُلُوْبُ وَالْاَبْصَارُۙ"], correctAnswer: 0, surahInfo: "QS. An-Nur: 36" },
        { level: "sulit", question: "وَاَوْفُوْا بِعَهْدِ اللّٰهِ اِذَا عَاهَدْتُّمْ", options: ["وَلَا تَنْقُضُوا الْاَيْمَانَ بَعْدَ تَوْكِيْدِهَا", "وَقَدْ جَعَلْتُمُ اللّٰهَ عَلَيْكُمْ كَفِيْلًاۗ", "اِنَّ اللّٰهَ يَعْلَمُ مَا تَفْعَلُوْنَ", "وَلَا تَكُوْنُوْا كَالَّتِيْ نَقَضَتْ غَزْلَهَا"], correctAnswer: 0, surahInfo: "QS. An-Nahl: 91" },
        { level: "sulit", question: "اِنَّمَا حَرَّمَ عَلَيْكُمُ الْمَيْتَةَ وَالدَّمَ وَلَحْمَ الْخِنْزِيْرِ", options: ["وَمَآ اُهِلَّ لِغَيْرِ اللّٰهِ بِهٖۚ", "فَمَنِ اضْطُرَّ غَيْرَ بَاغٍ وَّلَا عَادٍ", "فَاِنَّ اللّٰهَ غَفُوْرٌ رَّحِيْمٌ", "وَلَا تَقُوْلُوْا لِمَا تَصِفُ اَلْسِنَتُكُمُ الْكَذِبَ"], correctAnswer: 0, surahInfo: "QS. An-Nahl: 115" }
    ];
    
// [MODIFIKASI] Data untuk Toko Tema diubah agar lebih lengkap
const themes = [
    // Tema sebelumnya...
    { id: 'default', name: 'Standar', price: 0, colors: ['#0d264a', '#f0f4f8', '#f9d788', '#ffffff'] },
    { id: 'forest', name: 'Hutan Senja', price: 200, colors: ['#2d5a2d', '#f0fff0', '#ffcf40', '#ffffff'] },
    { id: 'ocean', name: 'Biru Samudra', price: 250, colors: ['#1e3a5f', '#e6f7ff', '#6ab0de', '#fcfcfc'] },
    { id: 'royal', name: 'Ungu Royal', price: 300, colors: ['#4c2a85', '#f3e5f5', '#d1c4e9', '#ffffff'] },
    { id: 'desert', name: 'Gurun Emas', price: 350, colors: ['#8c5a2b', '#fff8e1', '#ffc107', '#fffdf7'] },

    // Tema modern
    { id: 'midnight', name: 'Midnight Glow', price: 400, colors: ['#0f0f1a', '#1a1a2e', '#ff4081', '#2e2e3a'] },
    { id: 'sunset', name: 'Senja Cerah', price: 420, colors: ['#ff5e62', '#ffe7d1', '#ff9a8b', '#fff2ec'] },
    { id: 'aqua', name: 'Aqua Mint', price: 380, colors: ['#00bfa6', '#e0f7f4', '#66d9cc', '#ffffff'] },
    { id: 'blossom', name: 'Bunga Sakura', price: 390, colors: ['#f8bbd0', '#fff0f6', '#f06292', '#ffffff'] },
    { id: 'tech', name: 'Cyber Neon', price: 450, colors: ['#000000', '#121212', '#00ffff', '#1e1e1e'] },

    // Modern klasik
    { id: 'classicblue', name: 'Biru Klasik', price: 500, colors: ['#002147', '#e3eaf2', '#6c91bf', '#ffffff'] },
    { id: 'vintagegold', name: 'Emas Vintage', price: 750, colors: ['#3e2c00', '#fff8e5', '#d4af37', '#fbf6e8'] },
    { id: 'rosewood', name: 'Rosewood', price: 1000, colors: ['#65000b', '#f9f2f2', '#b76e79', '#fff8f8'] },
    { id: 'imperial', name: 'Imperial Elegance', price: 2000, colors: ['#2c2a4a', '#f6f6f6', '#d4a373', '#ffffff'] },
    { id: 'onyxbronze', name: 'Onyx Bronze', price: 3000, colors: ['#1c1c1c', '#f5f5f5', '#cd7f32', '#f9f9f9'] },

    // 🕌 Tema Islami
    { id: 'nabawi_green', name: 'Hijau Nabawi', price: 550, colors: ['#014421', '#f5f5dc', '#d4af37', '#ffffff'] },
    { id: 'mecca_twilight', name: 'Senja di Mekkah', price: 850, colors: ['#2c2a4a', '#ead1dc', '#c0c0c0', '#f5f5f5'] },
    { id: 'islamic_geometry', name: 'Geometri Islami', price: 900, colors: ['#008080', '#f5f5dc', '#daa520', '#ffffff'] },
    { id: 'ramadan_lantern', name: 'Lentera Ramadan', price: 1200, colors: ['#8b4513', '#fffacd', '#ffbf00', '#fafafa'] },
    { id: 'kaaba_gold', name: 'Kiswah Ka\'bah', price: 3500, colors: ['#000000', '#1c1c1c', '#b8860b', '#f0f0f0'] },
    
    // 🌐 Tema Masa Depan
    { id: 'neoncore', name: 'Neon Core', price: 5000, colors: ['#0a0a0a', '#121212', '#ff00ff', '#222222'] },
    { id: 'quantum', name: 'Quantum Pulse', price: 10000, colors: ['#1a0033', '#330066', '#66ffcc', '#1e0033'] },
    { id: 'hologram', name: 'Hologram Light', price: 15000, colors: ['#ffffff', '#f0f0ff', '#cc99ff', '#e6e6ff'] },
    { id: 'ultrachrome', name: 'Ultra Chrome', price: 18000, colors: ['#101010', '#202020', '#00e6e6', '#1c1c1c'] },
    { id: 'hypernova', name: 'Hypernova', price: 20000, colors: ['#14002e', '#1f003f', '#ff5ef7', '#250045'] }
    
];

const motivationData = [
    { id: 1, text: "Kesabaran itu ada dua macam: sabar atas sesuatu yang tidak kau ingin dan sabar menahan diri dari sesuatu yang kau ingini.", author: "Ali bin Abi Thalib", category: "Sabar", featured: true },
    { id: 2, text: "Jangan berduka. Apa pun yang hilang darimu akan kembali lagi dalam wujud lain.", author: "Jalaluddin Rumi", category: "Sabar" },
    { id: 3, "text": "Bersyukurlah, karena rasa syukur akan menambah nikmat yang telah ada dan membuka pintu nikmat yang belum datang.", "author": "Imam Al-Ghazali", "category": "Syukur", "featured": true },
    { id: 4, "text": "Barangsiapa tidak mensyukuri yang sedikit, maka ia tidak akan mampu mensyukuri yang banyak.", "author": "HR. Ahmad", "category": "Syukur" },
    { id: 5, "text": "Bekerjalah untuk duniamu seakan-akan engkau akan hidup selamanya. Dan beramallah untuk akhiratmu seakan-akan engkau akan mati besok.", "author": "Hadits", "category": "Semangat", "featured": true },
    { id: 6, "text": "Kegagalan adalah cara Allah untuk mengatakan 'Bersabarlah, Aku memiliki sesuatu yang lebih baik untukmu'.", "author": "Kutipan Islami", "category": "Sabar" },
    { id: 7, "text": "Hiduplah seperti pohon kayu yang lebat buahnya; hidup di tepi jalan dan dilempari dengan batu, tetapi membalas dengan buah.", "author": "Abu Bakar As-Siddiq", "category": "Sabar" },
    { id: 8, "text": "Dunia ini ibarat bayangan. Kalau kau coba menangkapnya, ia akan lari. Tapi kalau kau membelakanginya, ia tak punya pilihan selain mengikutimu.", "author": "Ibnu Qayyim Al-Jauziyyah", "category": "Semangat" },
    { id: 9, "text": "Jika kamu tidak dapat menahan lelahnya belajar, maka kamu harus sanggup menahan perihnya kebodohan.", "author": "Imam Syafi'i", "category": "Semangat" },
    { id: 10, "text": "Orang yang paling aku sukai adalah dia yang menunjukkan kesalahanku.", "author": "Umar bin Khattab", "category": "Semangat" },
    { id: 11, "text": "Cukuplah Allah sebagai penolong kami, dan Allah adalah sebaik-baik pelindung.", "author": "QS. Ali 'Imran: 173", "category": "Syukur" },
    { id: 12, "text": "Dan sedikit sekali dari hamba-hamba-Ku yang bersyukur.", "author": "QS. Saba': 13", "category": "Syukur" },
    { id: 13, "text": "Maka sesungguhnya beserta kesulitan ada kemudahan.", "author": "QS. Al-Insyirah: 5", "category": "Sabar", "featured": true },
    { id: 14, "text": "Balaslah keburukan dengan kebaikan.", "author": "Kutipan Islami", "category": "Sabar" },
    { id: 15, "text": "Janganlah kamu berputus asa dari rahmat Allah.", "author": "QS. Az-Zumar: 53", "category": "Semangat", "featured": true }
];

const sahabatAnnurData = [
    // Data Asli yang Dipertahankan dan Diperbarui
    {
        keywords: ["rukun", "islam"],
        question: "Apa saja rukun Islam?",
        answer: "Rukun Islam ada lima: 1. Mengucap dua kalimat syahadat, 2. Mendirikan shalat, 3. Menunaikan zakat, 4. Berpuasa di bulan Ramadhan, dan 5. Menunaikan haji bagi yang mampu."
    },
    {
        keywords: ["rukun", "iman"],
        question: "Apa saja rukun Iman?",
        answer: "Rukun Iman ada enam: 1. Iman kepada Allah, 2. Iman kepada Malaikat, 3. Iman kepada Kitab-kitab Allah, 4. Iman kepada Rasul, 5. Iman kepada Hari Kiamat, dan 6. Iman kepada Qada dan Qadar (takdir)."
    },
    {
        keywords: ["arti", "salat", "sholat"],
        question: "Apa arti Salat?",
        answer: "Secara bahasa, salat berarti doa. Secara istilah, salat adalah serangkaian ucapan dan perbuatan tertentu yang dimulai dengan takbiratul ihram dan diakhiri dengan salam, dengan syarat-syarat tertentu."
    },
    {
        keywords: ["berapa", "kali", "salat", "sholat", "sehari"],
        question: "Berapa kali umat Islam salat dalam sehari?",
        answer: "Umat Islam diwajibkan shalat fardu lima kali dalam sehari: Subuh, Dzuhur, Ashar, Maghrib, dan Isya."
    },
    {
        keywords: ["siapa", "nabi", "muhammad"],
        question: "Siapakah Nabi Muhammad SAW?",
        answer: "Nabi Muhammad SAW adalah nabi dan rasul terakhir yang diutus oleh Allah SWT untuk seluruh umat manusia. Beliau menerima wahyu Al-Qur'an dan menjadi teladan utama bagi umat Islam."
    },
    {
        keywords: ["quran", "al-quran", "apa", "itu"],
        question: "Apa itu Al-Qur’an?",
        answer: "Al-Qur’an adalah kitab suci umat Islam yang berisi firman Allah, diturunkan dalam bahasa Arab kepada Nabi Muhammad ﷺ sebagai petunjuk hidup bagi seluruh manusia."
    },
    {
        keywords: ["wudhu", "wudu", "apa", "itu"],
        question: "Apa itu Wudhu?",
        answer: "Wudhu adalah cara bersuci dari hadas kecil dengan membasuh bagian-bagian tubuh tertentu menggunakan air suci dan menyucikan sebelum melaksanakan ibadah seperti salat."
    },
    {
        keywords: ["batal", "wudhu", "membatalkan", "wudu"],
        question: "Apa saja yang membatalkan wudhu?",
        answer: "Beberapa hal yang dapat membatalkan wudhu antara lain: keluarnya sesuatu dari dua jalan (qubul dan dubur), hilang akal (karena tidur nyenyak, pingsan, atau gila), dan bersentuhan kulit antara laki-laki dan perempuan yang bukan mahram."
    },
    {
        keywords: ["halal", "haram", "apa", "itu"],
        question: "Apa itu Halal dan Haram?",
        answer: "Halal adalah segala sesuatu yang diizinkan oleh syariat Islam untuk dikonsumsi atau dilakukan. Haram adalah segala sesuatu yang dilarang keras oleh syariat Islam."
    },
    {
        keywords: ["bulan", "suci", "islam", "ramadan"],
        question: "Bulan apa yang dianggap suci oleh umat Islam?",
        answer: "Bulan Ramadan adalah bulan yang paling suci dalam kalender Islam. Di bulan ini, umat Islam diwajibkan berpuasa dan Al-Qur'an pertama kali diturunkan."
    },
    {
        keywords: ["idul", "fitri", "lebaran", "apa"],
        question: "Apa itu Idul Fitri?",
        answer: "Idul Fitri atau Lebaran adalah hari raya umat Islam yang jatuh pada tanggal 1 Syawal. Hari ini menandai berakhirnya bulan puasa Ramadan dan dirayakan dengan salat Ied serta silaturahmi."
    },
    {
        keywords: ["idul", "adha", "kurban", "apa"],
        question: "Apa itu Idul Adha?",
        answer: "Idul Adha adalah hari raya umat Islam yang diperingati setiap tanggal 10 Dzulhijjah. Hari ini dikenal juga sebagai Hari Raya Kurban, di mana umat Islam yang mampu disunahkan untuk menyembelih hewan kurban."
    },
    {
        keywords: ["khulafaur", "rasyidin", "siapa"],
        question: "Siapa saja Khulafaur Rasyidin?",
        answer: "Khulafaur Rasyidin adalah empat sahabat Nabi yang menjadi pemimpin setelah beliau wafat. Mereka adalah: 1. Abu Bakar Ash-Shiddiq, 2. Umar bin Khattab, 3. Utsman bin Affan, 4. Ali bin Abi Thalib."
    },
    {
        keywords: ["beda", "sunnah", "fardhu", "wajib"],
        question: "Apa beda Sunnah dan Fardhu?",
        answer: "Fardhu (atau Wajib) adalah amalan yang harus dikerjakan dan akan mendapat dosa jika ditinggalkan. Sunnah adalah amalan yang dianjurkan untuk dikerjakan; akan mendapat pahala jika dikerjakan, namun tidak berdosa jika ditinggalkan."
    },
    {
        keywords: ["kiblat", "arah", "mana"],
        question: "Ke arah mana kiblat umat Islam?",
        answer: "Kiblat umat Islam adalah ke arah Ka'bah yang berada di Masjidil Haram, kota Mekkah."
    },
    {
        keywords: ["syahadat", "syahadatain", "apa", "itu"],
        question: "Apa itu Syahadat?",
        answer: "Syahadat adalah persaksian dan pengakuan dasar dalam Islam yang berbunyi 'Asyhadu an laa ilaaha illallaah, wa asyhadu anna Muhammadan rasuulullaah', artinya 'Aku bersaksi bahwa tiada Tuhan selain Allah, dan aku bersaksi bahwa Muhammad adalah utusan Allah'."
    },
    // ✅ Percakapan Dasar
    {
        keywords: ["assalamualaikum", "assalamu'alaikum", "salam", "halo", "hai", "selamat pagi", "selamat siang", "selamat sore", "selamat malam"],
        question: "Sapaan atau salam pembuka",
        answer: "Wa'alaikumussalam warahmatullahi wabarakatuh. Ada yang bisa saya bantu terkait pertanyaan seputar Islam?"
    },
    {
        keywords: ["terima kasih", "makasih", "syukron", "terimakasih", "thanks"],
        question: "Ucapan terima kasih",
        answer: "Sama-sama. Senang bisa membantu. Jika ada pertanyaan lain, jangan ragu untuk bertanya ya."
    },
    // ✅ Keimanan dan Aqidah
    {
        keywords: ["islam", "apa", "itu", "agama", "arti"],
        question: "Apa itu Islam?",
        answer: "Islam adalah agama yang diturunkan oleh Allah kepada Nabi Muhammad ﷺ sebagai petunjuk hidup yang sempurna. Islam berarti kedamaian dan berserah diri kepada Allah."
    },
    {
        keywords: ["siapa", "allah", "tuhan"],
        question: "Siapa itu Allah?",
        answer: "Allah adalah Tuhan Yang Maha Esa, Pencipta alam semesta, dan hanya kepada-Nya semua makhluk bergantung. Dia tidak beranak dan tidak diperanakkan."
    },
    {
        keywords: ["iman", "takdir", "qada", "qadar", "arti"],
        question: "Apa arti iman kepada takdir?",
        answer: "Iman kepada takdir (Qada dan Qadar) berarti meyakini bahwa segala sesuatu yang terjadi di alam semesta, baik yang baik maupun yang buruk, telah ditetapkan oleh Allah SWT, namun manusia tetap diberi pilihan untuk berusaha (ikhtiar)."
    },
    {
        keywords: ["mengapa", "kenapa", "harus", "shalat", "sholat"],
        question: "Mengapa kita harus shalat?",
        answer: "Karena shalat adalah tiang agama dan cara seorang Muslim berkomunikasi langsung dengan Allah. Ia merupakan ibadah yang diwajibkan lima kali sehari."
    },
    // ✅ Ibadah
    {
        keywords: ["tata", "cara", "shalat", "sholat", "benar"],
        question: "Bagaimana tata cara shalat yang benar?",
        answer: "Secara ringkas, shalat dimulai dengan niat, Takbiratul Ihram, membaca Al-Fatihah, ruku', i'tidal, sujud, duduk di antara dua sujud, hingga diakhiri dengan salam. Untuk detailnya, sangat dianjurkan belajar dari guru yang terpercaya."
    },
    {
        keywords: ["hukum", "meninggalkan", "shalat", "sholat"],
        question: "Apa hukum meninggalkan shalat?",
        answer: "Menurut kesepakatan ulama, meninggalkan shalat dengan sengaja adalah dosa yang sangat besar dalam Islam. Ia adalah pembeda utama antara seorang Muslim dan non-Muslim."
    },
    {
        keywords: ["niat", "puasa", "ramadhan"],
        question: "Bagaimana niat puasa Ramadhan?",
        answer: "Niat puasa Ramadhan dapat diucapkan dalam hati pada malam hari sebelum fajar, dengan tekad untuk berpuasa esok hari karena Allah Ta'ala."
    },
    {
        keywords: ["zakat", "siapa", "wajib", "membayar"],
        question: "Apa itu zakat dan siapa yang wajib membayarnya?",
        answer: "Zakat adalah kewajiban mengeluarkan sebagian harta untuk diberikan kepada yang berhak (fakir miskin, dll), bagi setiap Muslim yang telah memenuhi syarat kekayaan tertentu (nisab dan haul)."
    },
    {
        keywords: ["cara", "wudhu", "tayammum"],
        question: "Bagaimana cara berwudhu atau tayammum?",
        answer: "Wudhu dilakukan dengan air untuk membasuh wajah, tangan, mengusap kepala, dan membasuh kaki. Tayammum dilakukan dengan debu suci sebagai pengganti wudhu saat tidak ada air, dengan mengusap wajah dan kedua tangan."
    },
    // ✅ Al-Qur'an dan Hadis
    {
        keywords: ["perbedaan", "quran", "hadis"],
        question: "Apa perbedaan antara Al-Qur’an dan Hadis?",
        answer: "Al-Qur'an adalah firman Allah yang mutlak kebenarannya. Hadis adalah perkataan, perbuatan, dan ketetapan Nabi Muhammad ﷺ, yang berfungsi sebagai penjelas Al-Qur'an."
    },
    {
        keywords: ["membaca", "quran", "tartil"],
        question: "Bagaimana cara membaca Al-Qur’an dengan tartil?",
        answer: "Membaca dengan tartil artinya membaca secara perlahan, jelas, dan sesuai dengan kaidah ilmu Tajwid. Tujuannya agar dapat memahami dan merenungi maknanya."
    },
    // ✅ Hukum Islam
    {
        keywords: ["hukum", "riba"],
        question: "Apa itu riba dan apa hukumnya?",
        answer: "Riba adalah tambahan atau bunga dalam pinjaman atau transaksi tertentu. Hukum riba dalam Islam adalah haram secara mutlak karena merugikan dan tidak adil."
    },
    {
        keywords: ["hukum", "menikah", "non-muslim"],
        question: "Bolehkah seorang Muslim menikah dengan non-Muslim?",
        answer: "Seorang pria Muslim boleh menikahi wanita Ahli Kitab (Yahudi/Nasrani). Namun, seorang wanita Muslimah haram hukumnya menikah dengan pria non-Muslim."
    },
    {
        keywords: ["hukum", "asuransi", "pinjaman", "bank"],
        question: "Bagaimana hukum asuransi atau pinjaman bank?",
        answer: "Transaksi konvensional seringkali mengandung unsur riba yang haram. Sebagai alternatif, Islam menyediakan sistem syariah seperti asuransi syariah (takaful) dan bank syariah yang terhindar dari riba."
    },
    // ✅ Kehidupan Sehari-hari
    {
        keywords: ["hukum", "merayakan", "ulang tahun"],
        question: "Bolehkah merayakan ulang tahun dalam Islam?",
        answer: "Ada perbedaan pendapat di kalangan ulama. Sebagian membolehkan jika diisi dengan rasa syukur dan tidak bertentangan dengan syariat. Sebagian yang lain melarang karena dianggap tidak berasal dari ajaran Islam."
    },
    {
        keywords: ["cara", "menghadapi", "ujian", "hidup", "cobaan"],
        question: "Bagaimana cara menghadapi ujian hidup menurut Islam?",
        answer: "Dengan sabar, shalat, doa, tawakal (berserah diri), dan yakin bahwa semua ujian dari Allah memiliki hikmah dan tidak akan melebihi kemampuan kita."
    },
    {
        keywords: ["doa", "hati", "tenang"],
        question: "Apa doa agar hati tenang?",
        answer: "Cara utama menenangkan hati adalah dengan berdzikir (mengingat Allah). Salah satu doa yang bisa dibaca adalah 'Yaa muqallibal quluub, tsabbit qalbii 'alaa diinik' (Wahai Dzat yang membolak-balikkan hati, teguhkanlah hatiku di atas agama-Mu)."
    },
    {
        keywords: ["adab", "berteman", "teman"],
        question: "Bagaimana adab dalam berteman menurut Islam?",
        answer: "Adab berteman antara lain saling menasihati dalam kebaikan, menjaga aib teman, berkata jujur, dan memilih teman yang baik agamanya."
    },
    // ✅ Akhirat dan Hari Kiamat
    {
        keywords: ["setelah", "mati", "kematian", "terjadi"],
        question: "Apa yang terjadi setelah mati?",
        answer: "Setelah mati, manusia akan memasuki alam kubur (barzakh), lalu dibangkitkan pada hari kiamat, dihisab (dihitung) amalnya, dan akan masuk surga atau neraka."
    },
    {
        keywords: ["siksa", "kubur"],
        question: "Seperti apa siksa kubur?",
        answer: "Siksa kubur adalah balasan pertama di akhirat bagi orang kafir dan Muslim yang berdosa. Hadis menggambarkannya sebagai sesuatu yang sangat pedih. Kita dianjurkan untuk selalu berdoa agar terhindar darinya."
    },
    {
        keywords: ["tanda", "tanda-tanda", "kiamat"],
        question: "Apa tanda-tanda kiamat?",
        answer: "Tanda kiamat ada dua: tanda kecil (seperti ilmu agama dicabut, banyak fitnah) dan tanda besar (seperti munculnya Dajjal, turunnya Nabi Isa, dan terbitnya matahari dari barat)."
    },
    // ✅ Dosa-Dosa Besar
    {
        keywords: ["zina", "hukum", "dosa", "berzina"],
        question: "Apa hukum zina dalam Islam?",
        answer: "Zina adalah hubungan seksual di luar ikatan pernikahan yang sah. Hukumnya adalah haram dan termasuk salah satu dosa terbesar dalam Islam. Allah SWT berfirman, 'Dan janganlah kamu mendekati zina; (zina) itu sungguh suatu perbuatan keji, dan suatu jalan yang buruk.' (QS. Al-Isra': 32). Pelakunya diancam dengan hukuman berat di dunia dan siksa pedih di akhirat."
    },
    {
        keywords: ["mencuri", "hukum", "dosa", "curi"],
        question: "Apa hukum mencuri dalam Islam?",
        answer: "Mencuri adalah mengambil harta milik orang lain secara sembunyi-sembunyi tanpa hak. Hukumnya haram dan merupakan dosa besar. Islam sangat menjaga hak milik setiap individu, dan menetapkan hukuman yang berat (hudud) bagi pencuri yang telah memenuhi syarat-syarat tertentu, sebagai efek jera dan untuk menjaga keamanan masyarakat."
    },
    {
        keywords: ["korupsi", "hukum", "suap", "ghulul"],
        question: "Bagaimana pandangan Islam tentang korupsi?",
        answer: "Korupsi dalam pandangan Islam adalah perbuatan haram dan termasuk dosa besar. Korupsi merupakan bentuk kezaliman, pengkhianatan terhadap amanah, dan pencurian harta rakyat. Perbuatan ini mencakup suap (risywah) dan penggelapan (ghulul), yang dilaknat oleh Allah dan Rasul-Nya karena merusak tatanan masyarakat dan merugikan banyak orang."
    },
    {
        keywords: ["pemimpin", "amanah", "tanggung jawab", "khianat", "dosa"],
        question: "Apa dosa pemimpin yang tidak amanah dan tidak bertanggung jawab?",
        answer: "Kepemimpinan dalam Islam adalah amanah yang sangat besar dan akan dimintai pertanggungjawaban di akhirat. Pemimpin yang tidak amanah, tidak bertanggung jawab, dan berkhianat kepada rakyatnya telah melakukan dosa yang sangat besar. Rasulullah ﷺ bersabda bahwa setiap pemimpin akan ditanya tentang kepemimpinannya dan mengancam pemimpin yang menipu rakyatnya tidak akan mencium bau surga."
    },
    {
        keywords: ["durhaka", "orang tua", "ibu", "ayah", "dosa"],
        question: "Apa dosa durhaka kepada orang tua?",
        answer: "Durhaka kepada orang tua ('uququl walidain) adalah salah satu dosa terbesar dalam Islam setelah syirik. Perbuatan ini mencakup segala ucapan atau tindakan yang menyakiti hati mereka, bahkan sekadar berkata 'ah' (uff). Ridha Allah terletak pada ridha orang tua, dan murka Allah terletak pada murka orang tua."
    },

    // --- Data yang Ditambahkan Sebelumnya (2 Agustus 2025) ---
    {
        keywords: ["pacaran", "hukum", "dating", "khalwat"],
        question: "Apa hukum pacaran dalam Islam?",
        answer: "Pacaran seperti yang umum dipahami (berduaan, bersentuhan fisik, dll) hukumnya haram dalam Islam karena mendekati zina. Islam melarang keras khalwat, yaitu berduaan antara laki-laki dan perempuan yang bukan mahram. Proses yang dianjurkan Islam adalah ta'aruf (perkenalan yang diawasi keluarga), lalu khitbah (lamaran), dan diakhiri dengan pernikahan."
    },
    {
        keywords: ["bohong", "berbohong", "dusta", "hukum", "dosa"],
        question: "Apa hukum berbohong dalam Islam?",
        answer: "Berbohong atau berdusta (kadzib) hukumnya haram dan merupakan salah satu tanda kemunafikan. Kejujuran (shiddiq) adalah sifat mulia yang wajib dimiliki setiap Muslim. Meskipun ada pengecualian yang sangat sempit (seperti mendamaikan orang), pada dasarnya berbohong adalah perbuatan tercela yang mendatangkan murka Allah."
    },
    {
        keywords: ["tidak puasa", "meninggalkan puasa", "ramadhan", "hukum", "dosa"],
        question: "Apa hukum tidak puasa Ramadhan dengan sengaja?",
        answer: "Sengaja tidak berpuasa di bulan Ramadhan tanpa udzur syar'i (alasan yang dibenarkan syariat seperti sakit, safar, haid) adalah dosa yang sangat besar. Orang yang meninggalkannya wajib bertaubat dengan sungguh-sungguh dan menggantinya (qadha) di hari lain. Meremehkan puasa Ramadhan berarti meremehkan salah satu rukun Islam."
    },
    {
        keywords: ["hukum zakat", "zakat", "wajib"],
        question: "Apa hukum membayar zakat?",
        answer: "Hukum membayar zakat adalah Fardhu 'Ain (wajib bagi setiap individu) bagi setiap Muslim yang telah memenuhi syarat, yaitu hartanya telah mencapai batas minimum (nisab) dan telah dimiliki selama satu tahun (haul). Zakat adalah rukun Islam ketiga dan menolak membayarnya termasuk dosa besar."
    },
    {
        keywords: ["niat wudhu", "niat", "wudhu", "doa wudhu"],
        question: "Bagaimana niat wudhu, lafaz Arab dan artinya?",
        answer: "Niat wudhu letaknya di dalam hati saat pertama kali membasuh wajah. Namun, melafalkannya dianjurkan oleh sebagian ulama untuk memantapkan hati. Lafaznya adalah: <br><b>نَوَيْتُ الْوُضُوْءَ لِرَفْعِ الْحَدَثِ الْأَصْغَرِ فَرْضًا لِلّٰهِ تَعَالَى</b><br><i>Nawaitul wudhuu'a liraf'il hadatsil ashghari fardhal lillaahi ta'aala.</i><br>Artinya: 'Saya niat berwudhu untuk menghilangkan hadas kecil, fardhu karena Allah Ta'ala'."
    },
    {
        keywords: ["doa setelah wudhu", "setelah wudhu", "doa", "niat setelah wudhu"],
        question: "Bagaimana doa setelah wudhu, lafaz Arab dan artinya?",
        answer: "Doa setelah wudhu adalah: <br><b>أَشْهَدُ أَنْ لَا إِلَهَ إِلَّا اللهُ وَحْدَهُ لَا شَرِيكَ لَهُ، وَأَشْهَدُ أَنَّ مُحَمَّdًا عَبْدُهُ وَرَسُولُهُ، اللَّهُمَّ اجْعَلْنِي مِنَ التَّوَّابِينَ، وَاجْعَلْنِي مِنَ الْمُتَطَهِّرِينَ</b><br><i>Asyhadu an laa ilaaha illallaah wahdahu laa syariika lah, wa asyhadu anna muhammadan 'abduhu wa rasuuluh. Allahummaj 'alnii minat tawwaabiina waj'alnii minal mutathahhiriin.</i><br>Artinya: 'Aku bersaksi bahwa tiada Tuhan selain Allah Yang Maha Esa, tiada sekutu bagi-Nya. Dan aku bersaksi bahwa Muhammad adalah hamba dan utusan-Nya. Ya Allah, jadikanlah aku termasuk orang-orang yang bertaubat dan jadikanlah aku termasuk orang-orang yang mensucikan diri'."
    },
    {
        keywords: ["niat sholat", "niat subuh", "niat dzuhur", "niat ashar", "niat maghrib", "niat isya"],
        question: "Bagaimana niat sholat fardhu, lafaz Arab dan artinya?",
        answer: "Niat sholat letaknya di dalam hati, namun dianjurkan melafalkannya. Berikut lafaz niat untuk sholat sendiri (munfaridan):<br><b>Subuh:</b> أُصَلِّي فَرْضَ الصُّبْحِ رَكْعَتَيْنِ مُسْتَقْبِلَ الْقِبْلَةِ أَدَاءً لِلّٰهِ تَعَالَى (Ushalli fardhash shubhi rak'ataini mustaqbilal qiblati adaa'an lillaahi ta'aala).<br><b>Dzuhur:</b> أُصَلِّي فَرْضَ الظُّهْرِ أَرْبَعَ رَكَعَاتٍ مُسْتَقْبِلَ الْقِبْلَةِ أَدَاءً لِلّٰهِ تَعَالَى (Ushalli fardhadz dzuhri arba'a raka'aatin mustaqbilal qiblati adaa'an lillaahi ta'aala).<br><b>Ashar:</b> أُصَلِّي فَرْضَ الْعَصْرِ أَرْبَعَ رَكَعَاتٍ مُسْتَقْبِلَ الْقِبْلَةِ أَدَاءً لِلّٰهِ تَعَالَى (Ushalli fardhal 'ashri arba'a raka'aatin mustaqbilal qiblati adaa'an lillaahi ta'aala).<br><b>Maghrib:</b> أُصَلِّي فَرْضَ الْمَغْرِبِ ثَلَاثَ رَكَعَاتٍ مُسْتَقْبِلَ الْقِبْلَةِ أَدَاءً لِلّٰهِ تَعَالَى (Ushalli fardhal maghribi tsalaatsa raka'aatin mustaqbilal qiblati adaa'an lillaahi ta'aala).<br><b>Isya:</b> أُصَلِّي فَرْضَ الْعِشَاءِ أَرْبَعَ رَكَعَاتٍ مُسْتَقْبِلَ الْقِبْلَةِ أَدَاءً لِلّٰهِ تَعَالَى (Ushalli fardhal 'isyaa'i arba'a raka'aatin mustaqbilal qiblati adaa'an lillaahi ta'aala).<br>Jika menjadi makmum, tambahkan kata 'مَأْمُوْمًا' (ma'muuman) sebelum 'لِلّٰهِ تَعَالَى'."
    },
    {
        keywords: ["sholat jenazah", "jenazah", "mayit", "hukum"],
        question: "Apa itu sholat jenazah?",
        answer: "Sholat jenazah adalah sholat yang dilakukan untuk mendoakan seorang Muslim yang telah meninggal dunia. Sholat ini unik karena tidak ada ruku' atau sujud, hanya terdiri dari 4 kali takbir dengan bacaan-bacaan khusus. Hukum melaksanakannya adalah Fardhu Kifayah."
    },
    {
        keywords: ["fardhu kifayah", "fardhu ain", "arti"],
        question: "Apa arti dari Fardhu Kifayah?",
        answer: "Fardhu Kifayah adalah kewajiban yang ditujukan kepada seluruh komunitas Muslim. Jika sebagian orang dari komunitas tersebut telah melaksanakannya, maka gugurlah kewajiban bagi yang lain. Namun, jika tidak ada seorang pun yang melaksanakannya, maka seluruh komunitas akan menanggung dosa. Contohnya adalah sholat jenazah."
    },

    // --- Pertanyaan Tentang Curhat & Nyerah (Ditambahkan Sebelumnya) ---
    {
        keywords: ["curhat", "sedih", "galau", "cemas", "putus asa", "masalah", "stres", "buntu"],
        question: "Saya sedang sedih/cemas/punya banyak masalah, apa yang harus saya lakukan menurut Islam?",
        answer: "Dalam Islam, saat menghadapi kesedihan atau masalah, kita dianjurkan untuk:<br>1. <b>Sabar:</b> Yakinlah bahwa setiap ujian adalah cara Allah untuk menghapus dosa dan mengangkat derajat kita.<br>2. <b>Shalat dan Doa:</b> Jadikan shalat sebagai penolong dan curahkan semua isi hati kepada Allah dalam doa, karena Dia Maha Mendengar.<br>3. <b>Dzikir:</b> Mengingat Allah akan menenangkan hati (QS. Ar-Ra'd: 28). Perbanyak istighfar, tasbih, tahmid, dan tahlil.<br>4. <b>Tawakal:</b> Setelah berusaha (ikhtiar), serahkan hasilnya kepada Allah. Yakinlah Allah akan memberikan yang terbaik.<br>5. <b>Jangan Putus Asa:</b> Jangan pernah berputus asa dari rahmat Allah (QS. Az-Zumar: 53)."
    },
    {
        keywords: ["nyerah", "menyerah", "putus asa", "lelah", "capek", "pasrah", "tawakal"],
        question: "Saya merasa lelah dan ingin menyerah dengan keadaan, bagaimana pandangan Islam?",
        answer: "Perasaan lelah itu manusiawi, namun Islam melarang keras sikap putus asa dari rahmat Allah. Sikap 'menyerah' yang benar dalam Islam adalah <b>tawakal</b>, yaitu menyerahkan hasil akhir kepada Allah <b>setelah</b> kita berusaha sekuat tenaga (ikhtiar). Bukan menyerah sebelum berjuang. Ingatlah firman Allah: 'Dan jangan kamu berputus asa dari rahmat Allah. Sesungguhnya tiada berputus asa dari rahmat Allah, melainkan kaum yang kafir.' (QS. Yusuf: 87). Teruslah berusaha, berdoa, dan serahkan sisanya pada Allah."
    },
    {
        keywords: ["ikhlas", "pasrah", "ridha", "takdir", "tenang", "gelisah"],
        question: "Bagaimana cara agar hati tenang, ikhlas, dan ridha menerima takdir Allah?",
        answer: "Ketenangan hati datang dari keikhlasan (melakukan sesuatu murni karena Allah) dan ridha (menerima dengan lapang dada) atas segala ketetapan (takdir) Allah. Caranya adalah dengan:<br>1. <b>Husnudzon kepada Allah:</b> Selalu berbaik sangka bahwa apapun yang Allah takdirkan pasti mengandung hikmah dan kebaikan.<br>2. <b>Memahami Konsep Takdir:</b> Meyakini bahwa Allah telah menetapkan yang terbaik, dan tugas kita hanya berusaha dan berdoa.<br>3. <b>Memperbanyak Dzikir:</b> Mengingat Allah adalah kunci ketenangan jiwa. 'Ingatlah, hanya dengan mengingat Allah-lah hati menjadi tenteram.' (QS. Ar-Ra'd: 28).<br>4. <b>Melihat ke Bawah:</b> Syukuri nikmat yang ada dengan melihat orang yang keadaannya di bawah kita, bukan selalu melihat ke atas."
    },
    {
        keywords: ["beda", "tawakal", "pasrah", "malas", "ikhtiar", "berusaha"],
        question: "Apa bedanya tawakal dengan pasrah yang berarti malas dan tidak mau berusaha?",
        answer: "Perbedaannya sangat besar. <b>Ikhtiar (berusaha)</b> adalah kewajiban kita sebagai manusia. <b>Tawakal</b> adalah amalan hati yang dilakukan <b>setelah</b> kita melakukan ikhtiar secara maksimal. Jadi, urutannya adalah: Berusaha (Ikhtiar) -> Berdoa -> Bertawakal (Menyerahkan hasilnya pada Allah). Sedangkan pasrah dalam arti malas, tidak mau berusaha, dan hanya menunggu takdir adalah sikap yang keliru dan dilarang dalam Islam. Rasulullah ﷺ bersabda, 'Ikatlah untamu, baru kemudian bertawakallah'."
    },
    
    // --- PENAMBAHAN BARU SESUAI PERMINTAAN ---
    {
        keywords: ["boleh curhat", "curhat", "capek", "nyerah", "lelah", "assalamualaikum"],
        question: "Assalamualaikum, boleh curhat tidak? Saya capek dan rasanya ingin menyerah.",
        answer: "Wa'alaikumussalam warahmatullahi wabarakatuh. Tentu saja boleh, Saudaraku. Saya di sini untuk mendengarkan. Perasaan lelah dan ingin menyerah itu sangat manusiawi, dan Islam sangat memahami kerapuhan hati manusia.<br><br>Ketahuilah, mengadu dan 'curhat' terbaik adalah kepada Allah SWT. Dia Maha Mendengar keluh kesahmu, bahkan sebelum engkau mengucapkannya. Allah berfirman: <i>'Berdoalah kepada-Ku, niscaya akan Kuperkenankan bagimu.'</i> (QS. Ghafir: 60).<br><br>Rasa 'capek' yang kau rasakan adalah ujian untuk mengangkat derajatmu. Yakinlah, <i>'Allah tidak membebani seseorang melainkan sesuai dengan kesanggupannya.'</i> (QS. Al-Baqarah: 286). Ini adalah janji Allah, artinya engkau pasti lebih kuat dari ujian ini.<br><br>Dan jangan biarkan bisikan 'menyerah' menguasaimu. Itu adalah bisikan setan agar engkau berputus asa. Padahal Allah melarang keras: <i>'Janganlah kamu berputus asa dari rahmat Allah.'</i> (QS. Az-Zumar: 53).<br><br>Cobalah ambil wudhu, bentangkan sajadahmu, shalatlah dua rakaat, dan menangislah dalam sujudmu. Adukan semua kepada-Nya. InsyaAllah hatimu akan terasa lebih lapang. Bertahanlah, karena sesungguhnya sesudah kesulitan itu ada kemudahan."
    }
];


    
    
    // --- FUNGSI PERMINTAAN PENYIMPANAN PERMANEN ---
    async function requestPersistentStorage() {
        if (navigator.storage && navigator.storage.persist) {
            try {
                const isPersisted = await navigator.storage.persisted();
                console.log(`Penyimpanan sudah permanen: ${isPersisted}`);
                if (!isPersisted) {
                    const result = await navigator.storage.persist();
                    console.log(`Berhasil meminta penyimpanan permanen: ${result}`);
                }
            } catch (error) {
                console.error('Gagal memeriksa atau meminta penyimpanan permanen:', error);
            }
        }
    }
    
    
    // --- FUNGSI PERMINTAAN PENYIMPANAN PERMANEN ---
    async function requestPersistentStorage() {
        if (navigator.storage && navigator.storage.persist) {
            try {
                const isPersisted = await navigator.storage.persisted();
                console.log(`Penyimpanan sudah permanen: ${isPersisted}`);
                if (!isPersisted) {
                    const result = await navigator.storage.persist();
                    console.log(`Berhasil meminta penyimpanan permanen: ${result}`);
                }
            } catch (error) {
                console.error('Gagal memeriksa atau meminta penyimpanan permanen:', error);
            }
        }
    }
    
    // --- SCRIPT UTAMA ---
    document.addEventListener('DOMContentLoaded', () => {
        // --- GLOBAL VARIABLES & STATE ---
        let currentLanguage = 'id';
        let countdownInterval;
        let bookmarkedDoas = JSON.parse(localStorage.getItem('bookmarked_doas')) || [];
        let lastReadDoaId = localStorage.getItem('last_read_doa_id');
        let currentOpenDoaId = null;
        let dzikirState = JSON.parse(localStorage.getItem('dzikir_state')) || {};
        let currentDzikirId = null;
        window.latestPrayerTimes = null;
        let lastCheckedDate = new Date().getDate();
    
        // Quran State
        let allSurahsData = [];
        let bookmarkedSurahs = JSON.parse(localStorage.getItem('bookmarked_surahs')) || [];
        let lastReadSurah = JSON.parse(localStorage.getItem('last_read_surah'));
        let currentOpenSurahNumber = null;
    
        // Pengaturan audio
        const adhanSoundFiles = {
            'none': { name: 'Tanpa Suara' },
            'notification': { name: 'Notifikasi', audioId: 'audio-notification' },
            'fajr': { name: 'Muazin Subuh', audioId: 'audio-adhan-fajr' },
            'mishary': { name: 'Muazin Makkah (Mishary)', audioId: 'audio-adhan-mishary' },
            'madinah': { name: 'Muazin Madinah', audioId: 'audio-adhan-madinah' },
            'al_afasy': { name: 'Muazin Al-Afasy', audioId: 'audio-adhan-mishary' },
            'abdul_basit': { name: 'Muazin Abdul Basit', audioId: 'audio-adhan-madinah' }
        };
        const adhanOptionsMap = {
            Imsak: ['none', 'notification', 'mishary', 'madinah'],
            Fajr: ['none', 'notification', 'fajr', 'mishary', 'madinah', 'al_afasy', 'abdul_basit'],
            Sunrise: ['none', 'notification'],
            Dhuhr: ['none', 'notification', 'mishary', 'madinah', 'al_afasy', 'abdul_basit'],
            Asr: ['none', 'notification', 'mishary', 'madinah', 'al_afasy', 'abdul_basit'],
            Maghrib: ['none', 'notification', 'mishary', 'madinah', 'al_afasy', 'abdul_basit'],
            Isha: ['none', 'notification', 'mishary', 'madinah', 'al_afasy', 'abdul_basit']
        };
    
        function migrateAudioSettings(settings) {
            const newSettings = {};
            let needsUpdate = false;
            for (const key in settings) {
                const value = settings[key];
                if (typeof value === 'string') {
                    newSettings[key] = { sound: value, volume: 1.0 };
                    needsUpdate = true;
                } else if (typeof value === 'object' && value !== null && 'sound' in value && 'volume' in value) {
                    newSettings[key] = value;
                } else {
                    newSettings[key] = { sound: 'none', volume: 1.0 };
                    needsUpdate = true;
                }
            }
            if (needsUpdate) {
                console.log("Migrating audio settings to new format.");
                localStorage.setItem('prayerAudioSettings', JSON.stringify(newSettings));
            }
            return newSettings;
        }
    
        const defaultAudioSettings = {
            Imsak: { sound: 'notification', volume: 1.0 },
            Fajr: { sound: 'fajr', volume: 1.0 },
            Sunrise: { sound: 'none', volume: 1.0 },
            Dhuhr: { sound: 'mishary', volume: 0.8 },
            Asr: { sound: 'mishary', volume: 0.8 },
            Maghrib: { sound: 'mishary', volume: 0.8 },
            Isha: { sound: 'mishary', volume: 0.8 }
        };
        let prayerAudioSettings = JSON.parse(localStorage.getItem('prayerAudioSettings')) || defaultAudioSettings;
        prayerAudioSettings = migrateAudioSettings(prayerAudioSettings);
    
        // --- ELEMENT SELECTORS ---
        const sidebar = document.getElementById('sidebar');
        const menuToggle = document.getElementById('menu-toggle');
        const prayerListContainerEl = document.getElementById('prayer-list-container');
        const countdownTimerEl = document.getElementById('countdown-timer');
        const nextPrayerNameEl = document.getElementById('next-prayer-name');
        const calendarContainerEl = document.getElementById('calendar-view-container');
        const gregorianDateEl = document.getElementById('gregorian-date-display');
        const hijriDateEl = document.getElementById('hijri-date-display');
    
        // --- [PERBAIKAN] LOGIKA LOKASI DAN JADWAL SHOLAT YANG BARU & LEBIH BAIK ---
        const CACHE_KEY_MONTHLY_TIMINGS = 'prayer_monthly_timings';
        const CACHE_KEY_CITY = 'prayer_city_data';
        const CACHE_KEY_COORDS = 'prayer_coords';
    
        function loadPrayerDataFromCache() {
            const cachedCity = localStorage.getItem(CACHE_KEY_CITY);
            if (cachedCity) {
                document.getElementById('city-name').textContent = cachedCity;
            }
    
            const today = new Date();
            const year = today.getFullYear();
            const month = today.getMonth() + 1;
            const day = today.getDate();
            const cacheKey = `timings_${year}_${month}`;
    
            const monthlyData = JSON.parse(localStorage.getItem(CACHE_KEY_MONTHLY_TIMINGS));
    
            if (monthlyData && monthlyData.key === cacheKey) {
                console.log("Memuat jadwal sholat dari cache bulanan.");
                const todayData = monthlyData.data[day - 1];
                if (todayData) {
                    const todayTimings = todayData.timings;
                    const todayHijri = todayData.date.hijri;
                    const hijriText = `${todayHijri.day} ${todayHijri.month.en} ${todayHijri.year} H`;
    
                    hijriDateEl.textContent = hijriText;
                    window.latestPrayerTimes = todayTimings;
                    renderPrayerTimes(todayTimings);
                    startCountdown(todayTimings);
                    return true;
                }
            }
            console.log("Cache tidak valid atau tidak tersedia untuk hari ini.");
            return false;
        }
    
        function fetchCityName(lat, lon) {
            fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json`)
                .then(r => r.json())
                .then(data => {
                    const cityName = data.address.city || data.address.town || data.address.village || "Lokasi Tidak Diketahui";
                    document.getElementById('city-name').textContent = cityName;
                    localStorage.setItem(CACHE_KEY_CITY, cityName);
                })
                .catch(error => {
                    console.error("Gagal mengambil nama kota:", error);
                    const cachedCity = localStorage.getItem(CACHE_KEY_CITY);
                    if (cachedCity) document.getElementById('city-name').textContent = cachedCity;
                });
        }
    
        function fetchPrayerTimings(lat, lon) {
            document.getElementById('city-name').textContent = "Memperbarui jadwal...";
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
    
            fetch(`https://api.aladhan.com/v1/calendar/${year}/${month}?latitude=${lat}&longitude=${lon}&method=11`)
                .then(r => r.json())
                .then(j => {
                    if (j.code === 200) {
                        console.log("Berhasil mengambil data jadwal sholat baru untuk sebulan dari API.");
                        localStorage.setItem(CACHE_KEY_COORDS, JSON.stringify({ lat, lon }));
                        const cacheKey = `timings_${year}_${month}`;
                        const adjustedData = j.data.map(dailyData => {
                            const adjustedTimings = {};
                            for (const key in dailyData.timings) {
                                const timeString = dailyData.timings[key].split(' ')[0];
                                const [h, m] = timeString.split(':').map(Number);
                                if (!isNaN(h) && !isNaN(m)) {
                                    const date = new Date();
                                    date.setHours(h, m + 2, 0, 0);
                                    adjustedTimings[key] = `${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
                                } else {
                                    adjustedTimings[key] = dailyData.timings[key];
                                }
                            }
                            return { ...dailyData, timings: adjustedTimings };
                        });
                        const dataToStore = { key: cacheKey, data: adjustedData };
                        localStorage.setItem(CACHE_KEY_MONTHLY_TIMINGS, JSON.stringify(dataToStore));
                        console.log("Data jadwal sholat sebulan penuh telah disimpan ke cache.");
    
                        loadPrayerDataFromCache();
                        fetchCityName(lat, lon);

                        // --- KODE JEMBATAN UNTUK MENGIRIM JADWAL KE ANDROID ---
                        if (window.Android && typeof window.Android.schedulePrayerAlarms === 'function') {
                            console.log("Mengirim jadwal sholat ke Android untuk notifikasi native...");
                            
                            // 1. Ambil jadwal hari ini dari data yang baru di-fetch
                            const todayData = j.data[new Date().getDate() - 1];
                            const todayTimings = todayData.timings;
                            
                            // 2. Siapkan data dalam format JSON yang dimengerti oleh MainActivity
                            const scheduleForAndroid = [];
                            const prayerKeys = ['Imsak', 'Fajr', 'Sunrise', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];

                            prayerKeys.forEach(prayerName => {
                                if (todayTimings[prayerName] && prayerAudioSettings[prayerName]) {
                                    scheduleForAndroid.push({
                                        name: prayerName,
                                        time: todayTimings[prayerName],
                                        soundId: prayerAudioSettings[prayerName].sound
                                    });
                                }
                            });

                            // 3. Kirim data ke MainActivity
                            window.Android.schedulePrayerAlarms(JSON.stringify(scheduleForAndroid));
                        }
                        // --- AKHIR KODE JEMBATAN ---
                        
                    } else {
                        console.error("API Aladhan mengembalikan error.");
                        handleLocationError({ message: "API Error" });
                    }
                })
                .catch(error => {
                    console.error("Gagal mengambil jadwal sholat (kemungkinan offline):", error);
                    handleLocationError(error);
                });
        }
    
        function handleLocationError(error) {
            console.warn(`Error getting location: ${error.message}.`);
            document.getElementById('city-name').textContent = "Gagal dapat lokasi";
            // Coba lagi dari cache. Jika gagal total, baru pakai fallback
            if (!loadPrayerDataFromCache()) {
                console.warn("Cache juga gagal. Menggunakan lokasi fallback (Medan).");
                fetchPrayerTimings(3.5952, 98.6722); // Fallback ke Medan
                document.getElementById('city-name').textContent = "Medan (Fallback)";
            }
        }
    
        // Fungsi utama yang menangani semua alur permintaan lokasi
        function requestLocationAndFetchData() {
            document.getElementById('city-name').textContent = "Mencari lokasi...";
            if (!navigator.geolocation) {
                handleLocationError({ message: "Geolocation tidak didukung browser ini." });
                return;
            }
    
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    // Sukses
                    console.log("Lokasi berhasil didapatkan.");
                    fetchPrayerTimings(position.coords.latitude, position.coords.longitude);
                },
                (error) => {
                    // Gagal
                    handleLocationError(error);
                },
                { enableHighAccuracy: true, timeout: 20000, maximumAge: 0 }
            );
        }
    
        // Inisialisasi utama untuk lokasi dan jadwal sholat
        async function initLocationAndPrayerTimes() {
            // Coba muat dari cache dulu, ini sangat cepat
            if (loadPrayerDataFromCache()) {
                console.log("Sukses memuat dari cache, tidak perlu meminta lokasi baru.");
                return;
            }
    
            // Jika tidak ada cache, cek status izin
            try {
                const permissionStatus = await navigator.permissions.query({ name: 'geolocation' });
    
                if (permissionStatus.state === 'granted') {
                    // Jika izin sudah ada, langsung minta lokasi
                    console.log("Izin lokasi sudah ada, langsung ambil data.");
                    requestLocationAndFetchData();
                } else if (permissionStatus.state === 'prompt') {
                    // Jika butuh izin, tampilkan modal kustom kita
                    console.log("Membutuhkan izin, tampilkan modal kustom.");
                    document.getElementById('custom-location-modal').style.display = 'flex';
                } else { // denied
                    // Jika ditolak, langsung jalankan alur error
                    console.log("Izin lokasi ditolak sebelumnya.");
                    handleLocationError({ message: "Izin lokasi telah ditolak." });
                }
            } catch (error) {
                console.error("Gagal memeriksa status izin, mungkin browser tidak mendukung. Coba minta langsung.", error);
                requestLocationAndFetchData(); // Fallback untuk browser lama
            }
        }
    
        function setupCustomPermissionModals() {
            const locationModal = document.getElementById('custom-location-modal');
            const allowLocationBtn = document.getElementById('allow-location-btn');
            const denyLocationBtn = document.getElementById('deny-location-btn');
    
            // Tombol "Izinkan" pada modal akan memicu permintaan lokasi asli
            allowLocationBtn.addEventListener('click', () => {
                locationModal.style.display = 'none';
                requestLocationAndFetchData(); // Panggil fungsi utama di sini
            });
    
            denyLocationBtn.addEventListener('click', () => {
                locationModal.style.display = 'none';
                handleLocationError({ message: "Pengguna menolak dari modal kustom." });
            });
    
            // Setup untuk modal notifikasi (tidak berubah banyak)
            const notificationModal = document.getElementById('custom-notification-modal');
            const allowNotificationBtn = document.getElementById('allow-notification-btn');
            const denyNotificationBtn = document.getElementById('deny-notification-btn');
    
            window.requestNotificationPermission = function() {
                return new Promise((resolve, reject) => {
                    if ('Notification' in window) {
                        if (Notification.permission === 'granted') {
                            resolve('granted');
                        } else if (Notification.permission === 'default') {
                            notificationModal.style.display = 'flex';
                            allowNotificationBtn.onclick = () => {
                                notificationModal.style.display = 'none';
                                Notification.requestPermission().then(resolve);
                            };
                            denyNotificationBtn.onclick = () => {
                                notificationModal.style.display = 'none';
                                reject('denied_by_custom_modal');
                            };
                        } else {
                            reject('denied_previously');
                        }
                    } else {
                        reject('not_supported');
                    }
                });
            }
        }
        // --- AKHIR BLOK PERBAIKAN ---
    
        window.checkForDateChangeAndRefetch = function() {
            const currentDate = new Date().getDate();
            if (currentDate !== lastCheckedDate) {
                console.log("Pergantian hari terdeteksi, memuat ulang jadwal sholat...");
                lastCheckedDate = currentDate;
                const coords = JSON.parse(localStorage.getItem(CACHE_KEY_COORDS));
                if (coords) {
                    fetchPrayerTimings(coords.lat, coords.lon);
                }
                updateDates();
            }
        };
    
        // --- CORE APP LOGIC (Sebagian besar tidak berubah) ---
        function showView(viewId) {
            document.querySelectorAll('.main-view').forEach(v => v.style.display = 'none');
            const appContainer = document.querySelector('.app-container');
            const tasbihView = document.getElementById('tasbih-view');
            const qiblaView = document.getElementById('qibla-view');
            const targetView = document.getElementById(viewId);
    
            document.body.style.backgroundColor = '';
            if (viewId === 'qibla-view') {
                document.body.style.backgroundColor = '#000000';
            }
    
            if (viewId === 'tasbih-view' || viewId === 'qibla-view') {
                appContainer.style.display = 'none';
                if (viewId === 'tasbih-view') tasbihView.style.display = 'flex';
                if (viewId === 'qibla-view') qiblaView.style.display = 'flex';
            } else {
                appContainer.style.display = 'block';
                tasbihView.style.display = 'none';
                qiblaView.style.display = 'none';
                if (targetView) targetView.style.display = 'block';
            }
    
            const prayerView = document.getElementById('prayer-times-view');
            menuToggle.style.display = (prayerView.style.display === 'block' && viewId !== 'qibla-view' && viewId !== 'tasbih-view') ? 'flex' : 'none';
        }
    
        function closeSidebar() {
            menuToggle.classList.remove('open');
            sidebar.classList.remove('open');
        }
    
        function setupNavigation() {
            document.getElementById('prayer-times-btn').addEventListener('click', (e) => { e.preventDefault(); showView('prayer-times-view'); closeSidebar(); });
            document.getElementById('doa-harian-btn').addEventListener('click', (e) => { e.preventDefault(); showView('doa-view'); renderDoaListView('all'); closeSidebar(); });
            document.getElementById('quran-btn').addEventListener('click', (e) => { e.preventDefault(); showView('quran-view'); renderQuranView('surah'); closeSidebar(); });
            document.getElementById('dzikir-btn').addEventListener('click', (e) => { e.preventDefault(); showView('dzikir-view'); renderDzikirList(); closeSidebar(); });
            document.getElementById('settings-btn').addEventListener('click', (e) => {
                e.preventDefault();
                document.getElementById('settings-modal').style.display = 'flex';
                closeSidebar();
            });
    
            document.querySelectorAll('.back-button').forEach(btn => {
                btn.addEventListener('click', () => {
                    const targetViewId = btn.getAttribute('data-target-view');
                    if (targetViewId) {
                        showView(targetViewId);
                    }
                });
            });
    
            menuToggle.addEventListener('click', (e) => { e.stopPropagation(); menuToggle.classList.toggle('open'); sidebar.classList.toggle('open'); });
            document.addEventListener('click', (e) => {
                if (sidebar.classList.contains('open') && !sidebar.contains(e.target) && !menuToggle.contains(e.target)) {
                    closeSidebar();
                }
            });
        }
    
        // --- PRAYER TIMES FEATURE (TIDAK BERUBAH) ---
        function stopAllAdhanAudio() {
            document.querySelectorAll('audio[id^="audio-adhan-"], audio[id^="audio-notification"]').forEach(audio => {
                if (!audio.paused) {
                    audio.pause();
                    audio.currentTime = 0;
                }
            });
        }
    
        function playPrayerAudio(prayerName) {
            const setting = prayerAudioSettings[prayerName];
            if (!setting || setting.sound === 'none') {
                console.log(`Audio untuk ${prayerName} di-nonaktifkan.`);
                return;
            }
    
            const option = adhanSoundFiles[setting.sound];
            if (option && option.audioId) {
                const audioElement = document.getElementById(option.audioId);
                if (audioElement) {
                    stopAllAdhanAudio();
                    audioElement.volume = setting.volume;
                    audioElement.currentTime = 0;
                    const playPromise = audioElement.play();
                    if (playPromise !== undefined) {
                        playPromise.catch(error => {
                            console.error(`Gagal memutar audio untuk ${prayerName}:`, error);
                            showPrayerNotification(translations[currentLanguage][prayerName] || prayerName, 'Gagal memutar adzan otomatis. Pastikan interaksi halaman sudah dilakukan.');
                        });
                    }
                }
            }
        }
    
        function showPrayerNotification(prayerName, customBody = null) {
            if (Notification.permission !== 'granted') return;
            const notificationTitle = `Waktunya Sholat ${prayerName}`;
            const notificationOptions = {
                body: customBody || `Sekarang telah masuk waktu sholat ${prayerName}.`,
                icon: 'logo-annur.jpg',
                tag: 'prayer-time-notification',
                renotify: true
            };
            navigator.serviceWorker.ready.then(registration => {
                registration.showNotification(notificationTitle, notificationOptions);
            });
        }
    
        function renderPrayerTimes(prayerTimes) {
            if (!prayerListContainerEl) return;
            prayerListContainerEl.innerHTML = '';
    
            const prayerOrder = ['Imsak', 'Fajr', 'Sunrise', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
    
            prayerOrder.forEach(key => {
                if (prayerTimes[key]) {
                    const prayerName = translations[currentLanguage][key] || key;
                    const prayerTime = prayerTimes[key];
    
                    const prayerItemHtml = `
                        <div class="prayer-item">
                            <div class="prayer-details">
                                <div class="prayer-name">${prayerName}</div>
                            </div>
                            <div class="prayer-time-value">${prayerTime}</div>
                        </div>`;
    
                    prayerListContainerEl.innerHTML += prayerItemHtml;
                }
            });
        }
    
        function startCountdown(prayerTimes) {
            if (countdownInterval) clearInterval(countdownInterval);
            const prayerOrder = ['Imsak', 'Fajr', 'Sunrise', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
            let triggeredPrayers = [];
    
            function update() {
                checkForDateChangeAndRefetch();
                const now = new Date();
                let nextPrayerTime, nextPrayerName;
    
                for (const name of prayerOrder) {
                    const prayerDate = new Date(`${now.toDateString()} ${prayerTimes[name]}`);
                    if (prayerDate > now && !triggeredPrayers.includes(name)) {
                        nextPrayerTime = prayerDate;
                        nextPrayerName = name;
                        break;
                    }
                }
    
                if (!nextPrayerTime) {
                    const tomorrow = new Date(now);
                    tomorrow.setDate(now.getDate() + 1);
                    nextPrayerTime = new Date(`${tomorrow.toDateString()} ${prayerTimes['Imsak']}`);
                    nextPrayerName = 'Imsak';
                    triggeredPrayers = [];
                }
    
                const diff = nextPrayerTime - now;
                if (diff < 0) return;
    
                if (diff <= 1000 && !triggeredPrayers.includes(nextPrayerName)) {
                    const translatedPrayerName = translations[currentLanguage][nextPrayerName] || nextPrayerName;
                    showPrayerNotification(translatedPrayerName);
                    playPrayerAudio(nextPrayerName);
                    triggeredPrayers.push(nextPrayerName);
    
                    setTimeout(() => {
                        if (window.latestPrayerTimes) {
                            startCountdown(window.latestPrayerTimes);
                        }
                    }, 2000);
                }
    
                const h = String(Math.floor(diff / 3600000)).padStart(2, '0');
                const m = String(Math.floor((diff % 3600000) / 60000)).padStart(2, '0');
                const s = String(Math.floor((diff % 60000) / 1000)).padStart(2, '0');
                countdownTimerEl.textContent = `${h}:${m}:${s}`;
                nextPrayerNameEl.textContent = translations[currentLanguage][nextPrayerName] || nextPrayerName;
            }
    
            update();
            countdownInterval = setInterval(update, 1000);
    
            document.addEventListener("visibilitychange", () => {
                if (document.visibilityState === "visible") {
                    console.log("Tab is visible again, syncing countdown...");
                    update();
                }
            });
        }
    
        function generateCalendar() {
            if (!calendarContainerEl) return;
            const dayNamesList = {
                id: ["Min", "Sen", "Sel", "Rab", "Kam", "Jum", "Sab"], en: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"], ar: ["أحد", "إثن", "ثلا", "أرب", "خمي", "جمع", "سبت"], tr: ["Paz", "Pzt", "Sal", "Çar", "Per", "Cum", "Cmt"], fr: ["Dim", "Lun", "Mar", "Mer", "Jeu", "Ven", "Sam"], es: ["Dom", "Lun", "Mar", "Mié", "Jue", "Vie", "Sáb"], de: ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"], ru: ["Вс", "Пн", "Вт", "Ср", "Чт", "Пт", "Сб"], ur: ["اتوار", "پیر", "منگل", "بدھ", "جمعرات", "جمعہ", "ہفتہ"], bn: ["রবি", "সোম", "মঙ্গল", "বুধ", "বৃহ", "শুক্র", "শনি"]
            };
            const today = new Date();
            const todayDayIndex = today.getDay();
            let calendarHtml = '';
            for (let i = 0; i < 7; i++) {
                const date = new Date();
                date.setDate(today.getDate() - (todayDayIndex - i));
                const isToday = i === todayDayIndex;
                calendarHtml += `<div class="day ${isToday ? 'today' : ''}"><span class="day-name">${dayNamesList[currentLanguage][i] || dayNamesList['id'][i]}</span><span class="day-number">${date.getDate()}</span></div>`;
            }
            calendarContainerEl.innerHTML = calendarHtml;
        }
    
        function updateDates() {
            if (!gregorianDateEl) return;
            const now = new Date();
            const localeMap = { id: 'id-ID', en: 'en-US', ar: 'ar-SA', tr: 'tr-TR', fr: 'fr-FR', es: 'es-ES', de: 'de-DE', ru: 'ru-RU', ur: 'ur-PK', bn: 'bn-BD' };
            const locale = localeMap[currentLanguage] || 'en-US';
            gregorianDateEl.textContent = now.toLocaleDateString(locale, { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });
        }



// [BARU] Tambahkan seluruh fungsi ini di dalam script utama Anda
function setupMotivationFeature() {
    const motivasiBtn = document.getElementById('motivasi-btn');
    const motivationView = document.getElementById('motivation-view');
    if (!motivasiBtn || !motivationView) return;

    const listContainer = document.getElementById('motivation-list-container');
    const tabsContainer = document.getElementById('motivation-tabs');
    const randomQuoteBtn = document.getElementById('random-quote-btn');
    const toastEl = document.getElementById('motivation-toast');
    const bookmarkListBtn = document.getElementById('motivation-bookmark-list-btn');

    // Carousel elements
    const carouselTrack = document.querySelector('.motivation-carousel-track');
    const carouselIndicators = document.querySelector('.carousel-indicators');
    const prevButton = document.querySelector('.carousel-control.prev');
    const nextButton = document.querySelector('.carousel-control.next');
    let currentSlide = 0;
    let featuredQuotes = [];

    let favoriteQuotes = JSON.parse(localStorage.getItem('favorite_quotes')) || [];

    // --- Inisialisasi Fitur ---
    motivasiBtn.addEventListener('click', (e) => {
        e.preventDefault();
        showView('motivation-view');
        renderQuotes('all');
        setupCarousel();
        closeSidebar();
    });

    // --- Logika Carousel ---
    function setupCarousel() {
        featuredQuotes = motivationData.filter(q => q.featured);
        if (featuredQuotes.length === 0 || !carouselTrack) return;

        carouselTrack.innerHTML = '';
        carouselIndicators.innerHTML = '';

        featuredQuotes.forEach((quote, index) => {
            const slide = document.createElement('div');
            slide.className = 'motivation-slide';
            slide.innerHTML = `<p>"${quote.text}"</p><span class="quote-author">- ${quote.author} -</span>`;
            carouselTrack.appendChild(slide);

            const dot = document.createElement('div');
            dot.className = 'indicator-dot';
            dot.dataset.slideTo = index;
            carouselIndicators.appendChild(dot);
        });
        updateCarousel();
    }
    
    function updateCarousel() {
        carouselTrack.style.transform = `translateX(-${currentSlide * 100}%)`;
        const dots = document.querySelectorAll('.indicator-dot');
        dots.forEach(dot => dot.classList.remove('active'));
        dots[currentSlide].classList.add('active');
    }

    nextButton.addEventListener('click', () => {
        currentSlide = (currentSlide + 1) % featuredQuotes.length;
        updateCarousel();
    });

    prevButton.addEventListener('click', () => {
        currentSlide = (currentSlide - 1 + featuredQuotes.length) % featuredQuotes.length;
        updateCarousel();
    });
    
    carouselIndicators.addEventListener('click', (e) => {
        if(e.target.matches('.indicator-dot')) {
            currentSlide = parseInt(e.target.dataset.slideTo);
            updateCarousel();
        }
    });

    // --- Logika Tampilan & Filter ---
    function renderQuotes(category) {
        listContainer.innerHTML = '';
        let quotesToRender = motivationData;

        if (category === 'favorites') {
            quotesToRender = motivationData.filter(q => favoriteQuotes.includes(q.id));
             if (quotesToRender.length === 0) {
                listContainer.innerHTML = `<div class="loading-indicator">Anda belum punya kutipan favorit.</div>`;
                return;
            }
        } else if (category !== 'all') {
            quotesToRender = motivationData.filter(q => q.category === category);
        }

        quotesToRender.forEach(quote => {
            const card = document.createElement('div');
            card.className = 'motivation-quote-card';
            card.dataset.id = quote.id;

            const isFavorited = favoriteQuotes.includes(quote.id);

            card.innerHTML = `
                <p class="quote-text">"${quote.text}"</p>
                <p class="quote-author">- ${quote.author}</p>
                <div class="quote-footer">
                    <div class="quote-tags">
                        <span class="quote-tag-badge">${quote.category}</span>
                    </div>
                    <div class="quote-actions">
                        <span class="action-icon share-btn" title="Bagikan">🔗</span>
                        <span class="action-icon copy-btn" title="Salin Teks">📋</span>
                        <span class="action-icon favorite-btn ${isFavorited ? 'favorited' : ''}" title="Favorit">❤️</span>
                    </div>
                </div>
            `;
            listContainer.appendChild(card);
        });
    }
    
    // --- Event Listeners ---
    tabsContainer.addEventListener('click', (e) => {
        if (e.target.classList.contains('tab-item')) {
            tabsContainer.querySelector('.tab-item.active').classList.remove('active');
            e.target.classList.add('active');
            renderQuotes(e.target.dataset.category);
            bookmarkListBtn.classList.remove('active'); // Nonaktifkan highlight favorit jika tab lain dipilih
        }
    });

    listContainer.addEventListener('click', (e) => {
        const card = e.target.closest('.motivation-quote-card');
        if (!card) return;
        
        const quoteId = parseInt(card.dataset.id);
        const quote = motivationData.find(q => q.id === quoteId);

        if (e.target.classList.contains('copy-btn')) {
            const textToCopy = `"${quote.text}" - ${quote.author}`;
            navigator.clipboard.writeText(textToCopy).then(() => {
                showToast("Teks berhasil disalin!");
            });
        }
        
// ... di dalam fungsi setupMotivationFeature() ...

// ... di dalam fungsi setupMotivationFeature() ...

        if (e.target.classList.contains('share-btn')) {
            // Siapkan teks yang mau dibagikan
            const textToShare = `"${quote.text}" - ${quote.author}\n\nDari aplikasi Annur Islamic`;

            // Cek apakah "jembatan" ke Android ada
            if (window.Android && typeof window.Android.shareContent === 'function') {
                // Panggil fungsi di MainActivity dan kirimkan teksnya
                window.Android.shareContent(textToShare);
            } else {
                // Pesan jika dibuka di browser biasa
                showToast("Gunakan fitur bagikan di dalam aplikasi.");
            }
        }


        if (e.target.classList.contains('favorite-btn')) {
            toggleFavorite(quoteId, e.target);
        }
    });

    randomQuoteBtn.addEventListener('click', () => {
        listContainer.innerHTML = '';
        const randomQuote = motivationData[Math.floor(Math.random() * motivationData.length)];
        renderQuotes('all'); // Tampilkan lagi semua
        setTimeout(() => {
            const cardToScroll = document.querySelector(`.motivation-quote-card[data-id='${randomQuote.id}']`);
            if(cardToScroll) {
                cardToScroll.scrollIntoView({ behavior: 'smooth', block: 'center' });
                cardToScroll.style.boxShadow = "0 0 15px var(--accent-color)";
                setTimeout(() => { cardToScroll.style.boxShadow = ""; }, 2000);
            }
        }, 100);
    });
    
    bookmarkListBtn.addEventListener('click', () => {
        tabsContainer.querySelector('.tab-item.active').classList.remove('active');
        bookmarkListBtn.classList.add('active');
        renderQuotes('favorites');
    });

    // --- Fungsi Bantuan (Helper Functions) ---
    function toggleFavorite(id, iconElement) {
        const index = favoriteQuotes.indexOf(id);
        if (index > -1) {
            favoriteQuotes.splice(index, 1);
            iconElement.classList.remove('favorited');
            showToast("Dihapus dari favorit.");
        } else {
            favoriteQuotes.push(id);
            iconElement.classList.add('favorited');
            showToast("Ditambahkan ke favorit!");
        }
        localStorage.setItem('favorite_quotes', JSON.stringify(favoriteQuotes));
        
        // Jika sedang di tab favorit, render ulang
        if(document.querySelector('#motivation-bookmark-list-btn.active')) {
            renderQuotes('favorites');
        }
    }

    function showToast(message) {
        toastEl.textContent = message;
        toastEl.classList.add('show');
        setTimeout(() => {
            toastEl.classList.remove('show');
        }, 2000);
    }
}

// Terakhir, panggil fungsi setup utama di dalam event listener DOMContentLoaded
document.addEventListener('DOMContentLoaded', () => {
    // ... kode setup lainnya
    setupMotivationFeature();
    // ... sisa kode Anda
});

// [MODIFIKASI] FUNGSI UNTUK FITUR SAHABAT ANNUR (CHAT INTERFACE)
function setupSahabatAnnurFeature() {
    // 1. Ambil semua elemen HTML yang dibutuhkan
    const sahabatAnnurBtn = document.getElementById('sahabat-annur-btn');
    const chatWindow = document.getElementById('chat-window');
    const inputField = document.getElementById('sahabat-annur-input');
    const sendBtn = document.getElementById('sahabat-annur-send-btn');
    const typingIndicator = document.getElementById('typing-container');

    if (!sahabatAnnurBtn) return; // Hentikan jika elemen utama tidak ada

    // 2. Event listener untuk tombol di sidebar
    sahabatAnnurBtn.addEventListener('click', (e) => {
        e.preventDefault();
        showView('sahabat-annur-view');
        closeSidebar();
    });

    // 3. Fungsi untuk menampilkan pesan di jendela chat
    function displayMessage(message, sender) {
        const messageWrapper = document.createElement('div');
        messageWrapper.className = `chat-message ${sender}-message`;

        let messageHtml = '';
        if (sender === 'ai') {
            messageHtml += '<div class="ai-avatar">AI</div>';
        }
        messageHtml += `<div class="chat-bubble">${message}</div>`;

        messageWrapper.innerHTML = messageHtml;
        chatWindow.appendChild(messageWrapper);
        chatWindow.scrollTop = chatWindow.scrollHeight; // Auto-scroll ke bawah
    }

    // 4. Fungsi untuk mencari jawaban dari AI
    function getAiResponse(query) {
        const lowerCaseQuery = query.toLowerCase();
        let bestMatch = null;
        let highestScore = 0;

        sahabatAnnurData.forEach(item => {
            let currentScore = 0;
            item.keywords.forEach(keyword => {
                if (lowerCaseQuery.includes(keyword)) {
                    currentScore++;
                }
            });
            if (currentScore > highestScore) {
                highestScore = currentScore;
                bestMatch = item;
            }
        });

        if (bestMatch) {
            return bestMatch.answer;
        } else {
            return "Maaf, saya belum mengerti pertanyaan Anda. Coba gunakan kata kunci lain seperti 'rukun islam', 'zakat', atau 'batal wudhu'.";
        }
    }

    // 5. Fungsi utama yang dijalankan saat pengguna mengirim pesan
    function handleSendMessage() {
        const userQuery = inputField.value.trim();
        if (userQuery === "") return;

        // Tampilkan pesan pengguna
        displayMessage(userQuery, 'user');
        inputField.value = ""; // Kosongkan input field
        inputField.focus();

        // Tampilkan indikator mengetik
        typingIndicator.style.display = 'flex';
        chatWindow.scrollTop = chatWindow.scrollHeight;

        // Simulasi AI berpikir, lalu tampilkan jawaban
        setTimeout(() => {
            const aiAnswer = getAiResponse(userQuery);
            typingIndicator.style.display = 'none'; // Sembunyikan indikator
            displayMessage(aiAnswer, 'ai');
        }, 1200); // Jeda 1.2 detik
    }

    // 6. Pasang event listener untuk tombol kirim dan tombol Enter
    sendBtn.addEventListener('click', handleSendMessage);
    inputField.addEventListener('keyup', (e) => {
        if (e.key === 'Enter') {
            handleSendMessage();
        }
    });
}
    
        // --- DOA HARIAN FEATURE ---
        function setupDoaHarian() {
            const doaListContainer = document.getElementById('doa-list-container-view');
            const lastReadCard = document.getElementById('last-read-doa-card');
            const lastReadCardText = lastReadCard.querySelector('p');
            const singleDoaModal = document.getElementById('single-doa-modal');
    
            window.renderDoaListView = function(filter) {
                doaListContainer.innerHTML = '';
                let data = (filter === 'bookmarked') ? doaHarianData.filter(d => bookmarkedDoas.includes(d.id)) : doaHarianData;
                if (data.length === 0) { doaListContainer.innerHTML = `<p class="loading-indicator">Tidak ada doa yang ditandai.</p>`; return; }
                data.forEach((d, index) => {
                    const item = document.createElement('div'); item.className = 'list-item';
                    item.innerHTML = `<span class="num">${d.id}</span><div class="details"><div class="title">${d.title}</div><div class="subtitle">${d.subtitle}</div></div><span class="arabic">${d.arabic.split(' ')[0]}...</span>`;
                    item.addEventListener('click', () => showSingleDoa(d.id));
                    doaListContainer.appendChild(item);
                });
            }
            function showSingleDoa(id) {
                const doa = doaHarianData.find(d => d.id === id); if (!doa) return;
                currentOpenDoaId = id;
                singleDoaModal.querySelector('#single-doa-modal-title').textContent = doa.title;
                singleDoaModal.querySelector('#single-doa-modal-body').innerHTML = `
                                    <p class="single-item-arabic">${doa.arabic}</p>
                                    <p class="single-item-latin">${doa.latin}</p>
                                    <hr style="margin: 1.5rem 0; border: 0; border-top: 1px solid #eee;">
                                    <p class="single-item-arti"><b>Artinya:</b> ${doa.arti}</p>`;
                updateBookmarkIcon(); singleDoaModal.style.display = 'flex';
                localStorage.setItem('last_read_doa_id', id); lastReadDoaId = id; renderLastRead();
            }
            function renderLastRead() {
                const p = lastReadCardText;
                if (lastReadDoaId) { const doa = doaHarianData.find(d => d.id == lastReadDoaId); p.textContent = doa ? doa.title : 'Belum ada doa yang dibaca'; }
                else { p.textContent = 'Belum ada doa yang dibaca'; }
            }
            function updateBookmarkIcon() { singleDoaModal.querySelector('#bookmark-doa-btn').classList.toggle('bookmarked', bookmarkedDoas.includes(currentOpenDoaId)); }
    
            lastReadCard.addEventListener('click', () => { if (lastReadDoaId) showSingleDoa(parseInt(lastReadDoaId)); });
            singleDoaModal.querySelector('#bookmark-doa-btn').addEventListener('click', () => {
                const index = bookmarkedDoas.indexOf(currentOpenDoaId);
                if (index > -1) bookmarkedDoas.splice(index, 1); else bookmarkedDoas.push(currentOpenDoaId);
                localStorage.setItem('bookmarked_doas', JSON.stringify(bookmarkedDoas)); updateBookmarkIcon();
                if (document.querySelector('#doa-view .tab-item.active').dataset.tab === 'bookmarked') renderDoaListView('bookmarked');
            });
            document.querySelectorAll('#doa-view .tab-item').forEach(tab => tab.addEventListener('click', () => {
                document.querySelector('#doa-view .tab-item.active').classList.remove('active');
                tab.classList.add('active'); renderDoaListView(tab.dataset.tab);
            }));
            singleDoaModal.querySelector('.close-button').addEventListener('click', () => singleDoaModal.style.display = 'none');
            renderLastRead();
        }
    
        // --- GANTI FUNGSI QURAN LAMA ANDA DENGAN KESELURUHAN KODE DI BAWAH INI ---
        function setupQuranFeature() {
            const quranListContainer = document.getElementById('quran-list-container');
            const quranTabs = document.getElementById('quran-tabs');
            const lastReadSurahCard = document.getElementById('last-read-surah-card');
            const lastReadSurahCardText = lastReadSurahCard.querySelector('p');
            const surahViewTitle = document.getElementById('surah-view-title');
            const surahViewBookmarkBtn = document.getElementById('surah-view-bookmark-btn');
            const surahViewBody = document.getElementById('surah-view-body');
            const surahViewBackBtn = document.getElementById('surah-view-back-btn');
            const juzDetailTitle = document.getElementById('juz-detail-title');
            const juzSurahListContainer = document.getElementById('juz-surah-list-container');
            const murottalPlayer = document.getElementById('murottal-player');
    
            const qariData = {
                "ar.alafasy": "Mishary Rashid Al-Afasy",
                "ar.abdurrahmaansudais": "Abdurrahman As-Sudais",
                "ar.abdulsamad": "Abdul Samad",
                "ar.saoodshuraym": "Saud Al-Shuraim",
                "ar.husarymujawwad": "Mahmoud Khalil Al-Hussary (Mujawwad)"
            };
    
            let selectedQariIdentifier = localStorage.getItem('selected_qari_identifier') || 'ar.alafasy';
    
            let surahAudioData = {};
            let currentPlayingAyahIndex = 0;
            let isPlaylistPlaying = false;
    
            async function fetchAllSurahs() {
                if (allSurahsData.length > 0) return allSurahsData;
                try {
                    quranListContainer.innerHTML = `<div class="loading-indicator">Memuat data surah...</div>`;
                    const response = await fetch('https://api.quran.gading.dev/surah');
                    const data = await response.json();
                    if (data.code === 200) {
                        allSurahsData = data.data;
                        return allSurahsData;
                    }
                } catch (error) {
                    console.error("Error fetching surah list:", error);
                    quranListContainer.innerHTML = `<div class="loading-indicator">Gagal dimuat. Periksa koneksi.</div>`;
                }
                return [];
            }
    
            function renderSurahList(surahs, container, backTarget) {
                container.innerHTML = '';
                if (!surahs || surahs.length === 0) {
                    container.innerHTML = `<div class="loading-indicator">Tidak ada data.</div>`;
                    return;
                }
                surahs.forEach(surah => {
                    const item = document.createElement('div');
                    item.className = 'list-item';
                    item.innerHTML = `
                        <span class="num">${surah.number}</span>
                        <div class="details">
                            <div class="title">${surah.name.transliteration.id}</div>
                            <div class="subtitle">${surah.name.translation.id} (${surah.numberOfVerses} ayat)</div>
                        </div>
                        <span class="arabic">${surah.name.short}</span>`;
                    item.addEventListener('click', () => showSurahDetail(surah.number, backTarget));
                    container.appendChild(item);
                });
            }
    
            function renderJuzList() {
                quranListContainer.innerHTML = '';
                for (let i = 1; i <= 30; i++) {
                    const item = document.createElement('div');
                    item.className = 'list-item';
                    item.innerHTML = `
                        <span class="num">${i}</span>
                        <div class="details"><div class="title">Juz ${i}</div></div>
                        <span class="arabic">الجزء ${i}</span>`;
                    item.addEventListener('click', () => showSurahsInJuz(i));
                    quranListContainer.appendChild(item);
                }
            }
    
            async function showSurahsInJuz(juzNumber) {
                juzDetailTitle.textContent = `Daftar Surah di Juz ${juzNumber}`;
                juzSurahListContainer.innerHTML = `<div class="loading-indicator">Memuat...</div>`;
                showView('juz-detail-view');
                const surahs = await fetchAllSurahs();
                const surahNumbersInJuz = [...new Set(juzToSurahMap[juzNumber])];
                const surahsInJuz = surahs.filter(s => surahNumbersInJuz.includes(s.number));
                renderSurahList(surahsInJuz, juzSurahListContainer, 'juz-detail-view');
            }
    
            function stopPlaylist() {
                isPlaylistPlaying = false;
                murottalPlayer.pause();
                murottalPlayer.src = '';
                currentPlayingAyahIndex = 0;
                document.querySelectorAll('.ayah-item.ayah-playing').forEach(el => el.classList.remove('ayah-playing'));
                const playBtn = document.getElementById('surah-play-btn');
                if (playBtn) playBtn.innerHTML = '▶️';
            }
    
            function playAyah(index) {
                if (!surahAudioData.ayahs || !surahAudioData.ayahs[index]) {
                    console.log(`Surah ${currentOpenSurahNumber} selesai.`);
                    if (currentOpenSurahNumber >= 114) {
                        console.log("Murottal Al-Qur'an telah selesai. Pemutaran berhenti.");
                        stopPlaylist();
                        return;
                    }
                    const nextSurahNumber = currentOpenSurahNumber + 1;
                    console.log(`Lanjut otomatis ke surah berikutnya: ${nextSurahNumber}`);
                    showSurahDetail(nextSurahNumber, 'quran-view', true);
                    return;
                }
    
                currentPlayingAyahIndex = index;
                const ayahNumberInSurah = surahAudioData.ayahs[index].numberInSurah;
                const ayahElement = document.getElementById(`ayah-item-${ayahNumberInSurah}`);
    
                document.querySelectorAll('.ayah-item.ayah-playing').forEach(el => el.classList.remove('ayah-playing'));
    
                if (ayahElement) {
                    ayahElement.classList.add('ayah-playing');
                    ayahElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
    
                const audioUrl = surahAudioData.ayahs[index].audio;
                murottalPlayer.src = audioUrl;
                murottalPlayer.play().catch(e => {
                    console.error(`Gagal memutar audio untuk ayat ${ayahNumberInSurah}:`, e);
                });
            }
    
            function togglePlaylist() {
                isPlaylistPlaying = !isPlaylistPlaying;
                const playBtn = document.getElementById('surah-play-btn');
                if (isPlaylistPlaying) {
                    playBtn.innerHTML = '⏸️';
                    playAyah(currentPlayingAyahIndex);
                } else {
                    playBtn.innerHTML = '▶️';
                    murottalPlayer.pause();
                }
            }
    
            async function showSurahDetail(number, backTarget = 'quran-view', autoplay = false) {
                surahViewTitle.textContent = `Memuat Surah...`;
                surahViewBody.innerHTML = `<div class="loading-indicator">Memuat...</div>`;
                surahViewBackBtn.setAttribute('data-target-view', backTarget);
                showView('surah-view');
    
                // [PERBAIKAN] Panggil stopPlaylist() tanpa syarat di awal
                // Ini memastikan state (termasuk hitungan ayat) selalu di-reset setiap kali surah baru dibuka.
                stopPlaylist();
    
                try {
                    const textResponse = await fetch(`https://api.quran.gading.dev/surah/${number}`);
                    const textResult = await textResponse.json();
                    if (textResult.code !== 200) throw new Error('Gagal memuat teks surah');
                    const surah = textResult.data;
    
                    const audioResponse = await fetch(`https://api.alquran.cloud/v1/surah/${number}/editions/${selectedQariIdentifier}`);
                    const audioResult = await audioResponse.json();
                    if (audioResult.code !== 200) throw new Error('Gagal memuat audio surah');
                    surahAudioData = audioResult.data[0];
    
                    currentOpenSurahNumber = surah.number;
                    surahViewTitle.textContent = `${surah.name.transliteration.id}`;
    
                    let contentHtml = `
                        <div class="surah-detail-header">
                            <h2>${surah.name.long}</h2>
                            <p>${surah.name.translation.id}</p>
                            <div class="meta">${surah.revelation.id} • ${surah.numberOfVerses} AYAT</div>
                        </div>
                        <div class="surah-audio-player">
                            <button id="surah-play-btn">▶️</button>
                            <select id="qari-select" class="custom-select" style="flex-grow: 1; text-align: center;"></select>
                        </div>
                    `;
                    if (surah.number !== 1 && surah.number !== 9) {
                        contentHtml += `<div class="basmala"><p class="basmala-arabic">بِسْمِ ٱللَّهِ ٱلرَّحْمَٰنِ ٱلرَّحِيمِ</p></div>`;
                    }
    
                    surah.verses.forEach(ayah => {
                        contentHtml += `
                            <div class="ayah-item" id="ayah-item-${ayah.number.inSurah}">
                                <div class="ayah-header"><span class="ayah-number">${surah.number}:${ayah.number.inSurah}</span></div>
                                <p class="ayah-arabic">${ayah.text.arab}</p>
                                <p class="ayah-latin">${ayah.text.transliteration.en}</p>
                                <p class="ayah-translation"><b>Artinya:</b> ${ayah.translation.id}</p>
                            </div>`;
                    });
                    surahViewBody.innerHTML = contentHtml;
    
                    const qariSelect = document.getElementById('qari-select');
                    for (const key in qariData) {
                        const option = document.createElement('option');
                        option.value = key;
                        option.textContent = qariData[key];
                        if (key === selectedQariIdentifier) { option.selected = true; }
                        qariSelect.appendChild(option);
                    }
    
                    qariSelect.addEventListener('change', function() {
                        selectedQariIdentifier = this.value;
                        localStorage.setItem('selected_qari_identifier', selectedQariIdentifier);
                        stopPlaylist();
                        showSurahDetail(number, backTarget);
                    });
    
                    document.getElementById('surah-play-btn').addEventListener('click', togglePlaylist);
                    lastReadSurah = { number: surah.number, name: surah.name.transliteration.id };
                    localStorage.setItem('last_read_surah', JSON.stringify(lastReadSurah));
                    updateLastReadSurahCard();
                    surahViewBookmarkBtn.classList.toggle('bookmarked', bookmarkedSurahs.includes(surah.number));
    
                    if (autoplay) {
                        // Sedikit jeda untuk memastikan UI siap sebelum memulai audio
                        setTimeout(() => {
                            togglePlaylist();
                        }, 100);
                    }
    
                } catch (error) {
                    surahViewBody.innerHTML = `<div class="loading-indicator">Gagal memuat surah. Periksa koneksi internet dan coba lagi.</div>`;
                    console.error("Error fetching surah detail:", error);
                }
            }
    
            function updateLastReadSurahCard() {
                if (lastReadSurah) {
                    lastReadSurahCardText.textContent = `Surah ${lastReadSurah.name} (No. ${lastReadSurah.number})`;
                } else {
                    lastReadSurahCardText.textContent = "Belum ada surah yang dibaca";
                }
            }
    
            lastReadSurahCard.addEventListener('click', () => {
                if (lastReadSurah && lastReadSurah.number) {
                    showSurahDetail(lastReadSurah.number, 'quran-view');
                }
            });
    
            surahViewBookmarkBtn.addEventListener('click', function() {
                if (currentOpenSurahNumber === null) return;
                const index = bookmarkedSurahs.indexOf(currentOpenSurahNumber);
                if (index > -1) {
                    bookmarkedSurahs.splice(index, 1);
                } else {
                    bookmarkedSurahs.push(currentOpenSurahNumber);
                }
                this.classList.toggle('bookmarked');
                localStorage.setItem('bookmarked_surahs', JSON.stringify(bookmarkedSurahs));
            });
    
            quranTabs.addEventListener('click', (e) => {
                if (e.target.classList.contains('tab-item')) {
                    quranTabs.querySelector('.tab-item.active').classList.remove('active');
                    e.target.classList.add('active');
                    renderQuranView(e.target.dataset.tab);
                }
            });
    
            murottalPlayer.addEventListener('ended', () => {
                if (isPlaylistPlaying) {
                    playAyah(currentPlayingAyahIndex + 1);
                }
            });
    
            murottalPlayer.addEventListener('play', () => {
                const playBtn = document.getElementById('surah-play-btn');
                if (isPlaylistPlaying && playBtn) playBtn.innerHTML = '⏸️';
            });
    
            murottalPlayer.addEventListener('pause', () => {
                const playBtn = document.getElementById('surah-play-btn');
                if (isPlaylistPlaying && playBtn) playBtn.innerHTML = '▶️';
            });
    
            window.renderQuranView = async function(tab) {
                quranListContainer.innerHTML = `<div class="loading-indicator">Memuat...</div>`;
                const surahs = await fetchAllSurahs();
                if (tab === 'surah') {
                    renderSurahList(surahs, quranListContainer, 'quran-view');
                } else if (tab === 'juz') {
                    renderJuzList();
                } else if (tab === 'bookmarked') {
                    const bookmarkedList = surahs.filter(s => bookmarkedSurahs.includes(s.number));
                    if (bookmarkedList.length === 0) {
                        quranListContainer.innerHTML = `<div class="loading-indicator">Tidak ada surah yang ditandai.</div>`;
                    } else {
                        renderSurahList(bookmarkedList, quranListContainer, 'quran-view');
                    }
                }
            };
    
            updateLastReadSurahCard();
        }

        
    
        // --- DZIKIR & TASBIH FEATURE ---
        function setupDzikir() {
            const dzikirListContainer = document.getElementById('dzikir-list-container');
            const dzikirDetailModal = document.getElementById('dzikir-detail-modal');
            const tasbihView = document.getElementById('tasbih-view');
            const tasbihTitle = document.getElementById('tasbih-title');
            const tasbihCurrentCount = document.getElementById('tasbih-current-count');
            const tasbihTargetCount = document.getElementById('tasbih-target-count');
            const tasbihTapArea = document.getElementById('tasbih-tap-area');
            const tasbihResetBtn = document.getElementById('tasbih-reset-btn');
    
            function saveState() { localStorage.setItem('dzikir_state', JSON.stringify(dzikirState)); }
    
            window.renderDzikirList = () => {
                dzikirListContainer.innerHTML = '';
                dzikirData.forEach((d, index) => {
                    const item = document.createElement('div');
                    item.className = 'list-item';
                    item.innerHTML = `
                                    <span class="num">📿</span>
                                    <div class="details">
                                        <div class="title">${d.title}</div>
                                        <div class="subtitle">${d.subtitle}</div>
                                    </div>
                                    <span class="arabic">${d.arabic}</span>`;
                    item.addEventListener('click', () => showDzikirDetailModal(d.id));
                    dzikirListContainer.appendChild(item);
                });
            };
    
            function showDzikirDetailModal(id) {
                const dzikir = dzikirData.find(d => d.id === id); if (!dzikir) return;
    
                dzikirDetailModal.querySelector('#dzikir-detail-modal-title').textContent = dzikir.title;
                const modalBody = dzikirDetailModal.querySelector('#dzikir-detail-modal-body');
                modalBody.innerHTML = `
                                    <p class="single-item-arabic">${dzikir.arabic}</p>
                                    <p class="single-item-latin">${dzikir.latin}</p>
                                    <hr style="margin: 1.5rem 0; border: 0; border-top: 1px solid #eee;">
                                    <p class="single-item-arti"><b>Artinya:</b> ${dzikir.arti}</p>
                                    <button id="start-dzikir-btn" class="modal-action-btn">Mulai Dzikir (Target: ${dzikir.target})</button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    `;
    
                modalBody.querySelector('#start-dzikir-btn').addEventListener('click', () => {
                    dzikirDetailModal.style.display = 'none';
                    showTasbihView(id);
                });
    
                dzikirDetailModal.style.display = 'flex';
            }
    
            dzikirDetailModal.querySelector('.close-button').addEventListener('click', () => {
                dzikirDetailModal.style.display = 'none';
            });
    
            function showTasbihView(id) {
                currentDzikirId = id;
                const d = dzikirData.find(dz => dz.id === id);
                const s = dzikirState[id] || { count: 0, lap: 0 };
    
                tasbihTitle.textContent = d.title;
                tasbihCurrentCount.textContent = s.count;
                tasbihTargetCount.textContent = `/ ${d.target}`;
    
                tasbihView.querySelector('.tasbih-arabic').textContent = d.arabic;
                tasbihView.querySelector('.tasbih-latin').textContent = d.latin;
                tasbihView.querySelector('.tasbih-arti').textContent = `Artinya: ${d.arti}`;
    
                showView('tasbih-view');
            }
    
            tasbihTapArea.addEventListener('click', () => {
                if (!currentDzikirId) return;
                const d = dzikirData.find(dz => dz.id === currentDzikirId);
                let s = dzikirState[currentDzikirId];
                if (!s) {
                    s = dzikirState[currentDzikirId] = { count: 0, lap: 0 };
                }
                s.count++;
                if (s.count > d.target) {
                    s.count = 1;
                    s.lap = (s.lap || 0) + 1;
                }
                s.lastUpdate = new Date().toLocaleString('id-ID');
                tasbihCurrentCount.textContent = s.count;
                saveState();
                if (navigator.vibrate) navigator.vibrate(50);
            });
    
            tasbihResetBtn.addEventListener('click', () => {
                if (!currentDzikirId || !dzikirState[currentDzikirId]) return;
                dzikirState[currentDzikirId].count = 0;
                dzikirState[currentDzikirId].lap = 0;
                tasbihCurrentCount.textContent = 0;
                saveState();
            });
        }
    
        // --- QIBLA FEATURE ---
        function setupQiblaFeature() {
            const qiblaBtn = document.getElementById('qibla-btn');
            const qiblaView = document.getElementById('qibla-view');
            const backButton = qiblaView.querySelector('.back-button');
            const compassCircleEl = document.getElementById('qibla-compass-circle');
            const needleEl = document.getElementById('qibla-needle');
            const permissionPromptEl = document.getElementById('qibla-permission-prompt');
            const permissionBtn = document.getElementById('qibla-permission-btn');
            const compassUiContainer = document.getElementById('qibla-compass-container');
            const infoBoxEl = document.getElementById('qibla-info-box');
            const degreeDisplayEl = infoBoxEl.querySelector('.direction-degree');
            const recalibrateBtn = document.getElementById('qibla-recalibrate-btn');
    
            let qiblaBearing = null;
            let magneticDeclination = 0;
            let isWatching = false;
            let orientationHandlerRef = null;
    
            const getMagneticDeclination = (latitude, longitude) => {
                const toRad = (angle) => angle * (Math.PI / 180);
                const toDeg = (angle) => angle * (180 / Math.PI);
                const g10 = -29404.8, g11 = -1450.9, h11 = 4652.5;
                const phi = toRad(latitude), lambda = toRad(longitude);
                const cosPhi = Math.cos(phi), sinPhi = Math.sin(phi);
                const cosLambda = Math.cos(lambda), sinLambda = Math.sin(lambda);
                const X = g10 * cosPhi + (g11 * cosLambda + h11 * sinLambda) * sinPhi;
                const Y = g11 * sinLambda - h11 * cosLambda;
                return toDeg(Math.atan2(Y, X));
            };
    
            function createOrientationHandler() {
                return function(event) {
                    let magneticHeading = event.webkitCompassHeading;
                    if (typeof magneticHeading === 'undefined' || magneticHeading === null) {
                        magneticHeading = event.alpha;
                    }
                    if (magneticHeading === null || qiblaBearing === null) return;
    
                    const trueHeading = magneticHeading + magneticDeclination;
                    const needleRotation = qiblaBearing - trueHeading;
                    needleEl.style.transform = `translateX(-50%) rotate(${needleRotation}deg)`;
    
                    const alignmentCheck = Math.abs(needleRotation % 360);
                    if (alignmentCheck < 2.5 || alignmentCheck > 357.5) {
                        compassCircleEl.classList.add('aligned');
                        if (navigator.vibrate) navigator.vibrate([50]);
                    } else {
                        compassCircleEl.classList.remove('aligned');
                    }
                };
            }
    
            function showUi(showCompass, message = '') {
                if (showCompass) {
                    permissionPromptEl.style.display = 'none';
                    compassUiContainer.style.display = 'flex';
                    infoBoxEl.style.display = 'block';
                } else {
                    permissionPromptEl.style.display = 'block';
                    permissionPromptEl.querySelector('p').textContent = message || 'Fitur ini memerlukan izin lokasi & sensor gerak.';
                    compassUiContainer.style.display = 'none';
                    infoBoxEl.style.display = 'none';
                }
            }
    
            function calculateQiblaBearing(lat, lon) {
                const toRad = (deg) => deg * Math.PI / 180;
                const kaabaLat = toRad(21.4225);
                const userLat = toRad(lat);
                const dLon = toRad(39.8262 - lon);
                const y = Math.sin(dLon) * Math.cos(kaabaLat);
                const x = Math.cos(userLat) * Math.sin(kaabaLat) - Math.sin(userLat) * Math.cos(kaabaLat) * Math.cos(dLon);
                let bearing = Math.atan2(y, x) * (180 / Math.PI);
                return (bearing + 360) % 360;
            }
    
            function stopCompass() {
                if (orientationHandlerRef) {
                    window.removeEventListener('deviceorientation', orientationHandlerRef);
                }
                compassCircleEl.classList.remove('aligned');
                isWatching = false;
                orientationHandlerRef = null;
            }
    
            async function startCompass() {
                stopCompass();
                isWatching = true;
                showUi(true);
                degreeDisplayEl.textContent = 'Mendapatkan lokasi & kalibrasi...';
    
                try {
                    const position = await new Promise((resolve, reject) => {
                        navigator.geolocation.getCurrentPosition(resolve, reject, {
                            enableHighAccuracy: true,
                            timeout: 20000,
                            maximumAge: 0
                        });
                    });
    
                    const userLat = position.coords.latitude;
                    const userLon = position.coords.longitude;
    
                    qiblaBearing = calculateQiblaBearing(userLat, userLon);
                    magneticDeclination = getMagneticDeclination(userLat, userLon);
    
                    if (qiblaBearing !== null) {
                        degreeDisplayEl.textContent = `Arah Kiblat: ${qiblaBearing.toFixed(1)}° dari Utara`;
                        orientationHandlerRef = createOrientationHandler();
                        window.addEventListener('deviceorientation', orientationHandlerRef);
                    } else {
                        throw new Error("Gagal menghitung arah kiblat.");
                    }
    
                } catch (error) {
                    console.error("Qibla Error:", error.message);
                    stopCompass();
                    showUi(false, 'Gagal mendapatkan lokasi akurat. Pastikan GPS aktif dan izin diberikan.');
                }
            }
    
            async function requestAndStart() {
                // For iOS 13+ devices
                if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
                    try {
                        const permissionState = await DeviceOrientationEvent.requestPermission();
                        if (permissionState !== 'granted') {
                            showUi(false, 'Izin sensor gerak ditolak. Fitur ini memerlukannya.');
                            return;
                        }
                    } catch (error) {
                        showUi(false, 'Gagal meminta izin sensor gerak.');
                        return;
                    }
                }
                // For other devices
                await startCompass();
            }
    
            async function initializeQibla() {
                if (!navigator.geolocation || typeof window.DeviceOrientationEvent === "undefined") {
                    showUi(false, 'Browser Anda tidak mendukung fitur ini.');
                    return;
                }
                try {
                    const locationPermission = await navigator.permissions.query({ name: 'geolocation' });
                    if (locationPermission.state === 'granted') {
                        await requestAndStart(); // Permission already granted
                    } else {
                        showUi(false); // Show the "Start" button
                    }
                } catch (e) {
                    showUi(false);
                }
            }
    
            qiblaBtn.addEventListener('click', (e) => {
                e.preventDefault();
                showView('qibla-view');
                closeSidebar();
                initializeQibla();
            });
    
            permissionBtn.addEventListener('click', requestAndStart);
            recalibrateBtn.addEventListener('click', startCompass);
            backButton.addEventListener('click', stopCompass);
        }
    
        // --- [MODIFIKASI] FUNGSI FITUR KUIS DIPERBARUI ---
        function setupQuizFeature() {
            // Elemen UI Kuis
            const quizBtn = document.getElementById('quiz-btn');
            const userPointsEl = document.getElementById('user-points');
            const quizModeCards = document.querySelectorAll('#quiz-view .quiz-mode-card');
            
            // Elemen UI Level
            const levelSelectionContainer = document.getElementById('level-selection-container');
            
            // Elemen UI Game Individu
            const quizGameTitle = document.getElementById('quiz-game-title');
            const quizScoreEl = document.getElementById('quiz-score');
            const questionTextEl = document.getElementById('quiz-question-text');
            const optionsContainer = document.getElementById('quiz-options');
            const feedbackEl = document.getElementById('quiz-feedback');
    
            // Elemen UI Game Duet
            const duetQuestionTextEl = document.getElementById('duet-question-text');
            const duetOptionsContainer = document.getElementById('duet-options');
            const duetFeedbackEl = document.getElementById('duet-feedback');
            const player1ScoreEl = document.getElementById('player1-score');
            const player2ScoreEl = document.getElementById('player2-score');
            const duetResultModal = document.getElementById('duet-result-modal');
    
            // --- FUNGSI UMUM ---
            function loadUserPoints() {
                const savedPoints = localStorage.getItem('user_points');
                userPoints = savedPoints ? parseInt(savedPoints, 10) : 0;
                userPointsEl.textContent = userPoints;
            }
    
            function saveUserPoints() {
                localStorage.setItem('user_points', userPoints);
                userPointsEl.textContent = userPoints;
            }
    
            quizBtn.addEventListener('click', (e) => {
                e.preventDefault();
                loadUserPoints();
                showView('quiz-view');
                closeSidebar();
            });
            
            // --- ALUR PEMILIHAN MODE & LEVEL ---
            quizModeCards.forEach(card => {
                card.addEventListener('click', () => {
                    const mode = card.dataset.mode;
                    document.getElementById('quiz-level-title').dataset.mode = mode;
                    showView('quiz-level-selection-view');
                });
            });
    
            levelSelectionContainer.addEventListener('click', (e) => {
                const card = e.target.closest('.quiz-mode-card');
                if(card) {
                    const level = card.dataset.level;
                    const mode = document.getElementById('quiz-level-title').dataset.mode;
                    if(mode === 'individu') {
                        startIndividualGame(level);
                    } else if (mode === 'duet') {
                        startDuetGame(level);
                    }
                }
            });
    
    
            // --- LOGIKA MODE INDIVIDU ---
            function startIndividualGame(level) {
                quizScore = 0;
                quizGameTitle.textContent = `Mode Individu (${level})`;
                quizScoreEl.textContent = quizScore;
                availableQuestions = quizData.map((_, index) => index).filter(i => quizData[i].level === level);
                showView('quiz-game-view');
                renderNextIndividualQuestion();
            }
            
            function renderNextIndividualQuestion() {
                feedbackEl.textContent = '';
                feedbackEl.className = 'quiz-feedback';
                optionsContainer.innerHTML = '';
    
if (availableQuestions.length === 0) {
                    // Ambil elemen modal
                    const individualResultModal = document.getElementById('individual-result-modal');

                    // Isi konten modal dengan skor akhir dan poin yang didapat
                    document.getElementById('individual-final-score').textContent = `Skor Akhir Anda: ${quizScore}`;
                    const pointsEarned = quizScore * 10; // Poin didapat dari jumlah jawaban benar
                    document.getElementById('individual-points-earned').textContent = `Anda mendapatkan ${pointsEarned} 💎 dari permainan ini.`;
                    
                    // Tampilkan modal
                    individualResultModal.style.display = 'flex';

                    // Tambahkan fungsi untuk tombol kembali
                    document.getElementById('individual-back-to-menu-btn').onclick = () => {
                        individualResultModal.style.display = 'none';
                        showView('quiz-view');
                    };
                    return;
                }
    
                const randomIndex = Math.floor(Math.random() * availableQuestions.length);
                currentQuestionIndex = availableQuestions.splice(randomIndex, 1)[0];
                
                const question = quizData[currentQuestionIndex];
                questionTextEl.textContent = question.question;
    
                question.options.forEach((option, index) => {
                    const optionEl = document.createElement('div');
                    optionEl.className = 'quiz-option';
                    optionEl.textContent = option;
                    optionEl.dataset.index = index;
                    optionEl.addEventListener('click', handleIndividualAnswer);
                    optionsContainer.appendChild(optionEl);
                });
            }
    
            function handleIndividualAnswer(e) {
                const selectedIndex = parseInt(e.target.dataset.index, 10);
                const question = quizData[currentQuestionIndex];
                const isCorrect = selectedIndex === question.correctAnswer;
                
                document.querySelectorAll('#quiz-options .quiz-option').forEach(opt => {
                    opt.classList.add('disabled');
                    if(parseInt(opt.dataset.index, 10) === question.correctAnswer) {
                        opt.classList.add('correct');
                    }
                });
    
                if (isCorrect) {
                    e.target.classList.add('correct');
                    feedbackEl.textContent = 'Benar! +10 Poin';
                    feedbackEl.classList.add('correct');
                    quizScore++;
                    userPoints += 10;
                    quizScoreEl.textContent = quizScore;
                    saveUserPoints();
                } else {
                    e.target.classList.add('incorrect');
                    feedbackEl.textContent = `Salah. Jawaban: ${question.surahInfo}`;
                    feedbackEl.classList.add('incorrect');
                }
                setTimeout(renderNextIndividualQuestion, 2500);
            }
    
            // --- LOGIKA MODE DUET ---
            function startDuetGame(level) {
                duetGameState.active = true;
                duetGameState.currentPlayer = 1;
                duetGameState.player1Score = 0;
                duetGameState.player2Score = 0;
                duetGameState.currentRound = 1;
                duetGameState.questionPool = quizData.map((_, index) => index).filter(i => quizData[i].level === level);
                
                player1ScoreEl.textContent = `Skor: 0`;
                player2ScoreEl.textContent = `Skor: 0`;
                
                showView('quiz-duet-game-view');
                renderNextDuetQuestion();
                updateTurnIndicator();
            }
            
            function updateTurnIndicator() {
                const player1Container = document.getElementById('player1-container');
                const player2Container = document.getElementById('player2-container');
                const turnIndicator = document.getElementById('duet-turn-indicator');
                
                if (duetGameState.currentPlayer === 1) {
                    player1Container.classList.add('active');
                    player2Container.classList.remove('active');
                    turnIndicator.textContent = `Ronde ${duetGameState.currentRound} - Giliran Pemain 1`;
                } else {
                    player1Container.classList.remove('active');
                    player2Container.classList.add('active');
                    turnIndicator.textContent = `Ronde ${duetGameState.currentRound} - Giliran Pemain 2`;
                }
            }
            
            function renderNextDuetQuestion() {
                duetFeedbackEl.textContent = '';
                duetFeedbackEl.className = 'quiz-feedback';
                duetOptionsContainer.innerHTML = '';
    
                if (duetGameState.questionPool.length === 0 || duetGameState.currentRound > duetGameState.questionsPerPlayer) {
                    endDuetGame();
                    return;
                }
    
                const randomIndex = Math.floor(Math.random() * duetGameState.questionPool.length);
                currentQuestionIndex = duetGameState.questionPool.splice(randomIndex, 1)[0];
                
                const question = quizData[currentQuestionIndex];
                duetQuestionTextEl.textContent = question.question;
    
                question.options.forEach((option, index) => {
                    const optionEl = document.createElement('div');
                    optionEl.className = 'quiz-option';
                    optionEl.textContent = option;
                    optionEl.dataset.index = index;
                    optionEl.addEventListener('click', handleDuetAnswer);
                    duetOptionsContainer.appendChild(optionEl);
                });
            }
    
            function handleDuetAnswer(e) {
                const selectedIndex = parseInt(e.target.dataset.index, 10);
                const question = quizData[currentQuestionIndex];
                const isCorrect = selectedIndex === question.correctAnswer;
                
                document.querySelectorAll('#duet-options .quiz-option').forEach(opt => {
                    opt.classList.add('disabled');
                    if(parseInt(opt.dataset.index, 10) === question.correctAnswer) {
                       opt.classList.add('correct');
                    }
                });
    
                if (isCorrect) {
                    e.target.classList.add('correct');
                    duetFeedbackEl.textContent = 'Benar!';
                    duetFeedbackEl.classList.add('correct');
                    if (duetGameState.currentPlayer === 1) {
                        duetGameState.player1Score += 10;
                        player1ScoreEl.textContent = `Skor: ${duetGameState.player1Score}`;
                    } else {
                        duetGameState.player2Score += 10;
                        player2ScoreEl.textContent = `Skor: ${duetGameState.player2Score}`;
                    }
                } else {
                    e.target.classList.add('incorrect');
                    duetFeedbackEl.textContent = 'Salah!';
                    duetFeedbackEl.classList.add('incorrect');
                }
                
                if (duetGameState.currentPlayer === 2) {
                    duetGameState.currentRound++;
                }
                
                duetGameState.currentPlayer = (duetGameState.currentPlayer === 1) ? 2 : 1;
                
                setTimeout(() => {
                    renderNextDuetQuestion();
                    updateTurnIndicator();
                }, 2500);
            }
    
            function endDuetGame() {
                duetGameState.active = false;
                const winnerText = document.getElementById('duet-winner-text');
                const finalScores = document.getElementById('duet-final-scores');
                
                if (duetGameState.player1Score > duetGameState.player2Score) {
                    winnerText.textContent = '🏆 Pemain 1 Menang! 🏆';
                } else if (duetGameState.player2Score > duetGameState.player1Score) {
                    winnerText.textContent = '🏆 Pemain 2 Menang! 🏆';
                } else {
                    winnerText.textContent = '🤝 Hasilnya Seri! 🤝';
                }
    
                finalScores.textContent = `Skor Akhir: Pemain 1 (${duetGameState.player1Score}) - Pemain 2 (${duetGameState.player2Score})`;
                duetResultModal.style.display = 'flex';
    
                document.getElementById('duet-play-again-btn').onclick = () => {
                    duetResultModal.style.display = 'none';
                    showView('quiz-level-selection-view');
                };
                document.getElementById('duet-back-to-menu-btn').onclick = () => {
                    duetResultModal.style.display = 'none';
                    showView('quiz-view');
                };
            }
    
            loadUserPoints();
        }
        
        // --- [BARU] FUNGSI UNTUK TOKO TEMA ---
        function setupThemeStore() {
            const themeStoreBtn = document.getElementById('theme-store-btn');
            const themeStoreModal = document.getElementById('theme-store-modal');
            const closeModalBtn = themeStoreModal.querySelector('.close-button');
            const storeUserPointsEl = document.getElementById('store-user-points');
            const themeGrid = document.getElementById('theme-grid');
            const mainUserPointsEl = document.getElementById('user-points');
            
            // Memuat data tema dari localStorage
            let purchasedThemes = JSON.parse(localStorage.getItem('purchased_themes')) || ['default'];
            let appliedThemeId = localStorage.getItem('applied_theme') || 'default';
    
            function saveThemeData() {
                localStorage.setItem('purchased_themes', JSON.stringify(purchasedThemes));
                localStorage.setItem('applied_theme', appliedThemeId);
            }
    
            function saveUserPoints() {
                 localStorage.setItem('user_points', userPoints);
                 mainUserPointsEl.textContent = userPoints;
                 storeUserPointsEl.textContent = `Poin Anda: ${userPoints} 💎`;
            }
    
            function renderThemes() {
                storeUserPointsEl.textContent = `Poin Anda: ${userPoints} 💎`;
                themeGrid.innerHTML = '';
    
                themes.forEach(theme => {
                    const isUnlocked = purchasedThemes.includes(theme.id);
                    const isApplied = theme.id === appliedThemeId;
                    const canAfford = userPoints >= theme.price;
    
                    let buttonHtml = '';
                    let cardClasses = 'theme-card';
    
                    if (isApplied) {
                        buttonHtml = `<button class="theme-action-btn apply" disabled>Digunakan</button>`;
                        cardClasses += ' applied';
                    } else if (isUnlocked) {
                        buttonHtml = `<button class="theme-action-btn apply" data-theme-id="${theme.id}">Terapkan</button>`;
                    } else if (canAfford) {
                        buttonHtml = `<button class="theme-action-btn buy" data-theme-id="${theme.id}">Beli</button>`;
                    } else {
                        buttonHtml = `<button class="theme-action-btn insufficient" disabled>Poin Kurang</button>`;
                    }
    
                    const card = document.createElement('div');
                    card.className = cardClasses;
                    card.innerHTML = `
                        <div class="theme-preview">
                            <div class="color-swatch" style="background-color: ${theme.colors[0]}"></div>
                            <div class="color-swatch" style="background-color: ${theme.colors[1]}"></div>
                            <div class="color-swatch" style="background-color: ${theme.colors[2]}"></div>
                            <div class="color-swatch" style="background-color: ${theme.colors[3]}"></div>
                        </div>
                        <div class="theme-name">${theme.name}</div>
                        <div class="theme-price">${theme.price > 0 ? `${theme.price} 💎` : 'Gratis'}</div>
                        ${buttonHtml}
                    `;
                    themeGrid.appendChild(card);
                });
            }
    
            themeGrid.addEventListener('click', (e) => {
                const btn = e.target;
                const themeId = btn.dataset.themeId;
                if (!themeId) return;
    
                // Logika untuk membeli tema
if (btn.classList.contains('buy')) {
                    const theme = themes.find(t => t.id === themeId);
                    if (theme && userPoints >= theme.price) {
                        const themePurchaseModal = document.getElementById('theme-purchase-modal');
                        
                        // Isi konten modal konfirmasi
                        document.getElementById('theme-purchase-info').innerHTML = `Anda akan membeli tema <strong>"${theme.name}"</strong> seharga <strong>${theme.price} 💎</strong>. Lanjutkan?`;
                        
                        // Tampilkan modal
                        themePurchaseModal.style.display = 'flex';

// Fungsi tombol konfirmasi beli
            document.getElementById('confirm-purchase-btn').onclick = () => {
                themePurchaseModal.style.display = 'none'; // Sembunyikan modal konfirmasi
                
                // 1. Lakukan proses pembelian
                userPoints -= theme.price;
                purchasedThemes.push(themeId);
                saveUserPoints();
                saveThemeData();
                
                // 2. Siapkan dan tampilkan modal sukses
                const successModal = document.getElementById('theme-success-modal');
                const successInfo = document.getElementById('theme-success-info');
                const successOkBtn = document.getElementById('theme-success-ok-btn');

                successInfo.innerHTML = `Anda telah berhasil membeli tema <strong>"${theme.name}"</strong>. Anda bisa langsung menerapkannya sekarang di Toko Tema.`;
                successModal.style.display = 'flex';

                // 3. Fungsi tombol OK pada modal sukses
                successOkBtn.onclick = () => {
                    successModal.style.display = 'none';
                    renderThemes(); // Render ulang toko SETELAH notifikasi ditutup
                };
            };
                    }
                }
                
                // Logika untuk menerapkan tema
                else if (btn.classList.contains('apply')) {
                    appliedThemeId = themeId;
                    saveThemeData();
                    applyThemeCss(themeId); 
                    renderThemes();
                }
            });
    
            themeStoreBtn.addEventListener('click', () => {
                renderThemes();
                themeStoreModal.style.display = 'flex';
            });
    
            closeModalBtn.addEventListener('click', () => {
                themeStoreModal.style.display = 'none';
            });
            
            // Panggil ini agar tema yang terakhir dipilih diterapkan saat aplikasi dibuka
            applyThemeCss(appliedThemeId);
        }
        
        // [BARU] Fungsi untuk menerapkan CSS tema secara global
        function applyThemeCss(themeId) {
            const theme = themes.find(t => t.id === themeId);
            if (!theme) {
                console.error(`Tema dengan ID "${themeId}" tidak ditemukan.`);
                return;
            }
    
            console.log(`Menerapkan tema: ${theme.name}`);
            const root = document.documentElement;
            root.style.setProperty('--header-bg', theme.colors[0]);
            root.style.setProperty('--primary-bg', theme.colors[1]);
            root.style.setProperty('--accent-color', theme.colors[2]);
            root.style.setProperty('--card-bg', theme.colors[3]);
            
            // Anda bisa menambahkan logika lain di sini jika dibutuhkan,
            // misalnya mengubah warna teks agar kontrasnya tetap baik.
            // Untuk saat ini, kita hanya mengubah warna dasar.
        }
    
    
        // --- Pengaturan Suara Adzan ---
        function renderFullAdhanSettingsPage() {
            const body = document.getElementById('adhan-settings-body');
            body.innerHTML = '';
    
            const prayerSettingsMap = [
                { key: 'Imsak', label: translations[currentLanguage]['Imsak'] || 'Imsak' },
                { key: 'Fajr', label: translations[currentLanguage]['Fajr'] || 'Subuh' },
                { key: 'Sunrise', label: translations[currentLanguage]['Sunrise'] || 'Terbit' },
                { key: 'Dhuhr', label: translations[currentLanguage]['Dhuhr'] || 'Dzuhur' },
                { key: 'Asr', label: translations[currentLanguage]['Asr'] || 'Ashar' },
                { key: 'Maghrib', label: translations[currentLanguage]['Maghrib'] || 'Maghrib' },
                { key: 'Isha', label: translations[currentLanguage]['Isha'] || 'Isya' }
            ];
    
            prayerSettingsMap.forEach(prayer => {
                const prayerKey = prayer.key;
                const currentSetting = prayerAudioSettings[prayerKey];
    
                const group = document.createElement('div');
                group.className = 'settings-group';
    
                const title = document.createElement('h4');
                title.textContent = prayer.label;
                group.appendChild(title);
    
                const availableOptions = adhanOptionsMap[prayerKey];
                if (!availableOptions) return;
    
                availableOptions.forEach(soundKey => {
                    const soundInfo = adhanSoundFiles[soundKey];
                    if (!soundInfo) return;
    
                    const isSelected = soundKey === currentSetting.sound;
    
                    const wrapper = document.createElement('div');
                    wrapper.className = 'selection-item-wrapper';
    
                    wrapper.innerHTML = `
                        <div class="selection-item ${isSelected ? 'selected' : ''}" data-prayer="${prayerKey}" data-sound="${soundKey}">
                            <span>${soundInfo.name}</span>
                            <span class="checkmark">✓</span>
                        </div>
                        <div class="volume-control-container ${isSelected && soundKey !== 'none' ? 'active' : ''}">
                            <span class="volume-icon">🔉</span>
                            <input type="range" min="0" max="1" step="0.1" value="${currentSetting.volume}" class="volume-slider" data-prayer="${prayerKey}">
                            <button class="test-sound-btn" data-sound="${soundKey}" aria-label="Test Sound">🎵</button>
                        </div>
                    `;
                    group.appendChild(wrapper);
                });
    
                body.appendChild(group);
            });
        }
    
        function setupAdhanSettingsPage() {
            const body = document.getElementById('adhan-settings-body');
    
            body.addEventListener('click', (e) => {
                const item = e.target.closest('.selection-item');
                if (item) {
                    const prayerKey = item.dataset.prayer;
                    const newSoundKey = item.dataset.sound;
                    const currentVolume = prayerAudioSettings[prayerKey].volume;
    
                    prayerAudioSettings[prayerKey] = { sound: newSoundKey, volume: currentVolume };
                    localStorage.setItem('prayerAudioSettings', JSON.stringify(prayerAudioSettings));
    
                    const group = item.closest('.settings-group');
                    if (group) {
                        const previouslySelected = group.querySelector('.selection-item.selected');
                        if (previouslySelected) {
                            previouslySelected.classList.remove('selected');
                            const prevSliderContainer = previouslySelected.nextElementSibling;
                            if (prevSliderContainer && prevSliderContainer.classList.contains('volume-control-container')) {
                                prevSliderContainer.classList.remove('active');
                            }
                        }
    
                        item.classList.add('selected');
    
                        const newSliderContainer = item.nextElementSibling;
                        if (newSoundKey !== 'none' && newSliderContainer && newSliderContainer.classList.contains('volume-control-container')) {
                            newSliderContainer.classList.add('active');
                        }
                    }
                }
    
                const testBtn = e.target.closest('.test-sound-btn');
                if (testBtn) {
                    const soundKey = testBtn.dataset.sound;
                    const slider = testBtn.previousElementSibling;
                    const volume = parseFloat(slider.value);
                    const soundInfo = adhanSoundFiles[soundKey];
    
                    if (soundInfo && soundInfo.audioId) {
                        const audioElement = document.getElementById(soundInfo.audioId);
                        if (audioElement) {
                            stopAllAdhanAudio();
                            audioElement.volume = volume;
                            audioElement.currentTime = 0;
                            audioElement.play().catch(err => console.error("Test play failed:", err));
                        }
                    }
                }
            });
    
            body.addEventListener('input', (e) => {
                if (e.target.classList.contains('volume-slider')) {
                    const slider = e.target;
                    const prayerKey = slider.dataset.prayer;
                    const newVolume = parseFloat(slider.value);
    
                    if (prayerAudioSettings[prayerKey]) {
                        prayerAudioSettings[prayerKey].volume = newVolume;
                        localStorage.setItem('prayerAudioSettings', JSON.stringify(prayerAudioSettings));
                    }
                }
            });
    
            document.getElementById('adhan-settings-back-btn').addEventListener('click', () => {
                stopAllAdhanAudio();
                showView('prayer-times-view');
                document.getElementById('settings-modal').style.display = 'flex';
            });
        }
    
        // --- SETTINGS & LANGUAGE ---
        function setupSettings() {
            const darkModeToggle = document.getElementById('dark-mode-toggle');
            const langSelect = document.getElementById('language-select');
            const settingsModal = document.getElementById('settings-modal');
            const enableNotificationsBtn = document.getElementById('enable-notifications-btn');
            const adhanSettingsContainer = document.getElementById('adhan-settings-trigger-container');
    
            const applyDarkMode = (theme) => { darkModeToggle.checked = theme === 'dark'; document.body.classList.toggle('dark-mode', theme === 'dark'); };
            darkModeToggle.addEventListener('change', () => { const theme = darkModeToggle.checked ? 'dark' : 'light'; localStorage.setItem('theme', theme); applyDarkMode(theme); });
            applyDarkMode(localStorage.getItem('theme') || 'light');
    
            window.updateNotificationButtonState = function() {
                if (!("Notification" in window) || !("serviceWorker" in navigator)) {
                    enableNotificationsBtn.textContent = 'Tidak Didukung';
                    enableNotificationsBtn.disabled = true;
                    return;
                }
                switch (Notification.permission) {
                    case 'granted':
                        enableNotificationsBtn.textContent = 'Telah Diizinkan';
                        enableNotificationsBtn.disabled = true;
                        break;
                    case 'denied':
                        enableNotificationsBtn.textContent = 'Diblokir';
                        enableNotificationsBtn.disabled = true;
                        break;
                    default:
                        enableNotificationsBtn.textContent = 'Aktifkan';
                        enableNotificationsBtn.disabled = false;
                }
            }
    
            enableNotificationsBtn.addEventListener('click', () => {
                window.requestNotificationPermission()
                    .then(permission => {
                        if (permission === "granted") {
                            new Notification("Notifikasi Diaktifkan!", {
                                body: "Anda akan menerima notifikasi waktu sholat.",
                                icon: 'logo-annur.jpg'
                            });
                        }
                        updateNotificationButtonState();
                    })
                    .catch(error => {
                        console.log('Permintaan notifikasi ditolak dari modal kustom:', error);
                        updateNotificationButtonState();
                    });
            });
            updateNotificationButtonState();
    
            function renderAdhanTriggerButton() {
                adhanSettingsContainer.innerHTML = `
                    <h4 data-key="settings_adhan_sound">Pengaturan Suara Adzan</h4>
                    <div class="settings-menu-item" id="open-adhan-settings-btn" style="border-bottom: none; padding-bottom: 0;">
                        <span>Atur Suara & Volume untuk Tiap Waktu</span>
                        <span class="arrow">&rsaquo;</span>
                    </div>`;
                document.getElementById('open-adhan-settings-btn').addEventListener('click', () => {
                    settingsModal.style.display = 'none';
                    showView('adhan-settings-view');
                    renderFullAdhanSettingsPage();
                });
            }
    
            const setLanguage = (lang) => {
                currentLanguage = lang;
                localStorage.setItem('language', lang);
                document.documentElement.lang = lang;
    
                document.querySelectorAll('[data-key]').forEach(el => {
                    const key = el.dataset.key;
                    if (translations[lang] && translations[lang][key]) {
                        el.textContent = translations[lang][key];
                    }
                });
    
                updateDates();
                generateCalendar();
    
                if (window.latestPrayerTimes) {
                    renderPrayerTimes(window.latestPrayerTimes);
                    startCountdown(window.latestPrayerTimes);
                }
                renderAdhanTriggerButton();
            };
    
            langSelect.addEventListener('change', () => {
                setLanguage(langSelect.value);
            });
    
            const savedLang = localStorage.getItem('language') || 'id';
            langSelect.value = savedLang;
            setLanguage(savedLang);
    
            settingsModal.querySelector('.close-button').addEventListener('click', () => settingsModal.style.display = 'none');
        }
    
        // --- FUNGSI UNTUK HALAMAN DETAIL APLIKASI ---
        function setupAppDetailPages() {
            const settingsModal = document.getElementById('settings-modal');
            const detailAppBtn = document.getElementById('detail-app-btn');
            const detailViewBackBtn = document.getElementById('detail-view-back-btn');
    
            if (!detailAppBtn) return;
    
            detailAppBtn.addEventListener('click', () => {
                settingsModal.style.display = 'none';
                showView('app-detail-view');
            });
    
            detailViewBackBtn.addEventListener('click', () => {
                showView('prayer-times-view');
            });
    
            document.querySelectorAll('#app-detail-view .settings-menu-item').forEach(item => {
                item.addEventListener('click', () => {
                    const targetViewId = item.getAttribute('data-target-view');
                    if (targetViewId) {
                        showView(targetViewId);
                    }
                });
            });
        }
    
        // --- INITIALIZATION ---
        setupNavigation();
        setupSettings();
        setupDoaHarian();
        setupQuranFeature();
        setupDzikir();
        setupQiblaFeature();
        setupQuizFeature();
        setupThemeStore(); // Panggil fungsi setup toko tema
        setupAppDetailPages();
        setupAdhanSettingsPage();
        setupCustomPermissionModals();
        setupMotivationFeature();
        setupSahabatAnnurFeature();
    
        // Panggil fungsi inisialisasi utama yang baru
        initLocationAndPrayerTimes();
    
        updateDates();
        generateCalendar();
        showView('prayer-times-view');
    
        // Minta izin notifikasi setelah beberapa saat jika belum diatur
        setTimeout(() => {
            if (Notification.permission === 'default') {
                window.requestNotificationPermission()
                    .then(p => { console.log('Izin Notifikasi:', p); window.updateNotificationButtonState(); })
                    .catch(e => { console.log('Permintaan notifikasi ditunda:', e); });
            }
        }, 5000);
    });
    
    // --- PENDAFTARAN SERVICE WORKER & PENYIMPANAN PERMANEN ---
    window.addEventListener('load', () => {
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(registration => {
                    console.log('Service Worker berhasil didaftarkan:', registration);
                })
                .catch(error => {
                    console.error('Pendaftaran Service Worker gagal:', error);
                });
        } else {
            console.log('Browser tidak mendukung Service Worker.');
        }
    
        requestPersistentStorage();
    });
    
    // ... di dalam event listener DOMContentLoaded ...
    
    const popupAlarmBtn = document.getElementById('popup-alarm-btn');
    if (popupAlarmBtn) {
        popupAlarmBtn.addEventListener('click', () => {
            if (window.Android && typeof window.Android.requestOverlayPermission === 'function') {
                // Panggil fungsi di MainActivity
                window.Android.requestOverlayPermission();
            } else {
                alert('Fungsi ini hanya tersedia di dalam aplikasi Android.');
            }
        });
    }




// ... di dalam event listener DOMContentLoaded ...

// --- PENGATURAN NOTIFIKASI YANG DISEDERHANAKAN ---
const enableNotificationsBtn = document.getElementById('enable-notifications-btn');

enableNotificationsBtn.addEventListener('click', () => {
    // Cukup panggil satu fungsi di Android.
    // Logika selanjutnya akan diurus sepenuhnya oleh Kotlin.
    if (window.Android && typeof window.Android.requestNativeNotificationPermission === 'function') {
        enableNotificationsBtn.textContent = 'Meminta Izin...';
        window.Android.requestNativeNotificationPermission();
    } else {
        alert('Fungsi ini hanya tersedia di aplikasi Android.');
    }
});

   // Letakkan ini di dalam event listener DOMContentLoaded
   const testAlarmBtn = document.getElementById('test-alarm-btn');
    if (testAlarmBtn) {
        testAlarmBtn.addEventListener('click', () => {
            if (window.Android && typeof window.Android.testAlarmIn5Seconds === 'function') {
                console.log('Memanggil fungsi tes alarm di Android...');
                window.Android.testAlarmIn5Seconds();
            } else {
                alert('Fungsi tes hanya untuk aplikasi Android.');
            }
        });
    }


    // Letakkan ini di dalam event listener DOMContentLoaded
    const testSoundBtn = document.getElementById('test-sound-btn');
    if (testSoundBtn) {
        testSoundBtn.addEventListener('click', () => {
            if (window.Android && typeof window.Android.testSoundPlaybackDirectly === 'function') {
                console.log('Memanggil fungsi tes suara langsung di Android...');
                window.Android.testSoundPlaybackDirectly();
            } else {
                alert('Fungsi tes hanya untuk aplikasi Android.');
            }
        });
    }


// Anda bisa menambahkan kode untuk mengubah teks tombol kembali ke "Aktifkan"
// setelah beberapa saat jika pengguna tidak memberikan respon, tapi ini opsional.
// Misalnya, saat modal pengaturan ditutup.

// ... sisa kode Anda ...
</script>
</body>
</html>